{"version":3,"sources":["templateSearch.js"],"names":["$","document","ready","on","storeAndSearch","this","selectedOption","find","content","val","templateId","data","targetGroup","closest","buildFieldInfo","searchId","targetForm","post","basePath","storeOnly","searchQuery","JSON","stringify","serializeForm","console","log","cachedResults","parseJSON","cachedDates","e","bootbox","alert","success","window","location","fieldTitle","template","textStatus","xhr","results","type","html","selectElement","each","values","index","optionValue","isNumeric","append","value","text","removeClass","specificSearch","newSpecificSearch","clone","after","collectionCopy","newCollection"],"mappings":"AACAA,EAAEC,UAAUC,MAAM,WAEdF,EAAEC,UAAUE,GAAG,SAAU,cAAe,WASpC,OAFAC,eAAe,GAAIJ,EAAEK,QAEd,MAKfL,EAAEC,UAAUE,GAAG,SAAU,kBAAmB,WACxC,IAAIG,EAAiBN,EAAEK,MAAME,KAAK,aAC9BC,EAAUR,EAAEM,GAAgBG,MAC5BC,EAAaV,EAAEM,GAAgBK,KAAK,cACpCC,EAAcZ,EAAEK,MAAMQ,QAAQ,eAAeN,KAAK,gCAEtDO,eAAeJ,EAAYF,EAASI,KAKxC,IAAIR,eAAiB,SAASW,EAAUC,GACpChB,EAAEiB,KAAMC,SAAW,wBAA0BH,GAAWI,WAAU,EAAMC,YAAYC,KAAKC,UAAUtB,EAAGgB,GAAaO,kBAAmB,SAAUZ,GAC5Ia,QAAQC,IAAId,GACZ,IACIe,cAAgB1B,EAAE2B,UAAUhB,GAC5BiB,YAAc,KAElB,MAAMC,GACU,KAATlB,GACCmB,QAAQC,MAAM,oBAAqB,eAKd,IAA1BL,cAAcM,UACbjB,EAAWW,cAAcX,SACzBkB,OAAOC,SAAWhB,SAAW,YAAcH,MAMnDD,eAAiB,SAASJ,EAAYyB,EAAYvB,GAClDZ,EAAEiB,KAAKC,SAAS,uBAAwBiB,WAAYA,EAAYC,SAAU1B,GAAa,SAASC,EAAM0B,EAAYC,GAC9G,IAAIC,EACJ,IACIA,EAAUvC,EAAE2B,UAAUhB,GAE1B,MAAMkB,GACFL,QAAQC,IAAI,kBAGG,QAAhBc,EAAQC,MACPxC,EAAEY,GAAa6B,KAAK,IACpBzC,EAAEY,GAAa6B,KAAK,4IAGpBzC,EAAEY,GAAa6B,KAAK,IACpBzC,EAAEY,GAAa6B,KAAK,sHACpBC,cAAgB1C,EAAEY,GAAaL,KAAK,UACpCP,EAAE2C,KAAKJ,EAAQK,OAAQ,SAASC,EAAOpC,GACnC,IAAIqC,EAEAA,EADD9C,EAAE+C,UAAUF,GACGpC,EAGAoC,EAElB7C,EAAE0C,eAAeM,OAAOhD,EAAE,YAAaiD,MAAOH,IAAcI,KAAKzC,UASjFT,EAAEC,UAAUE,GAAG,QAAS,sBAAuB,WAC3CH,EAAE,kBAAkBmD,YAAY,QAChC,IAAIC,EAAiBpD,EAAEK,MAAMQ,QAAQ,mBACjCwC,EAAoBrD,EAAEoD,GAAgBE,OAAM,GAChDtD,EAAEqD,GAAmB9C,KAAK,sBAAsBE,IAAI,IACpDT,EAAEoD,GAAgBG,MAAMF,KAI5BrD,EAAEC,UAAUE,GAAG,QAAS,wBAAyB,WAC7C,IAAIqD,EAAiBxD,EAAEK,MAAMQ,QAAQ,eACjC4C,EAAgBzD,EAAEwD,GAAgBF,OAAM,GAC5CG,EAAclD,KAAK,sBAAsBE,IAAI,IAC7CT,EAAEwD,GAAgBD,MAAME","file":"templateSearch.min.js","sourcesContent":["\n$(document).ready(function() {\n\n    $(document).on(\"submit\", \".searchForm\", function() {\n        // if(window.location.hash.length > 0) {\n        //     searchId = window.location.hash.substring(1);\n        // }\n        // else {\n        //     searchId = \"\";\n        // }\n        storeAndSearch(\"\", $(this));\n\n        return false;\n    });\n});\n\n\n$(document).on(\"change\", \".searchDropdown\", function() {\n    var selectedOption = $(this).find(\":selected\");\n    var content = $(selectedOption).val();\n    var templateId = $(selectedOption).data('templateid');\n    var targetGroup = $(this).closest(\".form-group\").find(\".specificSearchTextContainer\");\n\n    buildFieldInfo(templateId, content, targetGroup);\n\n\n});\n\nvar storeAndSearch = function(searchId, targetForm) {\n    $.post( basePath + \"search/searchResults/\" + searchId, {storeOnly:true, searchQuery:JSON.stringify($( targetForm ).serializeForm())}, function( data ) {\n        console.log(data);\n        try{\n            cachedResults = $.parseJSON(data);\n            cachedDates = null;\n        }\n        catch(e){\n            if(data === \"\") {\n                bootbox.alert(\"No Results Found.\", function() {\n                });\n            }\n        }\n\n        if(cachedResults.success === true) {\n            searchId = cachedResults.searchId;\n            window.location = basePath + \"search/s/\" + searchId;\n        }\n\n    });\n};\n\nvar buildFieldInfo = function(templateId, fieldTitle, targetGroup) {\n    $.post(basePath+'search/getFieldInfo', {fieldTitle: fieldTitle, template: templateId}, function(data, textStatus, xhr) {\n        var results;\n        try {\n            results = $.parseJSON(data);\n        }\n        catch(e) {\n            console.log(\"error occurred\");\n        }\n\n        if(results.type == \"text\") {\n            $(targetGroup).html(\"\");\n            $(targetGroup).html('<input type=\"text\" name=\"specificSearchText[]\"  autocomplete=\"off\" class=\"form-control advancedOption advancedSearchContent\" value=\"\">');\n        }\n        else {\n            $(targetGroup).html(\"\");\n            $(targetGroup).html('<select name=\"specificSearchText[]\"  autocomplete=\"off\" class=\"form-control advancedOption advancedSearchContent\">');\n            selectElement = $(targetGroup).find(\"select\");\n            $.each(results.values, function(index, val) {\n                var optionValue;\n                if($.isNumeric(index)) {\n                    optionValue = val;\n                }\n                else {\n                    optionValue = index;\n                }\n                $(selectElement).append($('<option>', {value: optionValue}).text(val));\n            });\n\n        }\n\n    });\n};\n\n\n$(document).on(\"click\", \".addAnotherSpecific\", function() {\n    $(\".searchCombine\").removeClass(\"hide\");\n    var specificSearch = $(this).closest('.specificSearch');\n    var newSpecificSearch = $(specificSearch).clone(false);\n    $(newSpecificSearch).find(\"input[type='text']\").val(\"\");\n    $(specificSearch).after(newSpecificSearch);\n\n});\n\n$(document).on(\"click\", \".addAnotherCollection\", function() {\n    var collectionCopy = $(this).closest('.form-group');\n    var newCollection = $(collectionCopy).clone(false);\n    newCollection.find(\"input[type='text']\").val(\"\");\n    $(collectionCopy).after(newCollection);\n});\n"]}