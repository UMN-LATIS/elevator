var targetFieldId="",hasParent=!1,unsavedChildren=0;function notifyParentOfSave(t){var t={objectId:t,status:"saved",targetFieldId:targetFieldId},e=null!==window.opener?window.opener:parent;e!=window&&e.postMessage(JSON.stringify(t),"*")}function listener(t){var e;("string"==typeof t.data||t.data instanceof String)&&(e=JSON.parse(t.data),t.data)&&("open"==e.status&&(hasParent=!0,targetFieldId=e.targetField),"saved"==e.status&&($("#"+e.targetFieldId).val()!=e.objectId&&unsavedChildren--,$("#"+e.targetFieldId).val(e.objectId),relatedAssetPreview(e.objectId,$("#"+e.targetFieldId),$(".widgetContents")),submitFormWithDelay(!0,!0)),"closed"==e.status)&&""===$("#"+e.targetFieldId).val()&&(unsavedChildren--,$("#"+e.targetFieldId).closest(".widgetContents").find(".newAssetButton").removeAttr("disabled"))}$(document).on("click",".newAssetButton",function(t){t.preventDefault();var t=$(this).closest(".widgetContents").find(".templateSelector").first().val(),e=$("#collectionId").val(),s=$(this).closest(".widgetContents").find(".targetAsset").first().attr("id"),n=($(this).attr("disabled",!0),unsavedChildren++,window.open(basePath+"assetManager/addAsset/"+t+"/"+e));n.onload=function(){n.postMessage(JSON.stringify({status:"open",targetField:s}),"*")}}),$(document).on("click",".autocompleteEdit",function(t){var e=$(this).closest(".widgetContents").find(".targetAsset").val(),s=$(this).closest(".widgetContents").find(".targetAsset").first().attr("id"),n=window.open(basePath+"assetManager/editAsset/"+e);return!(n.onload=function(){n.postMessage(JSON.stringify({status:"open",targetField:s}),"*")})}),$(window).unload(function(){var t;hasParent&&(t={objectId:null,status:"closed",targetFieldId:targetFieldId},window.opener.postMessage(JSON.stringify(t),"*"))}),window.addEventListener?(addEventListener("message",listener,!1),console.log("listener added")):attachEvent("onmessage",listener);
//# sourceMappingURL=interWindow.min.js.map
