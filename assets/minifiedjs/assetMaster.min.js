function nextResultLink(e){window.location=basePath+"asset/viewAsset/"+e}function loadEmbedViewPointer(){targetObjectId=$("#embedView").data("objectid");var e=$(document).find('[data-fileobjectid="'+targetObjectId+'"]');1<(e=0<e.length?e:$(document).find('[data-objectid="'+targetObjectId+'"]').find(".loadView")).length&&(e=e.first()),$(e).hasClass("ignoreForDigitalAsset")||$(e).trigger("click")}$.ajaxPrefilter(function(e,t,a){"script"!=e.dataType&&"script"!=t.dataType||(e.cache=!0)}),Mousetrap.bind("left",function(){$(".relatedThumbHighlight").closest(".col-sm-2").prev().find("img").trigger("click")}),Mousetrap.bind("right",function(){$(".relatedThumbHighlight").closest(".col-sm-2").next().find("img").trigger("click")}),$(document).on("ready",function(){var e;registerHandlers(),loadLastSearch(),$.fullscreen.isNativelySupported()||$("head").append("<style> .canFullscreen { display: none;</style>"),slicePoint=400,"undefined"!=typeof slicePointDefault&&(slicePoint=slicePointDefault),$(".textareaView li div").expander({slicePoint:slicePoint}),window.location.hash?(nestedObjectId=window.location.hash.replace("#",""),0<(e=0<(e=$(document).find('[data-fileobjectid="'+nestedObjectId+'"]')).length?e:$(document).find('[data-objectid="'+nestedObjectId+'"]').find(".loadView")).length?$(e).trigger("click"):loadEmbedViewPointer()):searchId&&0==$(".rightColumn").find(".uploadContent").length&&1<$(".rightColumn").find(".loadView").length?$.post(basePath+"search/getHighlight",{searchId:searchId,objectId:objectId},function(e,t,a){var e=$.parseJSON(e),n=null,i=!1;$.each(e,function(e,t){if(t!=$("#embedView").data("objectid")&&0<(n=0<(n=$(document).find('[data-fileobjectid="'+t+'"]')).length?n:$(document).find('[data-objectid="'+t+'"]').find(".loadView")).length)return $(n).trigger("click"),!(i=!0)}),i||loadEmbedViewPointer()}):loadEmbedViewPointer()});var registerHandlers=function(){$(window).resize(resizeElement),$(document).on("click",".loadView",loadView),$(document).on("hide.bs.collapse",".relatedListToggle",function(e){$(this).find(".expandRelated").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down")}),$(document).on("show.bs.collapse",".relatedListToggle",loadRelatedList),$(document).on("click",".relatedThumbContainer",function(e){e.stopPropagation();e=$(this).data("objectid");void 0===e&&void 0===(e=$(this).data("fileobjectid"))||(window.location.hash=e)}),$("#mapModal").on("shown.bs.modal",loadMapModal),$(document).on("click",".embedControl",function(){$(this).select()}),$(document).on("click",".showDetails",function(){$(this).parent().parent().children(".assetDetails").toggle("fast")}),$(document).on("click",".exifToggle",loadExif),$("#relatedAccordian").on("hide.bs.collapse",function(e){$(this).find(".expandRelated").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down")}),$("#relatedAccordian").on("show.bs.collapse",loadMoreLikeThis),$("body").on("click",function(e){$('[data-toggle="popover"]').each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$(".popover").has(e.target).length||$(this).popover("hide")})}),$(document).on("click",".editAssetLink",function(e){$.cookie("lastSearch",searchId,{path:"/"})})},resizeElement=function(e){var t=$(".embedAsset").data("ratio");e=e||.7,(t=isNaN(t)?1:t)&&((targetHeight=$(".embedAsset").width()/t)>$(window).height()*e&&(targetHeight=$(window).height()*e),$(".embedAsset").height(targetHeight))},loadView=function(e){void 0===e.originalEvent&&e.preventDefault(),fileObjectId=$(this).data("fileobjectid");var e=$(this).closest("[data-objectid]"),t=!1;0<e.length&&(!e.hasClass("objectIdHost")||e.hasClass("objectIdHost")&&e.hasClass("sidebarContainer"))?(parentObject=e.data("objectid"),t=!0):parentObject=$(this).closest(".objectIdHost").data("objectid"),!fileObjectId||fileObjectId.length<10||$.get(basePath+"asset/getEmbedWithChrome/"+fileObjectId+"/"+objectId,function(e){$("#embedView").html(e),$("#embedView").data("objectid",fileObjectId),$(document).find(".relatedThumbHighlight").removeClass("relatedThumbHighlight"),1<$(".rightColumn").find("[data-fileobjectid]").length&&$(document).find('[data-fileobjectid="'+fileObjectId+'"]').parent().each(function(e,t){$(t).is("div")&&$(t).addClass("relatedThumbHighlight")});e=$(window).scrollTop();$("#embedView").offset().top+400<e&&$("html, body").animate({scrollTop:0},"fast"),lazyElements=$("#embedView").find(".lazy"),lazyInstance.addItems(lazyElements),lazyInstance.update(),t&&setTimeout(function(){$.get(basePath+"asset/viewAssetMetadataOnly/"+objectId+"/"+parentObject,function(e){$("#embedView").append(e),lazyElements=$("#embedView").find(".lazy"),lazyInstance.addItems(lazyElements),lazyInstance.update()})},100),lazyInstance.update(),"function"==typeof loadedCallback&&loadedCallback()})},loadRelatedList=function(e){e.stopPropagation();var e=$(this).data("objectid"),t=this;$(this).find(".expandRelated").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up"),parentObjectId=(0<$(t).parents(".relatedAssetContainer").length?$(t).parents(".relatedAssetContainer").eq(0):$(this).closest(".objectIdHost")).data("objectid"),$.get(basePath+"asset/viewAssetMetadataOnly/"+parentObjectId+"/"+e,function(e){$(t).find(".relatedAssetContents").html(e),lazyElements=$(t).find(".relatedAssetContents").find(".lazy"),lazyInstance.addItems(lazyElements),lazyInstance.update()})},loadExif=function(e){e.preventDefault();e=$(e.target).data("fileobject");Handlebars.registerHelper("ifObject",function(e,t){return"object"==typeof e?t.fn(this):t.inverse(this)}),$.getJSON(basePath+"fileManager/getMetadataForObject/"+e,{},function(e,t){var a,n;e.exif&&(Handlebars.registerPartial("exif-template",$("#exif-template").html()),n=$("#exif-template").html(),n=Handlebars.compile(n),a=$("<div class='exifDisplay' />"),n=n(e.exif),a.append(n),bootbox.dialog({title:"EXIF Data",message:a.html(),buttons:{success:{label:"OK",className:"btn-primary"}}}))})},loadMapModal=function(e){var t=$(e.relatedTarget).data("latitude"),a=$(e.relatedTarget).data("longitude"),e=$(e.relatedTarget).html();return $("#mapModalLabel").html(e),loadMap("mapModalContainer"),markers.mapModalContainer?markers.mapModalContainer.clearLayers():markers.mapModalContainer=new L.layerGroup,map.mapModalContainer.setView([t,a],10),markers||(markers.mapModalContainer=new L.layerGroup),localMarker=L.marker([t,a]),markers.mapModalContainer.addLayer(localMarker),map.mapModalContainer.addLayer(markers.mapModalContainer),$("#mapNearby").attr("href",basePath+"search/nearbyAssets/"+t+"/"+a),!1},loadMoreLikeThis=($(document).on("mouseover",".relatedThumbToggle",function(){var e=$(this).find(".relatedThumbContainerImage"),t=($(e).data("oldURL",$(e).attr("src")),$(e).data("hover"));$(e).attr("src",t)}),$(document).on("mouseout",".relatedThumbToggle",function(){var e=$(this).find(".relatedThumbContainerImage"),t=$(e).data("oldURL");$(e).attr("src",t)}),function(e){$(this).find(".expandRelated").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up");var t={searchText:objectId};$.post(basePath+"search/searchResults/",{suppressRecent:!0,searchRelated:!0,searchQuery:JSON.stringify(t)},function(e){var t,a,n;!0===e.success&&($("#relatedAssets").empty(),t=$("#result-template").html(),a=Handlebars.compile(t),n=!1,$.each(e.matches,function(e,t){t.objectId!=objectId&&(t.base_url=basePath,t=a(t),$("#relatedAssets").append(t),n=!0,0)}),n||$("#relatedAssets").append("<p>No Related Assets Found</p>"))}).fail(function(e){0<e.readyState&&alert(JSON.stringify(e))})}),triggerClose=($(document).on("click",".triggerLightbox",function(){$(".embedAsset").addClass("lightboxAsset"),$(".lightboxContainer").css("display","block"),resizeElement("0.9")}),$(document).on("click",".lightboxCloseButton",function(){triggerClose()}),$(document).on("click",".lightboxContainer",function(){triggerClose()}),$(document).on("keydown",function(e){"Escape"==e.key&&triggerClose()}),function(){$(".lightboxContainer").css("display","none"),$(".embedAsset").removeClass("lightboxAsset"),resizeElement("0.7")});
$(document).ready(function(){$("#addToDrawer").on("submit",function(e){e.preventDefault();var e=$(this).serializeArray(),r=(0==$("#drawerList").find(":selected").length&&alert("You must create a drawer first"),"undefined"!=typeof excerptId&&e.push({name:"excerptId",value:excerptId}),"undefined"!=typeof objectId&&e.push({name:"objectId",value:objectId}),"undefined"!=typeof cachedResults&&e.push({name:"objectArray",value:JSON.stringify(cachedResults.searchResults)}),$(this).attr("action"));$.ajax({url:r,type:"POST",data:e,success:function(e,r,a){$("#drawerModal").modal("toggle")},error:function(e,r,a){console.log("Error adding Drawer")}})}),$("#addNewDrawer").on("submit",function(e){var r=$(this).serializeArray(),a=$(this).attr("action");$.ajax({url:a,type:"POST",data:r,success:function(e,r,a){var t=parseInt(e.drawerId,10);$("#drawerList").append("<option value='"+t+"'>"+e.drawerTitle+"</option>"),$("#drawerList").val(t),$(".drawerAddedSuccess").fadeIn("400"),window.setTimeout(function(){$(".drawerAddedSuccess").fadeOut("400")},2e3)},error:function(e,r,a){console.log("Error adding Drawer")}}),e.preventDefault()})});
//# sourceMappingURL=assetMaster.min.js.map
