{"version":3,"file":"widgetHelpers.min.js","sources":["widgetHelpers.js"],"sourcesContent":["\n/**\n * register various helpers\n */\n\nvar markSaveDirty = function() {\n\t$(\".saveButton\").removeClass(\"btn-primary\").addClass(\"btn-warning\");\n\t$(\"#entryForm\").removeClass(\"clean\").addClass(\"dirty\");\n};\n\nvar markSaveClean = function() {\n\t$(\".saveButton\").removeClass(\"btn-warning\").addClass(\"btn-primary\");\n\t$(\"#entryForm\").removeClass(\"dirty\").addClass(\"clean\");\n};\n\nHandlebars.registerHelper('join', function(val, delimiter, start, end) {\n\tvar arry = [].concat(val);\n\tdelimiter = ( typeof delimiter == \"string\" ? delimiter : ', ' );\n\tstart = start || 0;\n\tend = ( end === undefined ? arry.length : end );\n\treturn arry.slice(start, end).join(delimiter);\n});\n\n\nHandlebars.registerHelper('random', function(options) {\n\treturn Math.random();\n});\n\n$(window).bind('beforeunload', function(){\n\tif(uploadCount > 0) {\n\t\treturn \"You have uploads in progress. Are you sure you wish to leave the page and cancel these uploads?\";\n\t}\n});\n\n$(document).ready(function () {\n\t$(document).on(\"change\", \".mainWidgetEntry\", function (e) {\n\t\tshowHaveEntries();\n\t\tmarkSaveDirty();\n\t});\n\n});\n\n\n/**\n * Add checkmarks to sidebar if there's content in their\n */\nvar showHaveEntries = function() {\n\n\t$(\".tab-pane\").each(function(index, el) {\n\t\tvar targetId = $(el).attr(\"id\");\n\t\tvar show = false;\n\t\tvar requiredContent = false;\n\t\tvar mainWidgets = $(el).find(\".mainWidgetEntry\");\n\t\t$(mainWidgets).each(function(index, mainWidgetElement) {\n\t\t\tif($(mainWidgetElement).is(\"input\") || $(mainWidgetElement).is(\"textarea\")) {\n\t\t\t\tif($(mainWidgetElement).val().length> 0) {\n\t\t\t\t\tshow = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if($(mainWidgetElement).is(\"select\")) {\n\t\t\t\tif($(mainWidgetElement).find(\":selected\").text() !== \"\") {\n\t\t\t\t\tshow = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tshow = true;\n\t\t\t}\n\n\t\t\tif($(mainWidgetElement).prop('required')) {\n\t\t\t\trequiredContent = true;\n\n\t\t\t}\n\n\t\t});\n\n\t\tvar targetHref;\n\t\tif(show) {\n\t\t\ttargetHref = $('a[href=\"#' + targetId+ '\"]').children('.haveContent').show();\n\t\t\t$('a[href=\"#' + targetId+ '\"]').find('.requiredContent').hide();\n\t\t}\n\t\telse {\n\t\t\ttargetHref = $('a[href=\"#' + targetId+ '\"]').children('.haveContent').hide();\n\t\t\tif(requiredContent) {\n\t\t\t\t$('a[href=\"#' + targetId+ '\"]').find('.requiredContent').show();\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$('a[href=\"#' + targetId+ '\"]').find('.requiredContent').hide();\n\t\t\t}\n\t\t}\n\n\n\t});\n\n};\n\n/**\n * Add an additional element\n */\n$(document).on(\"click\", \".addAnother\", function (e) {\n\taddAnother(this);\n});\n\nvar addAnother = function(target, needed) {\n\tif(!needed) {\n\t\tneeded = 1;\n\t}\n\t$(target).attr(\"disabled\",true);\n\tvar parentGroup = $(target).parents(\".tab-pane\").find(\".control-group\");\n\tvar widgetTitle = $(parentGroup).attr('id').replace(\"controlGroup_\", '');\n\tvar widgetId = $(parentGroup).children(\".widget_id\").first().val();\n\tvar offsetCount = $(parentGroup).children(\"div\").length-1;\n\n\tvar self = target;\n\tvar returnInfo = null;\n\t$.get(basePath+\"assetManager/getWidget/\"+widgetId+\"/\"+offsetCount + \"/\" + needed, function(data){\n\n\t\twindow.offsetCount[widgetTitle] += needed;\n\t\treturnInfo = $(data);\n\n\t\t$(parentGroup).append(returnInfo);\n\n\t\t$(parentGroup).find('.isPrimary').show();\n\t\t$(parentGroup).find('.moveDownButton').show();\n\t\t$(parentGroup).find('.moveUpButton').show();\n\t\tbuildAutocomplete();\n\t\tbuildSortable();\n\t\t$(self).removeAttr(\"disabled\");\n\n\t\tif(parentGroup.height() > $(\".mainRow\").height()) {\n\t\t\t$(\".mainRow\").height(parentGroup.height() + 50);\n\t\t\t$(\".leftPane\").height($(\".mainRow\").height());\n\t\t}\n\n\t});\n\treturn returnInfo; // only returns if this is sync\n};\n\n// we disable tincyMCE while dragging, otherwise it fails after the drag.\n// \nvar buildSortable = function() {\n\t$( \".sortableBlock\" ).sortable({\n\t\t//handle: \".handle\"\n\t\tstart: function(event, ui) {\n\t\t\t$(ui.item).css(\"max-height\", \"600px\");\n\t\t\t$(ui.item).css(\"overflow\", \"hidden\");\n\t\t\t$(ui.item).find('.textAreaWidget').each(function () {\n     \t\t\ttinymce.execCommand('mceRemoveEditor', false, $(this).attr('id'));\n  \t\t\t});\n\t\t},\n\t\tstop: function(event, ui) {\n\t\t\t$(ui.item).css(\"max-height\", \"\");\n\t\t\t$(ui.item).css(\"overflow\", \"\");\n\t\t\t$(ui.item).find('.textAreaWidget').each(function () {\n     \t\t\ttinymce.execCommand('mceAddEditor', true, $(this).attr('id'));\n  \t\t\t});\n\t\t\tupdateNames($(this));\n\t\t},\n\t\trevert: true,\n\t\tcancel: \".nestedAsset, .tooltipRow, .sortableBlock p, .sortableBlock label, .mainWidgetEntry, .sortableBlock select, .sortableBlock input, .maphost, .mce-container, .sortableBlock textarea\"\n    });\n}\n\nfunction testUnsetIframes() {\n\tvar fail = false;\n\t$(\".nestedAsset\").find(\"iframe\").each(function() {\n\t\tif($(this).attr(\"src\").indexOf(\"editAsset\") === -1) {\n\t\t\tfail = true;\n\t\t}\n\t});\n\tif(fail) {\n\t\tbootbox.dialog({\n\t\t\t\tmessage: \"Please save this page and reload before moving nested assets\",\n\t\t\t\ttitle: \"Reload Rquired\",\n\t\t\t\tbackdrop: true,\n\t\t\t\tcloseButton: true\n\t\t\t});\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n$(document).on(\"click\", \".moveUp\", function() {\n\tif(testUnsetIframes()) {\n\t\tvar current = $(this).closest(\".widgetContentsContainer\");\n\t\tcurrent.prevAll(\".widgetContentsContainer:first\").before(current);\n\t}\n});\n\n$(document).on(\"click\", \".moveDown\", function() {\n\tif(testUnsetIframes()) {\n\t\tvar current = $(this).closest(\".widgetContentsContainer\");\n\t\tcurrent.nextAll(\".widgetContentsContainer:first\").after(current);\t\n\t}\n});\n\nfunction updateNames($list) {\n    $list.find('.panel').each(function (idx) {\n        var $inp = $(this).find('input, select, textarea');\n        $inp.each(function () {\n            this.name = this.name.replace(/(\\[\\d+\\])/, '[' + idx + ']');            \n        });\n\n\t\t$(this).find(\".isPrimary input\").val(idx);\n    });\n}\n\n\n$(document).on(\"change\", \".templateSelector\", function(e) {\n\tif(parseInt($(this).val()) === 0) {\n\t\t$(this).closest(\".widgetContents\").find('.newAssetButton').attr('disabled', \"disabled\");\n\t}\n\telse {\n\t\t$(this).closest(\".widgetContents\").find('.newAssetButton').attr('disabled', false);\n\t}\n\n});\n\n\n$(document).ready(function() {\n\t/**\n\t * Enable Parseley\n\t */\n\t$(\"#entryForm\").parsley({\n\t\tvalidators: {\n\t\t\tdateobject: function() {\n\t\t\t\treturn {\n\t\t\t\t\tvalidate: function(val, element) {\n\t\t\t\t\t\treturn parseDateString(val, element);\n\t\t\t\t\t},\n\t\t\t\t\tpriority: 2\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\tmessages: {\n\t\t\tdateobject: \"We couldn't figure out a way to parse this date.\"\n\t\t}\n\t});\n\n\tbuildSortable();\n\n\t// make sure nested items have the same collection\n\t$(\"#collectionId\").on(\"change\", function(e) {\n\t\tvar targetCollection = $(this).val();\n\t\t$(\".nestediIFrame\").each(function(index, el) {\n\t\t\tvar sourceCollection = $(el).contents().find(\"#collectionId\");\n\t\t\tsourceCollection.val(targetCollection);\n\t\t\t$(sourceCollection).trigger(\"change\");\n\t\t\tif($(el).get(0).contentWindow && $(el).get(0).contentWindow.resetCollection !== undefined) {\n\t\t\t\t$(el).get(0).contentWindow.resetCollection();\n\t\t\t}\n\n\t\t});\n\n\t});\n\n\tshowHaveEntries();\n\n\t$(\".control-group\").each(function(index, el) {\n\t\tif($(el).find('.isPrimary').length > 1) {\n\t\t\t$(el).find('.isPrimary').show();\n\t\t}\n\t\tif($(el).find('.moveDownButton').length > 1) {\n\t\t\t$(el).find('.moveDownButton').show();\n\t\t}\n\t\tif($(el).find('.moveUpButton').length > 1) {\n\t\t\t$(el).find('.moveUpButton').show();\n\t\t}\n\t});\n\n\t$('input,select').keypress(function(event) { return event.keyCode != 13; });\n\n\t$(\"#inputAvailableAfter\").datepicker();\n\n\tif($(\"#inputObjectId\").val() !== \"\") {\n\t\t$(\".viewAsset\").show();\n\t\tloadPreviewAndUpdateTitle($(\"#inputObjectId\").val());\n\t}\n\n\n\t$(\".templateSelector\").trigger(\"change\");\n\n\t/**\n\t * preload the previews for any related assets\n\t */\n\t$(\".relatedAssetSelectedItem\").each(function(index, el) {\n\n\t\tvar relatedAssetId = $(el).val();\n\t\trelatedAssetPreview(relatedAssetId, this, $(\".widgetContents\"));\n\t});\n\n\n\t$(\"#inputNewTemplateId\").on(\"change\", function() {\n\t\tvar sourceReference = this;\n\t\ttargetTemplate = $(sourceReference).val();\n\t\tsourceTemplate = $(\"#sourceTemplate\").val();\n\t\t\n\t\tif(targetTemplate == \"---\") {\n\t\t\t$(sourceReference).val(sourceTemplate);\n\t\t\treturn;\n\t\t}\n\t\tjQuery.getJSON(basePath + \"assetManager/compareTemplates/\" + sourceTemplate + \"/\" + targetTemplate, {}, function(json, textStatus) {\n\n\t\t\tif(json.length === 0) {\n\t\t\t\t$(\"#sourceTemplate\").val(targetTemplate);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar source   = $(\"#template-switch\").html();\n\t\t\t\tvar template = Handlebars.compile(source);\n\n\t\t\t\tbootbox.confirm(template(json), function(result) {\n\t\t\t\t\tif(result) {\n\t\t\t\t\t\t$(\"#sourceTemplate\").val(targetTemplate);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$(sourceReference).val(sourceTemplate);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t}\n\t\t});\n\n\n\t});\n\n\n\t$(\"#newCollectionId\").on(\"change\", function() {\n\t\tvar sourceReference = this;\n\t\ttargetCollection = $(sourceReference).val();\n\t\tsourceCollection = $(\"#collectionId\").val();\n\t\tif(sourceCollection === \"-1\" || sourceCollection === \"\") {\n\t\t\t$(\"#collectionId\").val(targetCollection);\n\t\t\t$(\"#collectionId\").trigger(\"change\");\n\t\t\treturn;\n\t\t}\n\n\t\tjQuery.getJSON(basePath + \"assetManager/compareCollections/\" + sourceCollection + \"/\" + targetCollection, {}, function(json, textStatus) {\n\n\t\t\tif(json.migration === false) {\n\t\t\t\t$(\"#collectionId\").val(targetCollection);\n\t\t\t\t$(\"#collectionId\").trigger(\"change\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar source   = $(\"#collection-switch\").html();\n\t\t\t\tvar template = Handlebars.compile(source);\n\n\t\t\t\tbootbox.confirm(template(json), function(result) {\n\t\t\t\t\tif(result) {\n\t\t\t\t\t\t$(\"#collectionId\").val(targetCollection);\n\t\t\t\t\t\t$(\"#collectionId\").trigger(\"change\");\n\t\t\t\t\t\t$(\"#collectionMigrationInProcess\").val(\"true\");\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$(sourceReference).val(sourceCollection);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t}\n\t\t});\n\n\n\t});\n\n\n\n\tbuildAutocomplete();\n\n\n\t$(\"#collectionMigrationInProcess\").on(\"change\", function() {\n\t\tif($(this).val() == \"true\") {\n\t\t\t\t$(\".saveButton\").hide();\n\t\t\t\tbootbox.dialog({\n\t\t\t\tmessage: \"Editing is unavailable while collection migration is taking place.\",\n\t\t\t\ttitle: \"Edits Disabled\",\n\t\t\t\tbackdrop: true,\n\t\t\t\tcloseButton: false\n\t\t\t});\n\t\t}\n\t\telse {\n\n\t\t}\n\n\t});\n\n\t$(\"#collectionMigrationInProcess\").trigger('change');\n});\n\n\n\n\n\n$(document).on(\"click\", \".autocompletePreview\", function(event) {\n\tvar targetItem = $(this).closest(\".widgetContents\").find(\".targetAsset\").val();\n\twindow.open(basePath+ \"asset/viewAsset/\"+targetItem);\n\treturn false;\n});\n\n\n\nfunction buildAutocomplete() {\n\tvar source   = $(\"#autocompleter-template\").html();\n\tvar template = Handlebars.compile(source);\n\n\t/**\n\t * This performs the actual autocomplete, doing prefix only search against the same template and field title.\n\t */\n\tif($(\".tryAutocomplete\").length) {\n\t\t$(\".tryAutocomplete\").each(function(index, value) {\n\t\t\tvar self = value;\n\t\t\t$(value).autocomplete({\n\t\t\t\tsource: function(request, response) {\n\t\t\t\t\tvar templateId = null;\n\t\t\t\t\tvar fieldTitle = $(self).closest(\".tab-pane\").attr(\"id\");\n\t\t\t\t\tvar searchTerm = request.term;\n\t\t\t\t\t$.post( basePath + \"search/autocomplete/\", {templateId: templateId, fieldTitle:fieldTitle, searchTerm:searchTerm}, function( data ) {\n\t\t\t\t\ttry{\n\t\t\t\t\t\tjsonObject = $.parseJSON(data);\n\t\t\t\t\t}\n\t\t\t\t\tcatch(e){\n\t\t\t\t\t\talert(e + \" \" + data);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tresponse(jsonObject);\n\t\t\t\t});\n\t\t\t},\n\t\t\tmessages: {\n\t\t\t\tnoResults: '',\n\t\t\t\tresults: function() {}\n\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\tbuildAssetAutocomplete($(\".widgetContents\"));\n}\n\n\n/**\n * related asset helpers\n */\n\n$(document).on(\"click\", \".viewAsset\", function() {\n\t\twindow.open(basePath+ \"asset/viewAsset/\"+$(\"#inputObjectId\").val());\n});\n\n\n$(document).on(\"click\", \".clearRelated\", function(e) {\n\tif(confirm(\"Are you sure you wish to clear this asset?\")) {\n\t\t$(this).closest(\".widgetContents\").find(\".relatedAssetInput\").val(\"\");\n\t\t$(this).closest(\".widgetContents\").find(\".relatedAssetSelectedItem\").val(\"\");\n\t\t$(this).closest(\".widgetContents\").find(\".relatedAssetInput\").trigger(\"change\");\n\t\t$(this).closest(\".widgetContents\").find(\".relatedAssetSelectedItem\").trigger(\"change\");\n\t\t$(this).closest(\".widgetContents\").find(\".autocompletePreview\").hide();\n\t\t$(this).closest(\".widgetContents\").find(\".autocompleteEdit\").hide();\n\t\t$(this).closest(\".widgetContents\").find(\".assetPreview\").html(\"\");\n\t\t$(this).closest(\".widgetContents\").find(\".clearRelated\").hide();\n\t\t$(this).closest(\".widgetContents\").find(\".nestediIFrame\").remove();\n\t\t$(this).closest(\".widgetContents\").find(\".newAssetButton\").removeAttr(\"disabled\");\n\t}\n});\n\n\n/**\n * nested asset helper\n */\n\n\nfunction loadFrameForNestedElement(el) {\n\tvar templateId = $(el).find(\".templateSelector\").val();\n\t\tvar collectionId = $(\"#inputCollectionId\").val();\n\n\t\tvar assetId = $(el).find(\".targetAsset\").val();\n\t\tvar targetURL = null;\n\n\t\tif(assetId.length > 0) {\n\t\t\ttargetURL = basePath + \"assetManager/editAsset/\" + assetId + \"/true\";\n\t\t}\n\t\telse {\n\t\t\ttargetURL = basePath + \"assetManager/addAsset/\" + templateId + \"/\" + collectionId + \"/true\";\n\t\t}\n\n\n\t\tvar targetElement = $(el).find(\".inlineRelatedAsset\");\n\n\t\tvar element = $(\"<iframe />\", {\n\t\t\tclass: \"nestediIFrame\",\n\t\t\tframeborder: 0,\n\t\t\twidth: \"100%\",\n\t\t\tsrc: targetURL\n\t\t});\n\n\t\telement.appendTo(targetElement);\n\n\t\tvar targetField = $(el).find(\".targetAsset\");\n\t\telement.load(function() {\n\t\t\tiframeLoaded(element);\n\t\t\tvar targetInfo = { 'status':'open', 'targetField': targetField.attr('id') };\n\t\t\tthis.contentWindow.postMessage(JSON.stringify(targetInfo), \"*\");\n\t\t});\n\n}\n\nfunction iframeLoaded(iFrame) {\n\n\t\tvar element = $(iFrame).closest(\".tab-pane\");\n\t\tvar id = $(element).attr(\"id\");\n\n\t\tvar height = $(iFrame).contents().find(\"html\").height();\n\n\t\t$(iFrame).height(height);\n\t\t$(\"#collectionId\").trigger(\"change\");\n\n\n}\n\n\n// Handler for previous/next functionality in editing\n// registered in template.js\nvar objectId = null;\n$(document).ready(function() {\n\tif ($(\"#inputObjectId\").val().length > 10) {\n\t\tobjectId = $(\"#inputObjectId\").val();\n\t}\n\tloadLastSearch();\n});\n\nfunction nextResultLink(targetId) {\n\twindow.location = basePath + \"assetManager/editAsset/\" + targetId;\n}\n\n$(document).on('change', '.importTextForSidecar', function(e) {\n\tvar target = $(this).data('target');\n\tvar selectedFile = e.target.files[0];\n\tvar reader = new FileReader();\n\treader.onload = function(e) {\n\t\t$('[name=\"' + target + '\"]').val(e.target.result);\n\t};\n\n\treader.readAsText(selectedFile);\n\n});"],"names":["markSaveDirty","$","removeClass","addClass","markSaveClean","showHaveEntries","Handlebars","registerHelper","val","delimiter","start","end","arry","concat","undefined","length","slice","join","options","Math","random","window","bind","uploadCount","document","ready","on","e","each","index","el","targetId","attr","show","requiredContent","mainWidgets","find","mainWidgetElement","is","text","prop","children","hide","addAnother","this","target","needed","parentGroup","parents","widgetTitle","replace","widgetId","first","offsetCount","self","returnInfo","get","basePath","data","append","buildAutocomplete","buildSortable","removeAttr","height","sortable","event","ui","item","css","tinymce","execCommand","stop","updateNames","revert","cancel","testUnsetIframes","fail","indexOf","bootbox","dialog","message","title","backdrop","closeButton","$list","idx","name","source","html","compile","value","autocomplete","request","response","fieldTitle","closest","searchTerm","term","post","templateId","jsonObject","parseJSON","alert","messages","noResults","results","buildAssetAutocomplete","loadFrameForNestedElement","collectionId","assetId","targetURL","targetElement","element","class","frameborder","width","src","targetField","appendTo","load","iframeLoaded","targetInfo","status","contentWindow","postMessage","JSON","stringify","iFrame","contents","trigger","current","prevAll","before","nextAll","after","parseInt","parsley","validators","dateobject","validate","parseDateString","priority","targetCollection","sourceCollection","resetCollection","keypress","keyCode","datepicker","loadPreviewAndUpdateTitle","relatedAssetId","relatedAssetPreview","sourceReference","targetTemplate","sourceTemplate","jQuery","getJSON","json","textStatus","template","confirm","result","migration","targetItem","open","remove","objectId","nextResultLink","location","loadLastSearch","selectedFile","files","reader","FileReader","onload","readAsText"],"mappings":"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"}