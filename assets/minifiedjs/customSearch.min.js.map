{"version":3,"sources":["customSearch.js"],"names":["templateList","$","document","ready","jQuery","getJSON","basePath","json","textStatus","prepopulate","on","result","serializeForm","searchId","val","searchTitle","post","searchData","customSearchId","data","xhr","pathAddition","newurl","window","location","protocol","host","history","pushState","path","bootbox","alert","setTimeout","hideAll","event","preventDefault","addNewGroup","storeAndSearch","e","keyCode","presetInfo","templates","specificTemplateId","searchFieldValues","specificSearchField","each","index","targetElement","templateSelector","find","loadSearchFields","injectObject","source","html","template","Handlebars","compile","insertObject","before","templateId","parentGroup","targetValue","targetGroup","empty","append","value","text","trigger","this","closest","fieldTitle","buildFieldInfo"],"mappings":"AAAA,GAAIA,cAAe,EAGnBC,GAAEC,UAAUC,MAAM,WAGjBC,OAAOC,QAAQC,SAAW,yBAA2B,SAASC,EAAMC,GACnER,aAAeO,EACfE,gBAIDR,EAAE,qBAAqBS,GAAG,QAAS,WAClC,GAAIC,GAASV,EAAE,qBAAqBW,gBAChCC,EAAWZ,EAAE,aAAaa,MAC1BC,EAAcd,EAAE,qBAAqBa,KACzCb,GAAEe,KAAKV,SAAW,qBAAuBS,YAAaA,EAAaE,WAAYN,EAAQO,eAAgBL,GAAY,SAASM,EAAMX,EAAYY,GAC7I,GAAGD,EAAM,CACRlB,EAAE,aAAaa,IAAIK,GACnBE,aAAe,GACA,KAAZf,WACFe,aAAef,SAEhB,IAAIgB,GAASC,OAAOC,SAASC,SAAW,KAAOF,OAAOC,SAASE,KAAOL,aAAe,yBAA4BF,CACjHI,QAAOI,QAAQC,WAAWC,KAAKP,GAAQ,GAAGA,GAC1CQ,QAAQC,MAAM,kBACdR,OAAOS,WAAW,WACjBF,QAAQG,WACN,WAMNhC,EAAE,aAAaS,GAAG,QAAS,SAASwB,GACnCA,EAAMC,iBACNC,gBAIDnC,EAAE,iBAAiBS,GAAG,QAAS,SAASwB,GAEvCG,eAAe,GAAIpC,EAAE,0BASvBA,EAAEC,UAAUQ,GAAG,WAAY,QAAS,SAAS4B,GACzC,MAAiB,KAAbA,EAAEC,SACFF,eAAe,GAAIpC,EAAE,uBACd,GAFX,QAOJ,IAAIQ,aAAc,WACjB,GAAG+B,WAAY,CAEd,GAAIC,GAAYD,WAAWE,mBACvBC,EAAoBH,WAAWI,mBAEnC3C,GAAE4C,KAAKJ,EAAW,SAASK,EAAOhC,GAEjC,GAAIiC,GAAgBX,cAChBY,EAAmB/C,EAAE8C,GAAeE,KAAK,oBAC3BhD,GAAE8C,GAAeE,KAAK,eAExChD,GAAE+C,GAAkBlC,IAAIA,GACxBoC,iBAAiBjD,EAAE+C,GAAkBlC,MAAOiC,EAAeJ,EAAkBG,QAQ5EV,YAAc,WACjB,GAAIe,KACJA,GAAaV,UAAYzC,YACzB,IAAIoD,GAAWnD,EAAE,iBAAiBoD,OAC9BC,EAAWC,WAAWC,QAAQJ,GAC9BC,EAAOC,EAASH,GAChBM,EAAexD,EAAEoD,EACRpD,GAAE,mBAAmByD,OAAOD,EACzC,OAAOxD,GAAEwD,IAGNP,iBAAmB,SAASS,EAAYC,EAAaC,GACxD5D,EAAEI,QAAQC,SAAW,oBAAsBqD,KAAgB,SAASpD,EAAMC,GACzE,GAAIsD,GAAc7D,EAAE2D,GAAaX,KAAK,eACtChD,GAAE6D,GAAaC,QACf9D,EAAE4C,KAAKtC,EAAM,SAASuC,EAAOhC,GAC5Bb,EAAE6D,GAAaE,OAAO/D,EAAE,YAAagE,MAAOnB,IAAQoB,KAAKpD,MAEvD+C,IACF5D,EAAE6D,GAAahD,IAAI+C,GACnB5D,EAAE6D,GAAaK,QAAQ,aAK1BlE,GAAEC,UAAUQ,GAAG,SAAU,oBAAqB,SAASwB,GAEtD,GAAIyB,GAAa1D,EAAEmE,MAAMtD,MACrB8C,EAAc3D,EAAEmE,MAAMC,QAAQ,eAClCnB,kBAAiBS,EAAYC,EAAa,QAG3C3D,EAAEC,UAAUQ,GAAG,SAAU,eAAgB,SAASwB,GACjD,GAAI0B,GAAc3D,EAAEmE,MAAMC,QAAQ,gBAC9BC,EAAarE,EAAEmE,MAAMtD,MACrB6C,EAAa1D,EAAE2D,GAAaX,KAAK,qBAAqBnC,MACtDgD,EAAc7D,EAAE2D,GAAaX,KAAK,+BACtCsB,gBAAeZ,EAAYW,EAAYR","file":"customSearch.min.js","sourcesContent":["var templateList = \"\";\n\n\n$(document).ready(function() {\n\n\n\tjQuery.getJSON(basePath + 'search/getTemplates', {}, function(json, textStatus) {\n\t\ttemplateList = json;\n\t\tprepopulate();\n\t});\n\n\n\t$(\"#customSaveButton\").on(\"click\", function() {\n\t\tvar result = $(\"#customSearchForm\").serializeForm();\n\t\tvar searchId = $(\"#searchId\").val();\n\t\tvar searchTitle = $(\"#inputSearchTitle\").val();\n\t\t$.post(basePath + \"search/saveSearch\", { searchTitle: searchTitle, searchData: result, customSearchId: searchId }, function(data, textStatus, xhr) {\n\t\t\tif(data) {\n\t\t\t\t$(\"#searchId\").val(data);\n\t\t\t\tpathAddition = \"\";\n\t\t\t\tif(basePath != \"/\") {\n\t\t\t\t\tpathAddition = basePath;\n\t\t\t\t}\n\t\t\t\tvar newurl = window.location.protocol + \"//\" + window.location.host + pathAddition + \"/search/searchBuilder/\"  + data;\n\t\t\t\twindow.history.pushState({path:newurl},'',newurl);\n\t\t\t\tbootbox.alert(\"<h2>Saved</h2>\");\n\t\t\t\twindow.setTimeout(function(){\n\t\t\t\t\tbootbox.hideAll();\n\t\t\t\t}, 1500);\n\t\t\t}\n\t\t});\n\t});\n\n\n\t$(\".addGroup\").on('click', function(event) {\n\t\tevent.preventDefault();\n\t\taddNewGroup();\n\t});\n\n\n\t$(\"#searchButton\").on('click', function(event) {\n\n\t\tstoreAndSearch(\"\", $(\"#customSearchForm\"));\n\n\t});\n\n\n\n\n});\n\n$(document).on(\"keypress\", 'input', function(e) {\n    if (e.keyCode == 13) {\n        storeAndSearch(\"\", $(\"#customSearchForm\"));\n        return false;\n    }\n});\n\n\nvar prepopulate = function() {\n\tif(presetInfo) {\n\n\t\tvar templates = presetInfo.specificTemplateId;\n\t\tvar searchFieldValues = presetInfo.specificSearchField;\n\n\t\t$.each(templates, function(index, val) {\n\n\t\t\tvar targetElement = addNewGroup();\n\t\t\tvar templateSelector = $(targetElement).find(\".templateSelector\");\n\t\t\tvar searchField = $(targetElement).find(\".searchField\");\n\n\t\t\t$(templateSelector).val(val);\n\t\t\tloadSearchFields($(templateSelector).val(), targetElement, searchFieldValues[index]);\n\n\t\t});\n\n\t}\n\n};\n\nvar addNewGroup = function() {\n\tvar injectObject = {};\n\tinjectObject.templates = templateList;\n\tvar source   = $(\"#search-entry\").html();\n\tvar template = Handlebars.compile(source);\n\tvar html = template(injectObject);\n\tvar insertObject = $(html);\n\tvar result = $(\".addButtonGroup\").before(insertObject);\n\treturn $(insertObject);\n};\n\nvar loadSearchFields = function(templateId, parentGroup, targetValue) {\n\t$.getJSON(basePath + 'search/getFields/' + templateId, {}, function(json, textStatus) {\n\t\tvar targetGroup = $(parentGroup).find(\".searchField\");\n\t\t$(targetGroup).empty();\n\t\t$.each(json, function(index, val) {\n\t\t\t$(targetGroup).append($('<option>', {value: index}).text(val));\n\t\t});\n\t\tif(targetValue) {\n\t\t\t$(targetGroup).val(targetValue);\n\t\t\t$(targetGroup).trigger(\"change\");\n\t\t}\n\t});\n};\n\n$(document).on('change', \".templateSelector\", function(event) {\n\n\tvar templateId = $(this).val();\n\tvar parentGroup = $(this).closest('.searchGroup');\n\tloadSearchFields(templateId, parentGroup, null);\n});\n\n$(document).on('change', \".searchField\", function(event) {\n\tvar parentGroup = $(this).closest('.searchGroup');\n\tvar fieldTitle = $(this).val();\n\tvar templateId = $(parentGroup).find(\".templateSelector\").val();\n\tvar targetGroup = $(parentGroup).find(\".specificSearchTextContainer\");\n\tbuildFieldInfo(templateId, fieldTitle, targetGroup);\n});\n"],"sourceRoot":"/source/"}