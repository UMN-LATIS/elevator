{"version":3,"file":"customSearch.min.js","sources":["customSearch.js"],"sourcesContent":["var templateList = \"\";\n\n\n$(document).ready(function() {\n\n\n\tjQuery.getJSON(basePath + 'search/getTemplates', {}, function(json, textStatus) {\n\t\ttemplateList = json;\n\t\tprepopulate();\n\t});\n\n\n\t$(\"#customSaveButton\").on(\"click\", function() {\n\t\tvar result = $(\"#customSearchForm\").serializeForm();\n\t\tvar searchId = $(\"#searchId\").val();\n\t\tvar searchTitle = $(\"#inputSearchTitle\").val();\n\t\t$.post(basePath + \"search/saveSearch\", { searchTitle: searchTitle, searchData: result, customSearchId: searchId }, function(data, textStatus, xhr) {\n\t\t\tif(data) {\n\t\t\t\t$(\"#searchId\").val(data);\n\t\t\t\tpathAddition = \"\";\n\t\t\t\tif(basePath != \"/\") {\n\t\t\t\t\tpathAddition = basePath;\n\t\t\t\t}\n\t\t\t\tvar newurl = window.location.protocol + \"//\" + window.location.host + pathAddition + \"/search/searchBuilder/\"  + data;\n\t\t\t\twindow.history.pushState({path:newurl},'',newurl);\n\t\t\t\tbootbox.alert(\"<h2>Saved</h2>\");\n\t\t\t\twindow.setTimeout(function(){\n\t\t\t\t\tbootbox.hideAll();\n\t\t\t\t}, 1500);\n\t\t\t}\n\t\t});\n\t});\n\n\n\t$(\".addGroup\").on('click', function(event) {\n\t\tevent.preventDefault();\n\t\taddNewGroup();\n\t});\n\n\n\t$(\"#searchButton\").on('click', function(event) {\n\n\t\tstoreAndSearch(\"\", $(\"#customSearchForm\"));\n\n\t});\n\n\n\n\n});\n\n$(document).on(\"keypress\", 'input', function(e) {\n    if (e.keyCode == 13) {\n        storeAndSearch(\"\", $(\"#customSearchForm\"));\n        return false;\n    }\n});\n\n\nvar prepopulate = function() {\n\tif(presetInfo) {\n\n\t\tvar templates = presetInfo.specificTemplateId;\n\t\tvar searchFieldValues = presetInfo.specificSearchField;\n\n\t\t$.each(templates, function(index, val) {\n\n\t\t\tvar targetElement = addNewGroup();\n\t\t\tvar templateSelector = $(targetElement).find(\".templateSelector\");\n\t\t\tvar searchField = $(targetElement).find(\".searchField\");\n\n\t\t\t$(templateSelector).val(val);\n\t\t\tloadSearchFields($(templateSelector).val(), targetElement, searchFieldValues[index]);\n\n\t\t});\n\n\t}\n\n};\n\nvar addNewGroup = function() {\n\tvar injectObject = {};\n\tinjectObject.templates = templateList;\n\tvar source   = $(\"#search-entry\").html();\n\tvar template = Handlebars.compile(source);\n\tvar html = template(injectObject);\n\tvar insertObject = $(html);\n\tvar result = $(\".addButtonGroup\").before(insertObject);\n\treturn $(insertObject);\n};\n\nvar loadSearchFields = function(templateId, parentGroup, targetValue) {\n\t$.getJSON(basePath + 'search/getFields/' + templateId, {}, function(json, textStatus) {\n\t\tvar targetGroup = $(parentGroup).find(\".searchField\");\n\t\t$(targetGroup).empty();\n\t\t$.each(json, function(index, val) {\n\t\t\t$(targetGroup).append($('<option>', {value: index}).text(val));\n\t\t});\n\t\tif(targetValue) {\n\t\t\t$(targetGroup).val(targetValue);\n\t\t\t$(targetGroup).trigger(\"change\");\n\t\t}\n\t});\n};\n\n$(document).on('change', \".templateSelector\", function(event) {\n\n\tvar templateId = $(this).val();\n\tvar parentGroup = $(this).closest('.searchGroup');\n\tloadSearchFields(templateId, parentGroup, null);\n});\n\n$(document).on('change', \".searchField\", function(event) {\n\tvar parentGroup = $(this).closest('.searchGroup');\n\tvar fieldTitle = $(this).val();\n\tvar templateId = $(parentGroup).find(\".templateSelector\").val();\n\tvar targetGroup = $(parentGroup).find(\".specificSearchTextContainer\");\n\tbuildSearchForm(fieldTitle,templateId, targetGroup);\n});\n"],"names":["templateList","prepopulate","$","document","ready","jQuery","getJSON","basePath","json","textStatus","on","result","serializeForm","searchId","val","searchTitle","post","searchData","customSearchId","data","xhr","pathAddition","newurl","window","location","protocol","host","history","pushState","path","bootbox","alert","setTimeout","hideAll","event","preventDefault","addNewGroup","storeAndSearch","e","keyCode","templates","searchFieldValues","presetInfo","specificTemplateId","specificSearchField","each","index","targetElement","templateSelector","find","loadSearchFields","injectObject","source","html","Handlebars","compile","insertObject","before","templateId","parentGroup","targetValue","targetGroup","empty","append","value","text","trigger","this","closest","fieldTitle","buildSearchForm"],"mappings":"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"}