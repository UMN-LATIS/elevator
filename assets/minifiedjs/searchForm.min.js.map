{"version":3,"sources":["searchForm.js"],"names":["targetTemplate","listTemplate","$","document","on","specificSearch","this","closest","newSpecificSearch","clone","find","val","after","collectionCopy","newCollection","selectedOption","content","templateId","data","targetGroup","post","basePath","fieldTitle","template","textStatus","xhr","results","parseJSON","e","console","log","type","html","selectElement","each","values","index","append","value","text","ready","parseHash","empty","searchId","window","location","hash","length","currentPageNumber","previousEventComplete","searchQuery","JSON","stringify","serializeForm","cachedResults","cachedDates","alert","success","matches","objectId","cookie","pathname","disableHashChange","dataAvailable","show","processSearchResults","setTimeout","hasClass","modal"],"mappings":"AAAA,GAAIA,gBAAiB,mBACjBC,aAAe,gBAKnBC,GAAEC,UAAUC,GAAG,QAAS,sBAAuB,WAE3C,GAAIC,GAAiBH,EAAEI,MAAMC,QAAQ,mBACjCC,EAAoBN,EAAEG,GAAgBI,OAAM,EAChDD,GAAkBE,KAAK,sBAAsBC,IAAI,IACjDT,EAAEG,GAAgBO,MAAMJ,KAI5BN,EAAEC,UAAUC,GAAG,QAAS,wBAAyB,WAC7C,GAAIS,GAAiBX,EAAEI,MAAMC,QAAQ,eACjCO,EAAgBZ,EAAEW,GAAgBJ,OAAM,EAC5CK,GAAcJ,KAAK,sBAAsBC,IAAI,IAC7CT,EAAEW,GAAgBD,MAAME,KAK5BZ,EAAEC,UAAUC,GAAG,SAAU,kBAAmB,WACxC,GAAIW,GAAiBb,EAAEI,MAAMI,KAAK,aAC9BM,EAAUd,EAAEa,GAAgBJ,MAC5BM,EAAaf,EAAEa,GAAgBG,KAAK,cACpCC,EAAcjB,EAAEI,MAAMC,QAAQ,eAAeG,KAAK,+BACtDR,GAAEkB,KAAKC,SAAW,wBAAyBC,WAAYN,EAASO,SAAUN,GAAa,SAASC,EAAMM,EAAYC,GAC9G,GAAIC,EACJ,KACIA,EAAUxB,EAAEyB,UAAUT,GAE1B,MAAMU,GACFC,QAAQC,IAAI,kBAGG,QAAhBJ,EAAQK,MACP7B,EAAEiB,GAAaa,KAAK,IACpB9B,EAAEiB,GAAaa,KAAK,4IAGpB9B,EAAEiB,GAAaa,KAAK,IACpB9B,EAAEiB,GAAaa,KAAK,sHACpBC,cAAgB/B,EAAEiB,GAAaT,KAAK,UACpCR,EAAEgC,KAAKR,EAAQS,OAAQ,SAASC,EAAOzB,GACnCT,EAAE+B,eAAeI,OAAOnC,EAAE,YAAaoC,MAAO3B,IAAM4B,KAAK5B,WAazET,EAAEC,UAAUqC,MAAM,WAEdC,YAEAvC,EAAEC,UAAUC,GAAG,SAAU,cAAe,WAkDpC,MAjDAF,GAAE,YAAYwC,QACdxC,EAAE,gBAAgBwC,QAClBxC,EAAE,YAAYwC,QACdC,SAAW,GACRC,OAAOC,SAASC,KAAKC,OAAS,EAKjCC,kBAAoB,EACpBC,uBAAwB,EAExB/C,EAAEkB,KAAMC,SAAW,wBAA0BsB,UAAWO,YAAYC,KAAKC,UAAUlD,EAAGI,MAAO+C,kBAAmB,SAAUnC,GACtH,IACIoC,cAAgBpD,EAAEyB,UAAUT,GAC5BqC,YAAc,KAElB,MAAM3B,GACF4B,MAAM5B,EAAI,IAAMV,GAGpB,GAAGoC,cAAcG,WAAY,EAAM,CAE/B,GAAmC,GAAhCH,cAAcI,QAAQX,OAAa,CAElC,GAAIY,GAAWL,cAAcI,QAAQ,GAAGC,QACxCzD,GAAE0D,OAAO,aAAcjB,UACvBC,OAAOC,SAASC,KAAO,GACvBF,OAAOC,SAASgB,SAAWxC,SAAW,oBAAsBsC,EAEhEhB,SAAWW,cAAcX,SACzBmB,mBAAoB,EACpBlB,OAAOC,SAASC,KAAOH,SAEvBoB,eAAgB,EAChB7D,EAAE,mBAAmB8D,OACrBC,qBAAqBX,eACrBY,WAAW,WACPJ,mBAAoB,GACrB,KAGA5D,EAAE,wBAAwBiE,SAAS,OAClCjE,EAAE,wBAAwBkE,MAAM,YAMrC","file":"searchForm.min.js","sourcesContent":["var targetTemplate = \"#result-template\";\nvar listTemplate = \"#list-template\";\n\n\n\n\n$(document).on(\"click\", \".addAnotherSpecific\", function() {\n\n    var specificSearch = $(this).closest('.specificSearch');\n    var newSpecificSearch = $(specificSearch).clone(false);\n    newSpecificSearch.find(\"input[type='text']\").val(\"\");\n    $(specificSearch).after(newSpecificSearch);\n\n});\n\n$(document).on(\"click\", \".addAnotherCollection\", function() {\n    var collectionCopy = $(this).closest('.form-group');\n    var newCollection = $(collectionCopy).clone(false);\n    newCollection.find(\"input[type='text']\").val(\"\");\n    $(collectionCopy).after(newCollection);\n});\n\n\n\n$(document).on(\"change\", \".searchDropdown\", function() {\n    var selectedOption = $(this).find(\":selected\");\n    var content = $(selectedOption).val();\n    var templateId = $(selectedOption).data('templateid');\n    var targetGroup = $(this).closest(\".form-group\").find(\".specificSearchTextContainer\");\n    $.post(basePath + '/search/getFieldInfo', {fieldTitle: content, template: templateId}, function(data, textStatus, xhr) {\n        var results;\n        try {\n            results = $.parseJSON(data);\n        }\n        catch(e) {\n            console.log(\"error occurred\");\n        }\n\n        if(results.type == \"text\") {\n            $(targetGroup).html(\"\");\n            $(targetGroup).html('<input type=\"text\" name=\"specificSearchText[]\"  autocomplete=\"off\" class=\"form-control advancedOption advancedSearchContent\" value=\"\">');\n        }\n        else {\n            $(targetGroup).html(\"\");\n            $(targetGroup).html('<select name=\"specificSearchText[]\"  autocomplete=\"off\" class=\"form-control advancedOption advancedSearchContent\">');\n            selectElement = $(targetGroup).find(\"select\");\n            $.each(results.values, function(index, val) {\n                $(selectElement).append($('<option>', {value: val}).text(val));\n            });\n\n        }\n\n    });\n\n\n\n});\n\n\n\n$(document).ready(function() {\n\n    parseHash();\n\n    $(document).on(\"submit\", \".searchForm\", function() {\n        $(\"#results\").empty();\n        $(\"#listResults\").empty();\n        $(\".suggest\").empty();\n        searchId = \"\";\n        if(window.location.hash.length > 0) {\n            // for now, let's try not persisting search results?\n        //    searchId = window.location.hash.substring(1);\n        }\n\n        currentPageNumber = 0;\n        previousEventComplete = false;\n\n        $.post( basePath + \"search/searchResults/\" + searchId, {searchQuery:JSON.stringify($( this ).serializeForm())}, function( data ) {\n            try{\n                cachedResults = $.parseJSON(data);\n                cachedDates = null;\n            }\n            catch(e){\n                alert(e + \" \" + data);\n            }\n\n            if(cachedResults.success === true) {\n\n                if(cachedResults.matches.length == 1) {\n                    // special case - one match, let's just load it\n                    var objectId = cachedResults.matches[0].objectId;\n                    $.cookie('lastSearch', searchId);\n                    window.location.hash = \"\";\n                    window.location.pathname = basePath + \"/asset/viewAsset/\" + objectId;\n                }\n                searchId = cachedResults.searchId;\n                disableHashChange = true;\n                window.location.hash = searchId;\n\n                dataAvailable = true;\n                $(\"#loadAllResults\").show();\n                processSearchResults(cachedResults);\n                setTimeout(function() {\n                    disableHashChange = false;\n                }, 500);\n\n\n                if($('#advancedSearchModal').hasClass('in')) {\n                    $('#advancedSearchModal').modal('hide');\n                }\n\n            }\n\n        });\n        return false;\n    });\n});"],"sourceRoot":"/source/"}