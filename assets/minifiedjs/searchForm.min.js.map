{"version":3,"file":"searchForm.min.js","sources":["searchForm.js"],"sourcesContent":["\n\nfunction resetSearchFrame() {\n    $(\"#results\").empty();\n    $(\"#listResults\").empty();\n    $(\".frame ul\").empty();\n    $(\".suggest\").empty();\n    if(galleryFrame) {\n        galleryFrame.destroy();\n        galleryFrame = null;    \n    }\n    $(\".galleryIframe\").attr(\"src\",\"\");\n    \n}\n\nvar performSearchForButtonPress = function(targetForm) {\n\n    resetSearchFrame();\n    searchId = \"\";\n    if(window.location.hash.length > 0) {\n        // for now, let's try not persisting search results?\n    //    searchId = window.location.hash.substring(1);\n    }\n\n    currentPageNumber = 0;\n    previousEventComplete = false;\n    $.post( basePath + \"search/searchResults/\" + searchId, {searchQuery:JSON.stringify($( targetForm ).serializeForm())}, function( data ) {\n        try{\n            cachedResults = data;\n            cachedDates = null;\n        }\n        catch(e){\n            alert(e + \" \" + data);\n        }\n\n\n        if(cachedResults.success === true) {\n\n            if(cachedResults.matches.length == 1) {\n                // special case - one match, let's just load it\n                var objectId = cachedResults.matches[0].objectId;\n                $.cookie('lastSearch', searchId);\n                window.location.hash = \"\";\n                window.location.pathname = basePath + \"/asset/viewAsset/\" + objectId;\n            }\n            searchId = cachedResults.searchId;\n            \n            cachedResults.totalLoadedCount = cachedResults.matches.length;\n            \n            disableHashChange = true;\n            currentURL = window.location.href.replace(window.location.hash,\"\");\n            currentHash = window.location.hash.replace(\"#\", \"\");\n            var oldSearchId = currentURL.substr(currentURL.lastIndexOf('/') + 1);\n            window.history.pushState({}, \"Search Results\", window.location.href.replace(oldSearchId, searchId));\n\n\n            dataAvailable = true;\n            $(\"#loadAllResults\").show();\n            processSearchResults(cachedResults);\n            setTimeout(function() {\n                disableHashChange = false;\n            }, 500);\n\n\n            if($('#advancedSearchModal').hasClass('in')) {\n                $('#advancedSearchModal').modal('hide');\n            }\n\n        }\n    }).fail(function (e) {\n        if (e.readyState > 0) {\n            alert(JSON.stringify(e));\n        }\n\n    });\n    return false;\n}\n\n\n$(document).ready(function() {\n\n    parseSearch();\n\n    $(document).on(\"submit\", \".searchForm\", function() {\n        if($(this).attr(\"id\") == \"advancedSearchForm\") {\n            // do nothing\n        }\n        else {\n            // when they hit the global search button, it should be a global search.  We might have ended up with a stored collection though, expunge that.\n            // $(this).find(\"#collection\").val('0');\n            $(this).find(\"#specificSearchField\").val('');\n            $(this).find(\"#specificSearchText\").val('');\n            $(\".collectionHeader\").html('');\n        }\n\n        performSearchForButtonPress(this);\n        return false;\n    });\n});"],"names":["resetSearchFrame","$","empty","galleryFrame","destroy","attr","performSearchForButtonPress","targetForm","searchId","window","location","hash","length","currentPageNumber","previousEventComplete","post","basePath","searchQuery","JSON","stringify","serializeForm","data","cachedResults","cachedDates","e","alert","success","matches","objectId","cookie","pathname","totalLoadedCount","disableHashChange","currentURL","href","replace","currentHash","oldSearchId","substr","lastIndexOf","history","pushState","dataAvailable","show","processSearchResults","setTimeout","hasClass","modal","fail","readyState","document","ready","parseSearch","on","this","find","val","html"],"mappings":"AAEA,SAASA,mBACLC,EAAE,UAAU,EAAEC,MAAM,EACpBD,EAAE,cAAc,EAAEC,MAAM,EACxBD,EAAE,WAAW,EAAEC,MAAM,EACrBD,EAAE,UAAU,EAAEC,MAAM,EACjBC,eACCA,aAAaC,QAAQ,EACrBD,aAAe,MAEnBF,EAAE,gBAAgB,EAAEI,KAAK,MAAM,EAAE,CAErC,CAEA,IAAIC,4BAA8B,SAASC,GA4DvC,OA1DAP,iBAAiB,EACjBQ,SAAW,GACRC,OAAOC,SAASC,KAAKC,OAKxBC,kBAAoB,EACpBC,sBAAwB,CAAA,EACxBb,EAAEc,KAAMC,SAAW,wBAA0BR,SAAU,CAACS,YAAYC,KAAKC,UAAUlB,EAAGM,CAAW,EAAEa,cAAc,CAAC,CAAC,EAAG,SAAUC,GAC5H,IACIC,cAAgBD,EAChBE,YAAc,IAIlB,CAFA,MAAMC,GACFC,MAAMD,EAAI,IAAMH,CAAI,CACxB,CAG6B,CAAA,IAA1BC,cAAcI,UAEsB,GAAhCJ,cAAcK,QAAQf,SAEjBgB,EAAWN,cAAcK,QAAQ,GAAGC,SACxC3B,EAAE4B,OAAO,aAAcrB,QAAQ,EAC/BC,OAAOC,SAASC,KAAO,GACvBF,OAAOC,SAASoB,SAAWd,SAAW,oBAAsBY,GAEhEpB,SAAWc,cAAcd,SAEzBc,cAAcS,iBAAmBT,cAAcK,QAAQf,OAEvDoB,kBAAoB,CAAA,EACpBC,WAAaxB,OAAOC,SAASwB,KAAKC,QAAQ1B,OAAOC,SAASC,KAAK,EAAE,EACjEyB,YAAc3B,OAAOC,SAASC,KAAKwB,QAAQ,IAAK,EAAE,EAC9CE,EAAcJ,WAAWK,OAAOL,WAAWM,YAAY,GAAG,EAAI,CAAC,EACnE9B,OAAO+B,QAAQC,UAAU,GAAI,iBAAkBhC,OAAOC,SAASwB,KAAKC,QAAQE,EAAa7B,QAAQ,CAAC,EAGlGkC,cAAgB,CAAA,EAChBzC,EAAE,iBAAiB,EAAE0C,KAAK,EAC1BC,qBAAqBtB,aAAa,EAClCuB,WAAW,WACPb,kBAAoB,CAAA,CACxB,EAAG,GAAG,EAGH/B,EAAE,sBAAsB,EAAE6C,SAAS,IAAI,IACtC7C,EAAE,sBAAsB,EAAE8C,MAAM,MAAM,CAIlD,CAAC,EAAEC,KAAK,SAAUxB,GACK,EAAfA,EAAEyB,YACFxB,MAAMP,KAAKC,UAAUK,CAAC,CAAC,CAG/B,CAAC,EACM,CAAA,CACX,EAGAvB,EAAEiD,QAAQ,EAAEC,MAAM,WAEdC,YAAY,EAEZnD,EAAEiD,QAAQ,EAAEG,GAAG,SAAU,cAAe,WAapC,MAZyB,sBAAtBpD,EAAEqD,IAAI,EAAEjD,KAAK,IAAI,IAMhBJ,EAAEqD,IAAI,EAAEC,KAAK,sBAAsB,EAAEC,IAAI,EAAE,EAC3CvD,EAAEqD,IAAI,EAAEC,KAAK,qBAAqB,EAAEC,IAAI,EAAE,EAC1CvD,EAAE,mBAAmB,EAAEwD,KAAK,EAAE,GAGlCnD,4BAA4BgD,IAAI,EACzB,CAAA,CACX,CAAC,CACL,CAAC"}