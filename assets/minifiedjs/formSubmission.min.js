function submitFormWithDelay(e,t){clearTimeout(submitTimer),submitTimer=setTimeout(function(){submitFormProtected(e,t)},1e3)}function submitForm(e,t){clearTimeout(submitTimer),submitFormProtected(e,t)}function submitFormProtected(e,t){return window.unsavedChildren>0&&!e?(bootbox.dialog({message:"You have unsaved nested assets.  Please save or close them before submitting the parent.",title:"Unsaved Assets",backdrop:!0,buttons:{success:{label:"Ignore and Save",className:"btn-warning",callback:function(){submitForm(!0)}},cancel:{label:"Cancel",className:"btn-default"}}}),!1):($("#entryForm").parsley("validate"),$(".nestediIFrame").each(function(e,t){var a=$(t).contents().find("form");if($(a).hasClass("dirty")){$(t)[0].contentWindow.submitForm(!0,!0);var o=$(t).contents().find("#inputObjectId").val();$(t).closest(".widgetContents").find(".targetAsset").val(o)}}),showHaveEntries(),-1==$("#collectionId").val()?void bootbox.dialog({message:"Collection cannot be empty.",title:"Invalid Collction",backdrop:!0,buttons:{cancel:{label:"OK",className:"btn-primary"}}}):$("#entryForm").parsley("isValid")?(t&&$.ajaxSetup({async:!1}),void $.post(basePath+"assetManager/submission",{formData:JSON.stringify($("#entryForm").serializeForm())},function(e){try{jsonObject=$.parseJSON(e)}catch(a){alert(a+" "+e)}if(jsonObject.success===!0){if(objectId=jsonObject.objectId,$(".regenerateDerivatives").prop("checked",!1),t||(bootbox.alert("<h2>Saved</h2>"),window.setTimeout(function(){bootbox.hideAll(),$("#collectionMigrationInProcess").trigger("change")},1500)),hasParent&&notifyParentOfSave(objectId),loadPreviewAndUpdateTitle(objectId),markSaveClean(),$("#inputObjectId").val(objectId),$(".viewAsset").show(),$(".deleteFile").removeAttr("disabled"),history.pushState){pathAddition="","/"!=basePath&&(pathAddition=basePath);var o=window.location.protocol+"//"+window.location.host+pathAddition+"/assetManager/editAsset/"+objectId;window.history.pushState({path:o},"",o)}}else bootbox.dialog({message:"An error was returned while saving your asset.  Check your internet connection and try saving again.  If it continues to fail, you may need to refresh the page.  Any unsaved changes will be lost.",title:"Error Occured During Save",backdrop:!0,buttons:{cancel:{label:"OK",className:"btn-primary"}}})}).fail(function(){bootbox.dialog({message:"An error was returned while saving your asset.  Check your internet connection and try saving again.  If it continues to fail, you may need to refresh the page.  Any unsaved changes will be lost.",title:"Error Occured During Save",backdrop:!0,buttons:{cancel:{label:"OK",className:"btn-primary"}}})})):(bootbox.dialog({message:"You have errors or missing/invalid values in your asset.  Your asset cannot be saved until this issues are corrected.",title:"Invalid Entry",backdrop:!0,buttons:{cancel:{label:"OK",className:"btn-primary"}}}),!1))}function loadPreviewAndUpdateTitle(e){var t=$("#minipreview-template").html(),a=Handlebars.compile(t);$.get(basePath+"asset/getAssetPreview/"+e,function(e){try{jsonObject=$.parseJSON(e)}catch(t){return void alert(t+" "+e)}if(jsonObject){var o=jsonObject;o.base_url=basePath;var n=a(o);$(".miniPreview").html(n);var s=o.title;s||(s="");var i=document.title.split(" | ");document.title="Edit Asset: "+s+" | "+i[1]}})}var submitTimer=null;
//# sourceMappingURL=formSubmission.min.js.map
