var map={},markers={};function loadMap(e){var a=getHostIdForElement(e),t=(map[a]&&(clearMarkers(a),map[a].off(),map[a].remove()),L.esri.basemapLayer("Topographic",{detectRetina:!0,maxNativeZoom:18,maxZoom:21})),r=L.esri.basemapLayer("Imagery",{detectRetina:!0,maxNativeZoom:18,maxZoom:20}),o=L.esri.basemapLayer("ImageryLabels");map[a]=L.map(e,{layers:[t]}).setView([40,-94],5),L.control.layers({Topo:t,Satellite:r},{"Satellite Labels":o}).addTo(map[a]),L.control.locate&&L.control.locate({icon:"glyphicon glyphicon-map-marker"}).addTo(map[a]),$(".leaflet-control-layers-overlays").find(".leaflet-control-layers-selector").attr("name","satelliteToggle"),map[a].on("baselayerchange",function(e){("Satellite"==e.name||1==$(".leaflet-control-layers-overlays").find(".leaflet-control-layers-selector").prop("checked"))&&$(".leaflet-control-layers-overlays").find(".leaflet-control-layers-selector").trigger("click")})}function clearMarkers(e){markers[e]&&markers[e].clearLayers()}function createMarker(e,a,t,r,o,n){markers[e]||(markers[e]=new L.layerGroup);a=new L.Marker([a,t],{draggable:!0});return markers[e].addLayer(a),map[e].addLayer(markers[e]),a.on("dragend",function(e){r.val(e.target.getLatLng().lat),o.val(e.target.getLatLng().lng)}),n&&centerLeafletMapOnMarker(e,a),a}function centerLeafletMapOnMarker(e,a){a=[a.getLatLng()],a=L.latLngBounds(a);map[e].fitBounds(a,{maxZoom:15})}$(document).on("click",".clearMarker",function(){var e=$(this).closest(".mapContainer").find(".mapWidget");clearMarkers(getHostIdForElement(e))}),$(document).off("click",".searchMap"),$(document).on("click",".searchMap",function(){var e=$(this).closest(".mapContainer").find(".address").first().val(),a=$(this).closest(".mapContainer").find(".mapWidget"),t=$(this).closest(".mapContainer").find(".latitude"),r=$(this).closest(".mapContainer").find(".longitude"),o=getHostIdForElement(a);clearMarkers(o);(new google.maps.Geocoder).geocode({address:e},function(e,a){a==google.maps.GeocoderStatus.OK&&(e[0].geometry.location,a=e[0].geometry.location.lat(),e=e[0].geometry.location.lng(),marker=createMarker(o,a,e,t,r,!0),t.val(a),r.val(e),$(t).trigger("change"),$(r).trigger("change"))})}),$(document).on("change",".geoField",function(){var e=$(this).closest(".mapContainer").find(".latitude"),a=$(this).closest(".mapContainer").find(".longitude"),t=$(this).closest(".mapContainer").find(".mapWidget"),t=getHostIdForElement(t);clearMarkers(t),0!==e.val().length&&0!==a.val().length&&createMarker(t,e.val(),a.val(),e,a,!1)}),$(document).on("hidden.bs.collapse",".maphost",function(){var e=$(this).parent().find(".mapWidget"),e=getHostIdForElement(e);clearMarkers(e),map[e].off(),map[e].remove(),$(this).parent().find(".mapToggle").html("Reveal Map")}),$(document).on("shown.bs.collapse",".maphost",function(){$(this).parent().find(".mapToggle").html("Hide Map");var e=$(this).find(".mapWidget"),a=$(this).parent().find(".latitude"),t=$(this).parent().find(".longitude");revealMap(e[0],a,t)});var getHostIdForElement=function(e){return"object"==typeof e?$(e).closest(".maphost").attr("id"):e},revealMap=function(e,a,t){loadMap(e);var r=getHostIdForElement(e),e=(map[r].on("click",function(e){0<markers[r].getLayers().length||(createMarker(r,e.latlng.lat,e.latlng.lng,a,t,!1),a.val(e.latlng.lat),t.val(e.latlng.lng))}),t.val()),o=a.val();markers[r]||(markers[r]=new L.layerGroup),""!==e?createMarker(r,o,e,a,t,!0):map[r].setView([46,-94],6)};
//# sourceMappingURL=mapWidget.min.js.map
