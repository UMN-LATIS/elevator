var map=null,markers=null;function loadMap(e){map&&(clearMarkers(),map.off(),map.remove()),layer1=L.esri.basemapLayer("Topographic",{detectRetina:!0,maxNativeZoom:18,maxZoom:21}),layer2=L.esri.basemapLayer("Imagery",{detectRetina:!0,maxNativeZoom:18,maxZoom:20});var a=L.esri.basemapLayer("ImageryLabels");map=L.map(e,{layers:[layer1]}).setView([40,-94],5),L.control.layers({Topo:layer1,Satellite:layer2},{"Satellite Labels":a}).addTo(map),L.control.locate&&L.control.locate({icon:"glyphicon glyphicon-map-marker"}).addTo(map),$(".leaflet-control-layers-overlays").find(".leaflet-control-layers-selector").attr("name","satelliteToggle"),map.on("baselayerchange",function(e){"Satellite"==e.name?$(".leaflet-control-layers-overlays").find(".leaflet-control-layers-selector").trigger("click"):1==$(".leaflet-control-layers-overlays").find(".leaflet-control-layers-selector").prop("checked")&&$(".leaflet-control-layers-overlays").find(".leaflet-control-layers-selector").trigger("click")})}function clearMarkers(){markers&&markers.clearLayers()}function createMarker(e,a,r,t,l){var o=new L.Marker([e,a],{draggable:!0});return markers.addLayer(o),map.addLayer(markers),o.on("dragend",function(e){r.val(e.target.getLatLng().lat),t.val(e.target.getLatLng().lng)}),l&&centerLeafletMapOnMarker(o),o}function centerLeafletMapOnMarker(e){var a=[e.getLatLng()],r=L.latLngBounds(a);map.fitBounds(r,{maxZoom:15})}$(document).on("click",".clearMarker",function(){clearMarkers()}),$(document).on("click",".searchMap",function(){var e=$(this).closest(".mapContainer").find(".address").first().val(),a=($(this).closest(".mapContainer").find(".mapWidget"),$(this).closest(".mapContainer").find(".latitude")),r=$(this).closest(".mapContainer").find(".longitude");clearMarkers();var t={position:null};(new google.maps.Geocoder).geocode({address:e},function(e,l){if(l==google.maps.GeocoderStatus.OK){t.position=e[0].geometry.location,t.geocode=!0;var o=e[0].geometry.location.lat(),n=e[0].geometry.location.lng();marker=createMarker(o,n,a,r,!0),a.val(o),r.val(n),$(a).trigger("change"),$(r).trigger("change")}})}),$(document).on("change",".geoField",function(){clearMarkers();var e=$(this).closest(".mapContainer").find(".latitude"),a=$(this).closest(".mapContainer").find(".longitude");0!==e.val().length&&0!==a.val().length&&createMarker(e.val(),a.val(),e,a,!1)}),$(document).on("hidden.bs.collapse",".maphost",function(){clearMarkers(),map.off(),map.remove(),$(this).parent().find(".mapToggle").html("Reveal Map")}),$(document).on("shown.bs.collapse",".maphost",function(){$(this).parent().find(".mapToggle").html("Hide Map");var e=$(this).find(".mapWidget"),a=$(this).parent().find(".latitude"),r=$(this).parent().find(".longitude");revealMap(e[0],a,r)});var revealMap=function(e,a,r){loadMap(e),map.on("click",function(e){markers.getLayers().length>0||(createMarker(e.latlng.lat,e.latlng.lng,a,r,!1),a.val(e.latlng.lat),r.val(e.latlng.lng))});var t=r.val(),l=a.val();markers||(markers=new L.layerGroup),""!==t?createMarker(l,t,a,r,!0):map.setView([46,-94],6)};
//# sourceMappingURL=mapWidget.min.js.map
