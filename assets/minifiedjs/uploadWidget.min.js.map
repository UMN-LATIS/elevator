{"version":3,"file":"uploadWidget.min.js","sources":["uploadWidget.js"],"sourcesContent":["\n\nvar format_size = function(num_bytes) {\n    if(num_bytes <= 1024 * 0.8) {\n        return num_bytes + \" B\";\n    } else if(num_bytes <= 1024 * 1024 * 0.8) {\n        return parseInt(num_bytes / 1024, 10) + \".\" + parseInt(num_bytes / 1024 * 10, 10) % 10 + \" KB\";\n    } else if(num_bytes <= 1024 * 1024 * 1024 * 0.8) {\n        return parseInt(num_bytes / 1024 / 1024, 10) + \".\" + parseInt(num_bytes / 1024 / 1024 * 10, 10) % 10 + \" MB\";\n    } else {\n        return parseInt(num_bytes / 1024 / 1024 / 1024, 10) + \".\" + parseInt(num_bytes / 1024 / 1024 / 1024 * 10, 10) % 10 + \" GB\";\n    }\n};\n\nvar uploadCount=0;\n\nvar uploadFile = function(fileElement, uploadSettings, containerElement) {\n    var last_update = null;\n    var last_uploaded = null;\n    var fileObjectId = uploadSettings.fileObjectId;\n    $(containerElement).find(\".fileObjectId\").val(fileObjectId);\n    $(containerElement).find(\".fileObjectId\").trigger('change');\n    var localContainer = containerElement;\n    var chunkSize = 6*1024*1024;\n    if(!pollingForNewImage) {\n    \tcheckForNewImages();\t\n    }\n    \n    if(fastUpload) { // if we're in fast upload mode, use big chunks\n        chunkSize = 200*1024*1024;\n    }\n    var settings = {\n        key: uploadSettings.path + \"/\" + fileObjectId.split(\"\").reverse().join(\"\") +\"-source\",\n        access_key: uploadSettings.bucketKey,\n        ajax_base: basePath + \"uploadBackend/upload\",\n        bucket: uploadSettings.bucket,\n        collectionId: uploadSettings.collectionId,\n        num_workers: 6,\n        chunk_size: chunkSize,\n        content_type: fileElement.type,\n        max_size: 50 * (1 << 30), // 50gb\n        on_error: function() {\n            console.log(\"ERROR\");\n            $(localContainer).find(\".log\").prepend(\"Error occurred! You can help me fix this by filing a bug report here: https://github.com/cinely/mule-uploader/issues\\n\");\n        },\n        on_select: function(fileObj) {\n            $(localContainer).find(\".log\").prepend(\"File selected\\n\");\n        },\n        on_start: function(fileObj) {\n            window.uploadCount++;\n            $(localContainer).find(\".deleteFile\").hide();\n        },\n        on_progress: function(bytesUploaded, bytesTotal) {\n            if(!last_update || (new Date() - last_update) > 1000) {\n                var percent = bytesUploaded / bytesTotal * 100;\n                var speed = (bytesUploaded - last_uploaded) / (new Date() - last_update) * 1000;\n                last_update = new Date();\n                last_uploaded = bytesUploaded;\n                $(localContainer).find('.progress .progress-bar').width(percent / 100 * $(localContainer).find('.progress').width());\n                // var log = \"Upload progress: \" + format_size(bytesUploaded) + \" / \" + format_size(bytesTotal) + \" (\" + parseInt(percent, 10) + \".\" + parseInt(percent * 10, 10) % 10 + \"%)\";\n                // if(speed) {\n                //     log += \"; speed: \" + format_size(speed) + \"/s\";\n                // }\n                //$(parentElement).find(\".log\").prepend(log + \"\\n\");\n            }\n        },\n        on_init: function() {\n            //$(parentElement).find(\".log\").prepend(\"Uploader initialized\\n\");\n        },\n        on_complete: function() {\n            window.uploadCount--;\n            $.get(basePath+ 'assetManager/completeSourceFile/' + fileObjectId , function(data) {\n                $(localContainer).find(\".uploadProgress\").hide();\n            });\n            $(localContainer).find(\".cancelButton\").hide();\n            $(localContainer).find(\".deleteFile\").show();\n            $(localContainer).find(\".allowResume\").hide();\n\n        },\n        on_chunk_uploaded: function() {\n           // $(parentElement).find(\".log\").prepend(\"Chunk finished uploading\\n\");\n        }\n    };\n    upload = mule_upload(settings);\n    $(\"#collectionId\").attr(\"disabled\", true);\n    $(localContainer).find(\".uploadProgress\").show();\n    upload.upload_file(fileElement, false);\n    return upload;\n};\n\n\nvar resetCollection = function() {\n    if($(\"#collectionId\").val() != \"---\" && $(\"#collectionId\").val() !==\"\" && $(\"#collectionId\").val() != -1) {\n        $(\".uploadInformation\").show();\n        $(\".uploadWarning\").hide();\n    }\n    else {\n        $(\".uploadInformation\").hide();\n        $(\".uploadWarning\").show();\n    }\n};\n\n$(document).on(\"change\", \"#collectionId\", function() {\n    resetCollection();\n});\n\n$(document).on(\"click\", \".deleteData\", function() {\n\n    var fileId = $(this).closest(\".widgetContents\").find(\".fileObjectId\").val();\n    var self = this;\n    $.get(basePath+\"fileManager/removeData/\"+fileId,function(data) {\n        $(self).closest(\".widgetContents\").find(\".extractedData\").val(\"\");\n    });\n});\n\n$(document).on(\"click\", \".deleteFile\", function() {\n\n    var self = this;\n    bootbox.dialog({\n        message: \"Delete this upload object?  This action cannot be undone and will delete the source media and any derivatives.\",\n        title: \"Delete Object?\",\n        backdrop: true,\n        buttons: {\n            success: {\n                label: \"Delete\",\n                className: \"btn-danger\",\n                callback: function() {\n                    var fileObjectId = $(self).closest(\".widgetContents\").find(\".fileObjectId\").val();\n                    $.post(basePath+'fileManager/deleteFileObject', { fileObjectId: fileObjectId }, function(data, textStatus, xhr) {\n                        if(data == \"success\") {\n                            $(self).closest(\".widgetContents\").find(\".fileObjectId\").val(\"\");\n                            $(self).closest(\".widgetContents\").find(\".fileDescription\").val(\"\");\n                            $(self).closest(\".widgetContents\").find(\".extractedData\").val(\"\");\n                            $(self).closest(\".widgetContents\").find(\".deleteFile\").hide();\n                            $(self).closest(\".widgetContents\").find(\".fileLabel\").html(\"Deleted\");\n                            $(\".fileObjectId\").trigger(\"change\");\n                        }\n                        else if(data == \"notfound\") {\n                            $(self).closest(\".widgetContents\").find(\".fileObjectId\").val(\"\");\n                            $(self).closest(\".widgetContents\").find(\".fileDescription\").val(\"\");\n                            $(self).closest(\".widgetContents\").find(\".extractedData\").val(\"\");\n                            $(\".fileObjectId\").trigger(\"change\");\n\n                        }\n                        else {\n                            bootbox.dialog({message:\"Deletion Error: please reload and try again.\"});\n\n                        }\n\n                    });\n                }\n            },\n            cancel: {\n                label: \"Cancel\",\n                className: \"btn-default\"\n            }\n        }\n    });\n\n\n});\n\nfunction loadSidecars(fileIdElement) {\n    fileId = $(fileIdElement).val();\n\n    // already have sidecars, don't load another\n    if($(fileIdElement).closest('.widgetContents').find(\".sidecars\").html().length > 0) {\n        return;\n    }\n\n    var rootFormField = $(fileIdElement).closest('.widgetContents').find(\".rootFormField\").val() + \"[sidecars]\";\n\n    $.post(basePath + 'fileManager/getSidecarViewForObject/', {fileId: fileId, rootFormField: rootFormField}, function(data) {\n        $(fileIdElement).closest('.widgetContents').find(\".sidecars\").append(data);\n    });\n\n}\n\n\nvar fileObjectPreview = function(targetElement) {\n    var imageContainer = $(targetElement).closest(\".widgetContents\").find(\".imagePreview\");\n    if($(targetElement).val().length>0) {\n        $(\"#collectionId\").attr(\"disabled\", true);\n        $(targetElement).closest('.widgetContents').find(\".file\").attr(\"disabled\", true);\n        var self = targetElement;\n        loadSidecars(self);\n    }\n    else {\n        // we emptied the fileObject, let's clear things out.\n        $(targetElement).closest('.widgetContents').find(\".file\").removeAttr(\"disabled\");\n        $(\"#collectionId\").removeAttr(\"disabled\");\n        $(imageContainer).hide();\n    }\n};\n\nvar pollingForNewImage = false;\n\nvar checkForNewImages = function() {\n\tpollingForNewImage = true;\n\n\tcheckArray = new Array();\n\t$(\".imagePreview img\").each(function(index, el) {\n\n\t\tif($(el).data(\"fileready\") !== true) {\n\t\t\tvar fileObjectId = $(el).closest(\".widgetContents\").find(\".fileObjectId\").val();\n\t\t\tif(fileObjectId) {\n\t\t\t\tcheckArray.push(fileObjectId);\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\telse {\n\t\t\tcontainer = $(el).closest(\".widgetContents\").find(\".imagePreview\");\n\t\t\t$(container).show();\n\t\t}\n\n\t});\n\n\tif(checkArray.length > 0) {\n\t\t$.post(basePath + \"fileManager/previewImageAvailable/\", {checkArray: JSON.stringify(checkArray)}, function(data) {\n\n\t\t\tdecoded = JSON.parse(data);\n\t\t\tif(!decoded) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$(decoded).each(function(index, content) {\n\n\t\t\t\tcontainer = $('.fileObjectId').filter(function(index) {\n\t\t\t\t\treturn $(this).val() == content.fileId;\n\t\t\t\t}).closest(\".widgetContents\").find(\".imagePreview\");\n\n\t\t\t\tif (content.status == \"false\") {\n\t                // data.redirect contains the string URL to redirect to\n\t                $(container).find(\"img\").attr(\"src\", \"/assets/images/processing.gif\");\n\t                $(container).show();\n\t            }\n\t            else if(content.status == \"true\") {\n\t                $(container).find(\"img\").attr(\"src\", basePath + \"fileManager/previewImageByFileId/\" + content.fileId + \"?\" + Math.random());\n\t                $(container).find(\"img\").data(\"fileready\", true);\n\t                $.get(basePath+\"fileManager/extractedData/\"+content.fileId,function(data) {\n\t                    $(container).closest(\".widgetContents\").find(\".extractedData\").val(data);\n\t                });\n\n\t                $(container).show();\n\t            }\n\t            else if(content.status == \"icon\") {\n\t                // if it's an icon, we say true but keep polling\n\t                if(!$(container).find(\"img\").data(\"icon\")) {\n\t                \t$(container).find(\"img\").data(\"icon\", true);\n\t                \t$(container).find(\"img\").attr(\"src\", basePath + \"fileManager/previewImageByFileId/\" + content.fileId);\n\t                \t$(container).show();\t\n\t                }\n\t                \n\t            }\n\t\t\t});\n\t\t\tsetTimeout(checkForNewImages, 4000);\n\t\t});\n\t}\n\telse {\n\t\tpollingForNewImage = false;\n\t}\n\t\n\n\n\t\n}\n\n\n$(document).on(\"change\", \".fileObjectId\", function() {\n    fileObjectPreview(this);\n    if($(this).val() !== \"\") {\n        submitFormWithDelay(true);\n    }\n    // force a save when the fileobjectId changes\n\n});\n\n$(document).on(\"click\", \".processingLogs\", function(e) {\n     e.preventDefault();\n    var parentElement = $(this).closest(\".widgetContents\");\n    var fileObjectId = $(parentElement).find(\".fileObjectId\").val();\n    var win = window.open(basePath + \"assetManager/processingLogsForAsset/\" + fileObjectId, '_blank');\n    if(win){\n        //Browser has allowed it to be opened\n        win.focus();\n    }\n\n});\n\n$(document).ready(function(){\n    $( \"#collectionId\" ).trigger( \"change\" );\n    $(\".file\").trigger(\"change\");\n    checkForNewImages();\n    $(\".fileObjectId\").each(function(index, el) {\n        // load previews for all our file objects\n        fileObjectPreview(el);\n\n        if($(el).val() !== \"\") {\n            $(el).closest(\".widgetContents\").find(\".deleteFile\").show();\n        }\n\n    });\n\n\n\n    if($(\".allowResume\").length > 0) {\n        $(\".allowResume\").each(function() {\n\n            $(this).closest(\".widgetContents\").find(\".file\").removeAttr(\"disabled\");\n            $(this).closest(\".widgetContents\").find(\".startbutton\").removeAttr(\"disabled\");\n\n        });\n    }\n\n});\n\n$(document).on(\"change\", \".file\", function() {\n    if($(this).val() !== \"\") {\n        $(this).closest(\".widgetContents\").find(\".cancelButton\").show();\n        startUpload(this);\n    }\n    else {\n        $(this).closest(\".widgetContents\").find(\".cancelButton\").hide();\n    }\n\n});\n\n$(document).on(\"click\", \".cancelButton\", function() {\n    var parentElement = $(this).closest(\".widgetContents\");\n    var fileElement = $(parentElement).find(\".file\");\n    var upload = $(fileElement).data(\"uploader\");\n    upload.cancel();\n    window.uploadCount--;\n    $.get(basePath+ 'assetManager/cancelSourceFile/' + $(parentElement).find(\".fileObjectId\").val() , function(data) {\n        $(parentElement).find(\".uploadProgress\").hide();\n    });\n    $(parentElement).find(\".cancelButton\").hide();\n    $(parentElement).find(\".fileObjectId\").val(\"\");\n    $(this).hide();\n    $(fileElement).removeAttr(\"disabled\");\n\n});\n\nfunction startUpload(targetFrame) {\n    // only get the first file for now\n    var collectionId = $(\"#collectionId\").val();\n    var parentElement = $(targetFrame).closest(\".widgetContentsContainer\");\n    var fileElement = $(parentElement).find(\".file\");\n\n    if(!$.isNumeric(collectionId)) {\n        //TODO\n        console.log(\"error\");\n    }\n\n    jQuery.ajaxSetup({async:false}); // run sync so we wait for the next element\n    if($(fileElement).prop(\"files\").length > 1) {\n        target = addAnother(targetFrame, $(fileElement).prop(\"files\").length - 1);    \n    }\n    \n    $(target).find(\".cancelButton\").show();\n\n    jQuery.ajaxSetup({async:true});\n    \n    var responseArray = [];\n    var sendingArray = [];\n    var target = null;\n    $.each($(fileElement).prop(\"files\"), function(index, el) {\n        if(index === 0) { //operate on the real one\n            target = parentElement;\n        }\n        else {\n            target = target.nextAll(\".panel\").eq(0);\n        }\n\n        var file = el;\n        var internalTarget = target;\n        fileObjectId = $(target).find(\".fileObjectId\").val();\n        sendingArray[index] = {index: index, collectionId: collectionId, filename: file.name, fileObjectId: fileObjectId, file:file};\n        responseArray[index] = {index: index, collectionId: collectionId, filename: file.name, fileObjectId: fileObjectId, target: internalTarget, file:file};\n    });\n\n    $.post(basePath+ 'assetManager/getFileContainer', {containers: JSON.stringify(sendingArray)}, function(data, textStatus, xhr) {\n        uploadSettings = $.parseJSON(data);\n\n        $(uploadSettings).each(function(index, item) {\n            var sourceArray = responseArray[item.index];\n            $(fileElement).data('uploader', uploadFile(sourceArray.file, item, sourceArray.target));\n        });\n    \n    });\n\n   \n    return;\n\n\n\n\n}\n"],"names":["format_size","num_bytes","parseInt","uploadCount","uploadFile","fileElement","uploadSettings","containerElement","last_update","fileObjectId","localContainer","$","find","val","trigger","chunkSize","settings","pollingForNewImage","checkForNewImages","fastUpload","key","path","split","reverse","join","access_key","bucketKey","ajax_base","basePath","bucket","collectionId","num_workers","chunk_size","content_type","type","max_size","on_error","console","log","prepend","on_select","fileObj","on_start","window","hide","on_progress","bytesUploaded","bytesTotal","Date","percent","width","on_init","on_complete","get","data","show","on_chunk_uploaded","upload","mule_upload","attr","upload_file","resetCollection","loadSidecars","fileIdElement","rootFormField","fileId","closest","html","length","post","append","document","on","this","self","bootbox","dialog","message","title","backdrop","buttons","success","label","className","callback","textStatus","xhr","cancel","fileObjectPreview","targetElement","imageContainer","removeAttr","checkArray","Array","each","index","el","push","container","JSON","stringify","decoded","parse","content","filter","status","Math","random","setTimeout","startUpload","targetFrame","parentElement","responseArray","isNumeric","jQuery","ajaxSetup","async","prop","target","addAnother","sendingArray","internalTarget","nextAll","eq","filename","file","name","containers","parseJSON","item","sourceArray","submitFormWithDelay","e","preventDefault","win","open","focus","ready"],"mappings":"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"}