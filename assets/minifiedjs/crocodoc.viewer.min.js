(j=>{var e;j.Crocodoc=(e=function(w){var e="crocodoc-",f=e+"viewer",H=e+"doc",I=e+"viewport",m=e+"draggable",v=e+"dragging",a=e+"text-selected",l=e+"text-disabled",c=e+"links-disabled",i=e+"current-page",r=e+"preceding-page",n=e+"page",k=n+"-svg",g=n+"-text",u=n+"-link",V=n+"-links",h=n+"-loading",p=n+"-error",s=n+"-visible",D=n+"-autoscale",d=n+"-prev",y=n+"-next",b=n+"-before",P=n+"-after",T=n+"-before-buffer",x=n+"-after-buffer",S=[y,P,d,b,T,x].join(" "),C="fitwidth",L="fitheight",e="auto",t="vertical",W="vertical-single-column",N="horizontal",o="presentation",F="presentation-two-page",O="text",R="converting",E="not loaded",Z="loaded";var U="image/svg+xml",$="<style>html,body{width:100%;height:100%;margin:0;overflow:hidden;}</style>",q='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"><script><![CDATA[('+function(){j.loadSVG=function(e){e=(new j.DOMParser).parseFromString(e,"image/svg+xml"),e=document.importNode(e.documentElement,!0);e.setAttribute("width","100%"),e.setAttribute("height","100%"),(document.body||document.documentElement).appendChild(e)}}+")()]]><\/script></svg>";if(void 0===w)throw new Error("jQuery is required");var z,M,X,A,_={ZOOM_FIT_WIDTH:C,ZOOM_FIT_HEIGHT:L,ZOOM_AUTO:e,ZOOM_IN:"in",ZOOM_OUT:"out",SCROLL_PREVIOUS:"previous",SCROLL_NEXT:"next",LAYOUT_VERTICAL:t,LAYOUT_VERTICAL_SINGLE_COLUMN:W,LAYOUT_HORIZONTAL:N,LAYOUT_PRESENTATION:o,LAYOUT_PRESENTATION_TWO_PAGE:F,LAYOUT_TEXT:O,ASSET_REQUEST_RETRIES:1,viewerTemplate:'<div tabindex="-1" class="crocodoc-viewport"><div class="crocodoc-doc"></div></div><div class="crocodoc-viewer-logo"></div>',pageTemplate:'<div class="crocodoc-page crocodoc-page-loading" style="width:{{w}}px; height:{{h}}px;" data-width="{{w}}" data-height="{{h}}"><div class="crocodoc-page-inner"><div class="crocodoc-page-content"><div class="crocodoc-page-svg"></div><div class="crocodoc-page-autoscale"><div class="crocodoc-page-text"></div><div class="crocodoc-page-links"></div></div></div></div></div>',components:z={},utilities:M={},createViewer:function(e,t){return new _.Viewer(e,t)},getViewer:function(e){return _.Viewer.get(e)},addComponent:function(e,t,a){t instanceof Function&&(a=t,t=[]),function e(t,a,n){var o;for(n=n||t,o=0;o<a.length;++o){if(t===a[o])throw new Error("Circular dependency detected: "+n+"->"+a[o]);z[a[o]]&&e(t,z[a[o]].mixins,n+"->"+a[o])}}(e,t),z[e]={mixins:t,creator:a}},createComponent:function(e,t){var a=z[e];if(a){for(var n=[],o=0;o<a.mixins.length;++o)n.push(this.createComponent(a.mixins[o],t));return n.unshift(t),a.creator.apply(a.creator,n)}return null},addPlugin:function(e,t){this.addComponent("plugin-"+e,t)},addDataProvider:function(e,t){this.addComponent("data-provider-"+e,t)},addUtility:function(e,t){M[e]={creator:t,instance:null}},getUtility:function(e){e=M[e];return e?(e.instance||(e.instance=e.creator(this)),e.instance):null}};return _.Scope=function(n){var r=_.getUtility("common"),s=[],a=[],o={},i=!1;function l(e,t){for(var a,n,o=0,i=s.length;o<i;++o)(a=s[o])&&(n=a.messages||[],-1!==r.inArray(e,n))&&r.isFn(a.onmessage)&&a.onmessage.call(a,e,t)}function c(e){r.isFn(e.destroy)&&!e._destroyed&&(e.destroy(),e._destroyed=!0)}n.dataProviders=n.dataProviders||{},this.createComponent=function(e){var t=_.createComponent(e,this);return t&&(t.componentName=e,s.push(t)),t},this.destroyComponent=function(e){for(var t=0,a=s.length;t<a;++t)if(e===s[t]){c(e),s.splice(t,1);break}},this.destroy=function(){for(var e=s.slice(),t=0,a=e.length;t<a;++t)c(e[t]);s=[],o={}},this.broadcast=function(e,t){i?l(e,t):a.push({name:e,data:t})},this.getUtility=function(e){return _.getUtility(e)},this.getConfig=function(){return n},this.ready=function(){if(!i){i=!0;for(var e;a.length;)l((e=a.shift()).name,e.data);a=null}},this.get=function(e,t){var a=n.dataProviders[e]||e,a=this.getDataProvider(a);return a?a.get(e,t):w.Deferred().reject("data-provider not found").promise()},this.getDataProvider=function(e){var t;return o[e]?t=o[e]:(t=this.createComponent("data-provider-"+e),o[e]=t),t}},_.EventTarget=function(){this._handlers={}},_.EventTarget.prototype={constructor:_.EventTarget,on:function(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]),this._handlers[e].push(t)},fire:function(e,t){o=!1;var a,n,o,i={type:e,data:t,preventDefault:function(){o=!0},isDefaultPrevented:function(){return o}},r=this._handlers[i.type];if(r instanceof Array)for(a=0,n=(r=r.concat()).length;a<n;a++)r[a]&&r[a].call(this,i);if((r=this._handlers.all)instanceof Array)for(a=0,n=(r=r.concat()).length;a<n;a++)r[a]&&r[a].call(this,i);return i},off:function(e,t){var a,n,o=this._handlers[e];if(o instanceof Array)if(t){for(a=0,n=o.length;a<n;a++)if(o[a]===t||o[a].handler===t){o.splice(a,1);break}}else o.length=0},one:function(t,a){function n(e){o.off(t,n),a.call(o,e)}var o=this;n.handler=a,this.on(t,n)}},X=0,A={},_.Viewer=function(e,t){_.EventTarget.call(this);var a,n=_.getUtility("common"),o=w(e),i=n.extend(!0,{},_.Viewer.defaults,t),r=new _.Scope(i),s=r.createComponent("viewer-base");if(0===o.length)throw new Error("Invalid container element");this.id=i.id=++X,i.api=this,i.$el=o,(A[this.id]=this).destroy=function(){delete A[i.id],r.broadcast("destroy"),r.destroy()},this.load=function(){s.loadAssets()},this.setLayout=function(e){a=null,a=s.setLayout(e)},this.zoom=function(e){var t=parseFloat(e);a&&(t&&(e=t/(i.pageScale||1)),a.setZoom(e))},this.scrollTo=function(e){a&&n.isFn(a.scrollTo)&&a.scrollTo(e)},this.scrollBy=function(e,t){a&&a.scrollBy(e,t)},this.focus=function(){a&&a.focus()},this.enableTextSelection=function(){o.toggleClass(l,!1),i.enableTextSelection||(i.enableTextSelection=!0,r.broadcast("textenabledchange",{enabled:!0}))},this.disableTextSelection=function(){o.toggleClass(l,!0),i.enableTextSelection&&(i.enableTextSelection=!1,r.broadcast("textenabledchange",{enabled:!1}))},this.enableLinks=function(){i.enableLinks||(o.removeClass(c),i.enableLinks=!0)},this.disableLinks=function(){i.enableLinks&&(o.addClass(c),i.enableLinks=!1)},this.updateLayout=function(){a&&a.update()},s.init()},_.Viewer.prototype=new _.EventTarget,_.Viewer.prototype.constructor=_.Viewer,_.Viewer.get=function(e){return A[e]},_.Viewer.defaults={url:null,layout:t,zoom:e,page:1,enableTextSelection:!0,enableLinks:!0,enableDragging:!1,queryParams:null,plugins:{},useWindowAsViewport:!1,conversionIsComplete:!0,template:{svg:"page-{{page}}.svg",img:"page-{{page}}.png",html:"text-{{page}}.html",css:"stylesheet.css",json:"info.json"},dataProviders:{metadata:"metadata",stylesheet:"stylesheet","page-svg":"page-svg","page-text":"page-text","page-img":"page-img"},pageStart:null,pageEnd:null,autoloadFirstPage:!0,zoomLevels:[.25,.5,.75,1,1.25,1.5,2,3]},_.addDataProvider("metadata",function(e){var t=e.getUtility("ajax"),a=e.getUtility("common"),n=e.getConfig();function o(e){return a.parseJSON(e)}return{get:function(){var e=this.getURL(),e=t.fetch(e,_.ASSET_REQUEST_RETRIES);return e.then(o).promise({abort:e.abort})},getURL:function(){var e=n.template.json;return n.url+e+n.queryString}}}),_.addDataProvider("page-img",function(e){var t=e.getUtility("common"),a=e.getConfig();return{get:function(e,t){var a=this.getImage(),n=_.ASSET_REQUEST_RETRIES,o=!1,i=this.getURL(t),r=w.Deferred();function s(){a.setAttribute("src",i)}function l(){a.removeAttribute("src")}return a.onload=function(){o=!0,r.resolve(a)},a.onerror=function(){0<n?(n--,l(),s()):(a=null,o=!1,r.reject({error:"image failed to load",resource:i}))},s(),r.promise({abort:function(){o||(l(),r.reject())}})},getURL:function(e){e=t.template(a.template.img,{page:e});return a.url+e+a.queryString},getImage:function(){return new Image}}}),_.addDataProvider("page-svg",function(t){var o=t.getUtility("common"),i=t.getUtility("ajax"),r=t.getUtility("browser"),s=t.getUtility("subpx"),l=t.getConfig(),c=!1,u={},d=/<xhtml:link[^>]*>(\s*<\/xhtml:link>)?/i;function g(a){var n,e;if(!c)return n=l.queryString.replace("&","&#38;"),e=o.countInStr(a,'xlink:href="data:image'),a=(a=1e3<e?a.replace(/<image[\s\w-_="]*xlink:href="data:image\/[^"]{0,5120}"[^>]*>/gi,""):a).replace(/href="([^"#:]*)"/g,function(e,t){return'href="'+l.url+t+n+'"'}),t.get("stylesheet").then(function(e){return t=a,e="<style>"+(e=e)+"</style>",r.firefox&&!s.isSubpxSupported()&&(e+="<style>text { text-rendering: geometricPrecision; }</style>"),t=t.replace(d,e);var t})}return{get:function(e,t){var a,n=this.getURL(t);return u[t]||(a=i.fetch(n,_.ASSET_REQUEST_RETRIES),u[t]=a.then(g).promise({abort:function(){a.abort(),u&&delete u[t]}})),u[t]},getURL:function(e){e=o.template(l.template.svg,{page:e});return l.url+e+l.queryString},destroy:function(){c=!0,o=i=s=r=l=u=null}}}),_.addDataProvider("page-text",function(e){var t=e.getUtility("common"),o=e.getUtility("ajax"),a=e.getConfig(),n=!1,i={};function r(e){if(!n)return 256<t.countInStr(e,"<div")?"":e.replace(/<link rel="stylesheet".*/,"")}return{get:function(e,t){var a,n=this.getURL(t);return i[t]||(a=o.fetch(n,_.ASSET_REQUEST_RETRIES),i[t]=a.then(r).promise({abort:function(){a.abort(),i&&delete i[t]}})),i[t]},getURL:function(e){e=t.template(a.template.html,{page:e});return a.url+e+a.queryString},destroy:function(){n=!0,t=o=a=i=null}}}),_.addDataProvider("stylesheet",function(e){var t,a=e.getUtility("ajax"),n=e.getUtility("browser"),o=e.getConfig();function i(e){return e=n.ie?e.replace(/font-family:[\s\"\']*([\w-]+)\b/g,"$0-"+o.id):e}return{get:function(){var e;return t||(e=a.fetch(this.getURL(),_.ASSET_REQUEST_RETRIES),t=e.then(i).promise({abort:function(){e.abort(),t=null}})),t},getURL:function(){var e=o.template.css;return o.url+e+o.queryString},destroy:function(){a=n=o=null,t=null}}}),_.addUtility("ajax",function(e){var u=e.getUtility("common"),d=e.getUtility("support"),g=e.getUtility("url");function h(e){var t,a,n;try{t=e.status,a=e.statusText,n=e.responseText}catch(e){t=0,a="",n=null}return{status:t,statusText:a,responseText:n,rawRequest:e}}function p(a,e,t,n,o,i){for(var r=d.getXHR(),s=(r.open(e,a,!0),r.onreadystatechange=function(){var e,t;if(4===r.readyState){r.onreadystatechange=function(){};try{e=r.status}catch(e){return void i(r)}0===e&&"file:"===g.parse(a).protocol&&(e=200),(200<=(t=e)&&t<300||304===t?o:i)(r)}},r),l=n,c=0;c<l.length;++c)s.setRequestHeader(l[c][0],l[c][1]);return r.send(t),r}return{request:function(e,t){t=t,(t=u.extend(!0,{},t||{})).method=t.method||"GET",t.headers=t.headers||[],t.data=t.data||"","string"!=typeof t.data&&(t.data=w.param(t.data),"GET"!==t.method)&&(t.data=t.data,t.headers.push(["Content-Type","application/x-www-form-urlencoded"]));var a=t,t=a.method,n=a.data,o=a.headers;function i(e){return u.isFn(a.success)&&a.success.call(h(e)),e}function r(e){return u.isFn(a.fail)&&a.fail.call(h(e)),e}if("GET"===t&&n&&(e=g.appendQueryParams(e,n),n=""),!d.isXHRSupported())return a.fail({status:0,statusText:"AJAX not supported"});if(!g.isCrossDomain(e)||d.isCORSSupported())return p(e,t,n,o,i,r);var o=e,e=t,t=n,s=i,l=r,c=d.getXDR();try{c.open(e,o),c.onload=function(){s(c)},c.onerror=function(){l(c)},c.ontimeout=function(){l(c)},c.onprogress=function(){},c.send(t)}catch(e){return l({status:0,statusText:e.message})}return c},fetch:function(e,t){var a,n=!1,o=this,i=w.Deferred();function r(e){0<t?(t--,a=s()):i.reject(e)}function s(){return o.request(e,{success:function(){n||(this.responseText?i.resolve(this.responseText):r({error:"empty response",status:this.status,resource:e}))},fail:function(){n||r({error:this.statusText,status:this.status,resource:e})}})}return a=s(),i.promise({abort:function(){n=!0,a.abort()}})}}}),_.addUtility("browser",function(){var e,t=navigator.userAgent,a={},n=/ip(hone|od|ad)/i.test(t),o=/android/i.test(t),i=/blackberry/i.test(t),r=/webos/i.test(t),s=/silk|kindle/i.test(t);return/MSIE|Trident/i.test(t)&&(a.ie=!0,e=(/MSIE/i.test(t)?/MSIE\s+(\d+\.\d+)/i:/Trident.*rv[ :](\d+\.\d+)/).exec(t),a.version=e&&parseFloat(e[1]),a.ielt9=a.version<9,a.ielt10=a.version<10,a.ielt11=a.version<11),n&&(a.ios=!0,e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),a.version=e&&parseFloat(e[1]+"."+e[2])),a.mobile=/mobile/i.test(t)||n||o||i||r||s,a.firefox=/firefox/i.test(t),/safari/i.test(t)&&(a.chrome=/chrome/i.test(t),a.safari=!a.chrome),a.safari&&(e=navigator.appVersion.match(/Version\/(\d+(\.\d+)?)/),a.version=e&&parseFloat(e[1])),a}),_.addUtility("common",function(){var u={};return u.extend=w.extend,u.each=w.each,u.map=w.map,u.param=w.param,u.parseJSON=w.parseJSON,u.stringifyJSON=void 0!==j.JSON?j.JSON.stringify:function(){throw new Error("JSON.stringify not supported")},w.extend(u,{bisectLeft:function(e,t,a){for(var n,o=0,i=e.length;o<i;)n=Math.floor((o+i)/2),(a?e[n][a]:e[n])<t?o=n+1:i=n;return o},bisectRight:function(e,t,a){for(var n,o=0,i=e.length;o<i;)n=Math.floor((o+i)/2),t<(a?e[n][a]:e[n])?i=n:o=n+1;return o},clamp:function(e,t,a){return e<t?t:a<e?a:e},sign:function(e){e=parseInt(e,10);return e&&(e<0?-1:1)},isFn:function(e){return"function"==typeof e},inArray:function(e,t){return u.isFn(t.indexOf)?t.indexOf(e):w.inArray(e,t)},constrainRange:function(e,t,a){var n=t-e;return n<0?{min:-1,max:-1}:(e=u.clamp(e,0,a),{min:e=(t=u.clamp(e+n,0,a))-e<n?u.clamp(t-n,0,a):e,max:t})},now:function(){return(new Date).getTime()},throttle:function(a,n){var o,i,r,s,l=0;function c(){l=u.now(),r=null,s=n.apply(o,i)}return function(){var e=u.now(),t=a-(e-l);return o=this,i=arguments,t<=0?(clearTimeout(r),r=null,l=e,s=n.apply(o,i)):r=r||setTimeout(c,t),s}},debounce:function(t,a){var n,o,i,r,s;function l(){var e=u.now()-r;e<t?i=setTimeout(l,t-e):(i=null,s=a.apply(n,o),n=o=null)}return function(){return n=this,o=arguments,r=u.now(),i=i||setTimeout(l,t),s}},insertCSS:function(e){var t=document.createElement("style"),e=document.createTextNode(e);try{t.setAttribute("type","text/css"),t.appendChild(e)}catch(e){}return document.getElementsByTagName("head")[0].appendChild(t),t},appendCSSRule:function(e,t,a){return e.insertRule?e.insertRule(t+"{"+a+"}",e.cssRules.length):(t=e.addRule(t,a,e.rules.length))<0?e.rules.length-1:t},deleteCSSRule:function(e,t){e.deleteRule?e.deleteRule(t):e.removeRule(t)},getSelectedNode:function(){var e,t;return j.getSelection?(t=j.getSelection()).rangeCount&&!t.getRangeAt(0).collapsed&&(e=t.anchorNode.parentNode):document.selection&&(e=document.selection.createRange().parentElement()),e},getComputedStyle:function(e){return"getComputedStyle"in j?j.getComputedStyle(e):e.currentStyle},calculatePtSize:function(){var e,t=document.createElement("div");return t.style.display="block",t.style.position="absolute",t.style.width=1e4+"pt",document.body.appendChild(t),e=(e=u.getComputedStyle(t))&&e.width?parseFloat(e.width)/1e4:1.33333,document.body.removeChild(t),e},countInStr:function(e,t){for(var a,n=0;a=e.indexOf(t,a)+1;)n++;return n},template:function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e=e.replace(new RegExp("\\{\\{"+a+"\\}\\}","g"),t[a]));return e}})}),_.addUtility("subpx",function(e){var i='<span style="font:{{size}}px serif; color:transparent; white-space:nowrap;">'+new Array(100).join("A")+"</span>",r=e.getUtility("common");var a=(()=>{if(!w.support.leadingWhitespace)return!1;var e=w(r.template(i,{size:12.5})).appendTo(document.documentElement).get(0),t=w(e).css("font-size"),a=w(e).width(),n=(w(e).remove(),e=w(r.template(i,{size:12.6})).appendTo(document.documentElement).get(0),w(e).css("font-size")),o=w(e).width();if(w(e).remove(),!("ontouchstart"in j)){if(t===n)return!1;if(a===o)return!1}return!0})();return{fix:function(e){var t;return a||void 0!==document.body.style.zoom&&(t=w("<div>").addClass("crocodoc-subpx-fix"),w(e).wrap(t)),e},isSubpxSupported:function(){return a}}}),_.addUtility("support",function(){var i=["Moz","Webkit","O","ms"],e=null,t=null;function a(e){var t,a,n,o=document.createElement("div");if(e in o.style)return e;if(t=e.charAt(0).toUpperCase()+e.substr(1),e in o.style)return e;for(a=0;a<i.length;++a)if((n=i[a]+t)in o.style)return(n=0===n.indexOf("ms")?"-"+n:n).replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()});return!1}return{svg:document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),csstransform:a("transform"),csstransition:a("transition"),csszoom:a("zoom"),isXHRSupported:function(){return e=null===e?!!this.getXHR():e},isCORSSupported:function(){return t=null===t?this.isXHRSupported()&&"withCredentials"in this.getXHR():t},isXDRSupported:function(){return void 0!==j.XDomainRequest},getXHR:function(){if(j.XMLHttpRequest)return new j.XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){return null}},getXDR:function(){return this.isXDRSupported()?new j.XDomainRequest:null}}}),_.addUtility("url",function(e){var t,a=e.getUtility("browser");return{getCurrentURL:function(){return j.location.href},makeAbsolute:function(e){return this.parse(e).href},isCrossDomain:function(e){e=this.parse(e);return t=t||this.parse(this.getCurrentURL()),!!e.hostname&&(e.protocol!==t.protocol||e.hostname!==t.hostname||e.port!==t.port)},appendQueryParams:function(e,t){return-1<e.indexOf("?")?e+"&"+t:e+"?"+t},parse:function(e){var t=document.createElement("a");return t.href=e,a.ie&&e!==t.href&&(e=t.href,t.href=e),/^\//.test(e=t.pathname)||(e="/"+e),{href:t.href,protocol:t.protocol,host:t.host,hostname:t.hostname,port:t.port,pathname:e,hash:t.hash,search:t.search}}}}),_.addComponent("controller-paged",function(u){var d,g,h=u.getUtility("common");function p(){for(var e,t,a=[],n=d.pageStart-1,o=d.pageEnd,i=(()=>{var e,t,a,n,o=d.pageStart,i=d.pageEnd,r=d.metadata.links||[],s=[];for(e=0,t=d.metadata.numpages;e<t;++e)s[e]=[];for(e=0,t=r.length;e<t;++e)if(!((a=r[e]).pagenum<o||a.pagenum>i)){if(a.destination){if((n=a.destination.pagenum)<o||i<n)continue;a.destination.pagenum=n-(o-1)}s[a.pagenum-1].push(a)}return s})(),r=n;r<o;r++)(e=u.createComponent("page")).init(d.$pages.eq(r-n),{index:r,status:(t=r,d.conversionIsComplete||0===t&&d.autoloadFirstPage?E:R),enableLinks:d.enableLinks,links:i[r],pageScale:d.pageScale}),a.push(e);d.pages=a}function f(){var e,t;e=h.getSelectedNode(),t=w(e).closest("."+n),g.find("."+a).removeClass(a),e&&g.has(e)&&t.addClass(a)}return{init:function(){var e;d=u.getConfig(),g=d.$el,w(document).on("mouseup",f),e=d.metadata,d.numPages=e.numpages,d.pageStart?d.pageStart<0&&(d.pageStart=e.numpages+d.pageStart):d.pageStart=1,d.pageStart=h.clamp(d.pageStart,1,e.numpages),d.pageEnd?d.pageEnd<0&&(d.pageEnd=e.numpages+d.pageEnd):d.pageEnd=e.numpages,d.pageEnd=h.clamp(d.pageEnd,d.pageStart,e.numpages),d.numPages=d.pageEnd-d.pageStart+1;var t,a,n,o,i,r,s=h.calculatePtSize(),l=d.metadata.dimensions,c="";for(d.pageScale=1024/(l.width*s),a=d.zoomLevels[d.zoomLevels.length-1],n=3/d.pageScale;a<n;)d.zoomLevels.push(a+=a/2);for(l.exceptions=l.exceptions||{},t=d.pageStart-1;t<d.pageEnd;t++)r=((r=t+1)in l.exceptions?(o=l.exceptions[r].width,l.exceptions[r]):(o=l.width,l)).height,i=o*s,r=r*s,i*=d.pageScale,r*=d.pageScale,c+=h.template(_.pageTemplate,{w:i,h:r});d.$pages=w(c).appendTo(d.$doc),p(),u.createComponent("lazy-loader").init(d.pages)},destroy:function(){w(document).off("mouseup",f)}}}),_.addComponent("controller-text",function(e){var t;return{init:function(){var a=e.getConfig();a.$textContainer=w(),t=e.get("page-text",1).then(function(e){var t=a.$doc.parent();a.$doc=w(e),t.html(a.$doc)})},destroy:function(){t.abort()}}}),_.addComponent("dragger",function(t){var a,n,o,i=w(j);function r(e){a.scrollTop(n.top-(e.clientY-o.y)),a.scrollLeft(n.left-(e.clientX-o.x)),e.preventDefault()}function s(e){t.broadcast("dragend"),i.off("mousemove",r),i.off("mouseup",s),e.preventDefault()}function l(e){t.broadcast("dragstart"),n={top:a.scrollTop(),left:a.scrollLeft()},o={x:e.clientX,y:e.clientY},i.on("mousemove",r),i.on("mouseup",s),e.preventDefault()}return{init:function(e){(a=w(e)).on("mousedown",l)},destroy:function(){a.off("mousedown",l),a.off("mousemove",r),i.off("mouseup",s)}}}),_.addComponent("layout-base",function(t){var a=t.getUtility("common");return{messages:["resize","scroll","scrollend"],onmessage:function(e,t){switch(e){case"resize":this.handleResize(t);break;case"scroll":this.handleScroll(t);break;case"scrollend":this.handleScrollEnd(t)}},init:function(){var e=t.getConfig();this.config=e,this.$el=e.$el,this.$doc=e.$doc,this.$viewport=e.$viewport,this.$pages=e.$pages,this.numPages=e.numPages,this.layoutClass="crocodoc-layout-"+e.layout,this.$el.addClass(this.layoutClass),this.initState()},initState:function(){var e=this.$viewport[0],t=e;e===j&&(t=document.documentElement),this.state={scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportDimensions:{clientWidth:t.clientWidth,clientHeight:t.clientHeight,offsetWidth:t.offsetWidth,offsetHeight:t.offsetHeight},zoomState:{zoom:1,prevZoom:0,zoomMode:null},initialWidth:0,initialHeight:0,totalWidth:0,totalHeight:0},this.zoomLevels=[]},destroy:function(){this.$doc.removeAttr("style"),this.$el.removeClass(this.layoutClass)},setZoom:function(){},calculateNextZoomLevel:function(e){var t,a=!1,n=this.state.zoomState.zoom,o=this.zoomLevels;if(e===_.ZOOM_IN){for(t=0;t<o.length;++t)if(o[t]>n){a=o[t];break}}else if(e===_.ZOOM_OUT)for(t=o.length-1;0<=t;--t)if(o[t]<n){a=o[t];break}return a},isDraggable:function(){var e=this.state;return e.viewportDimensions.clientHeight<e.totalHeight||e.viewportDimensions.clientWidth<e.totalWidth},scrollBy:function(e,t){e=parseInt(e,10)||0,t=parseInt(t,10)||0,this.scrollToOffset(e+this.state.scrollLeft,t+this.state.scrollTop)},scrollToOffset:function(e,t){this.$viewport.scrollLeft(e),this.$viewport.scrollTop(t)},handleScroll:function(e){this.state.scrollTop=e.scrollTop,this.state.scrollLeft=e.scrollLeft},handleResize:function(){},handleScrollEnd:function(){},update:function(){},focus:function(){this.$viewport.focus()},extend:function(e){return a.extend({},this,e)}}}),_.addComponent("layout-"+N,["layout-paged"],function(e,t){var n=e.getUtility("common"),o=e.getUtility("browser");return t.extend({calculateZoomAutoValue:function(){var e=this.state,t=this.calculateZoomValue(C),a=this.calculateZoomValue(L);return e.widestPage.actualWidth>e.tallestPage.actualHeight?Math.min(t,a):o.mobile?a:Math.min(1,a)},calculateCurrentPage:function(){var e=this.state,t=e.pages,a=n.bisectRight(t,e.scrollLeft,"x0")-1;return 1+(n.bisectRight(t,e.scrollLeft+t[a].width/2,"x0")-1)},calculateNextPage:function(){return this.state.currentPage+1},calculatePreviousPage:function(){return this.state.currentPage-1},handleResize:function(e){t.handleResize.call(this,e),this.updateCurrentPage()},handleScroll:function(e){t.handleScroll.call(this,e),this.updateCurrentPage()},updateLayout:function(){var e=this.state,t=e.zoomState.zoom,a=e.sumWidths,t=Math.floor(e.tallestPage.totalActualHeight*t),a=Math.max(a,e.viewportDimensions.clientWidth),t=Math.max(t,e.viewportDimensions.clientHeight);this.$doc.css({height:t,lineHeight:t+"px",width:a})}})}),_.addComponent("layout-paged",["layout-base"],function(r,e){var f=r.getUtility("common"),d=r.getUtility("support");return e.extend({init:function(){e.init.call(this),this.updatePageStates(),this.updateZoomLevels()},initState:function(){e.initState.call(this),f.extend(this.state,{pages:[],widestPage:{index:0,actualWidth:0},tallestPage:{index:0,actualHeight:0},sumWidths:0,sumHeights:0,rows:[],currentPage:null,visiblePages:[],fullyVisiblePages:[]})},destroy:function(){e.destroy.call(this),this.$pages.css("padding","")},update:function(){this.updatePageStates(!0),this.setZoom()},setZoom:function(e){var t=this.state,a=this.parseZoomValue(e),n=t.zoomState,o=n.zoom,i=this.calculateZoomMode(e,a),a=f.clamp(a,t.minZoom,t.maxZoom);r.broadcast("beforezoom",f.extend({page:t.currentPage,visiblePages:f.extend([],t.visiblePages),fullyVisiblePages:f.extend([],t.fullyVisiblePages)},n)),n.prevZoom=o,n.zoom=a,n.zoomMode=i,this.applyZoom(a),n.canZoomIn=!1!==this.calculateNextZoomLevel(_.ZOOM_IN),n.canZoomOut=!1!==this.calculateNextZoomLevel(_.ZOOM_OUT),this.updatePageStates(),this.updateLayout(),o=e===_.ZOOM_AUTO||e===_.ZOOM_FIT_WIDTH||e===_.ZOOM_FIT_HEIGHT,this.updateScrollPosition(o),this.updatePageStates(),this.updateVisiblePages(!0),r.broadcast("zoom",f.extend({page:t.currentPage,visiblePages:f.extend([],t.visiblePages),fullyVisiblePages:f.extend([],t.fullyVisiblePages),isDraggable:this.isDraggable()},n))},parseZoomValue:function(e){var t=parseFloat(e),a=this.state.zoomState,n=a.zoom,o=n;if(t)o=t;else switch(e){case _.ZOOM_FIT_WIDTH:case _.ZOOM_FIT_HEIGHT:case _.ZOOM_AUTO:o=this.calculateZoomValue(e);break;case _.ZOOM_IN:case _.ZOOM_OUT:o=this.calculateNextZoomLevel(e)||n;break;default:o=n?a.zoomMode?this.calculateZoomValue(a.zoomMode):n:this.calculateZoomValue(this.config.zoom||_.ZOOM_AUTO)}return o},calculateZoomMode:function(e,t){switch(t){case this.calculateZoomValue(_.ZOOM_AUTO):return"string"!=typeof e||e!==_.ZOOM_FIT_WIDTH&&e!==_.ZOOM_FIT_HEIGHT?_.ZOOM_AUTO:e;case this.calculateZoomValue(_.ZOOM_FIT_WIDTH):return _.ZOOM_FIT_WIDTH;case this.calculateZoomValue(_.ZOOM_FIT_HEIGHT):return _.ZOOM_FIT_HEIGHT;default:return null}},updateZoomLevels:function(){var e,t,a,n,o=this.config.zoomLevels.slice()||[1],i=this.calculateZoomValue(_.ZOOM_AUTO),r=this.calculateZoomValue(_.ZOOM_FIT_WIDTH),s=this.calculateZoomValue(_.ZOOM_FIT_HEIGHT),l=[r,s];for(this.state.minZoom=this.config.minZoom||o[0],this.state.maxZoom=this.config.maxZoom||o[o.length-1],i!==r&&i!==s&&l.push(i),(o=o.concat(l)).sort(function(e,t){return e-t}),this.zoomLevels=[],e=t=0;e<o.length;++e)a=o[e],n=void 0,n=t/a,a!==t&&(n<.95||-1<f.inArray(a,l)&&n<.99)&&(t=o[e],this.zoomLevels.push(t))},calculateZoomValue:function(e){var t=this.state,a=parseFloat(e);return a||(e===_.ZOOM_FIT_WIDTH?t.viewportDimensions.clientWidth/t.widestPage.totalActualWidth:e===_.ZOOM_FIT_HEIGHT?t.viewportDimensions.clientHeight/t.tallestPage.totalActualHeight:e===_.ZOOM_AUTO?this.calculateZoomAutoValue():t.zoomState.zoom)},applyZoom:function(e){var t,a,n,o=this,i=e,e=o.state,r="."+o.config.namespace+" ."+D,s=o.config.stylesheet,l=e.pages,c=i*o.config.pageScale,u=100/c,u=d.csstransform?d.csstransform+":scale("+c+");width:"+u+"%;height:"+u+"%;":d.csszoom?"zoom:"+c:"";for(e.previousStyleIndex&&f.deleteCSSRule(s,e.previousStyleIndex),e.previousStyleIndex=f.appendCSSRule(s,r,u),t=0,a=l.length;t<a;++t)n=l[t],o.$pages.eq(t).css({width:n.actualWidth*i,height:n.actualHeight*i,paddingTop:n.paddingTop*i,paddingRight:n.paddingRight*i,paddingBottom:n.paddingBottom*i,paddingLeft:n.paddingLeft*i})},scrollTo:function(e){var t=this.state,a=parseInt(e,10);if("string"==typeof e){if(e===_.SCROLL_PREVIOUS&&1<t.currentPage)a=this.calculatePreviousPage();else if(e===_.SCROLL_NEXT&&t.currentPage<this.numPages)a=this.calculateNextPage();else if(!a)return}else if(!a&&0!==a)return;a=f.clamp(a,1,this.numPages),this.scrollToPage(a)},scrollToPage:function(e){e=this.calculateScrollPositionForPage(e);this.scrollToOffset(e.left,e.top)},calculateCurrentPage:function(){return this.state.currentPage},calculateScrollPositionForPage:function(e){e=f.clamp(e-1,0,this.numPages-1),e=this.state.pages[e];return{top:e.y0,left:e.x0}},calculateVisibleRange:function(){var e,t=this.state,a=t.pages,n=t.viewportDimensions.clientHeight,o=t.viewportDimensions.clientWidth;return 0===o||0===n?{min:-1,max:-1}:(n=(e=t.scrollTop)+n,o=(t=t.scrollLeft)+o,e=f.bisectLeft(a,e,"y1"),n=f.bisectRight(a,n,"y0")-1,t=f.bisectLeft(a,t,"x1"),a=f.bisectRight(a,o,"x0")-1,o=Math.max(t,e),t=Math.min(a,n),f.constrainRange(o,t,this.numPages-1))},calculateFullyVisibleRange:function(){var e,t=this.state,a=t.pages,n=t.viewportDimensions.clientHeight,o=t.viewportDimensions.clientWidth;return 0===o||0===n?{min:-1,max:-1}:(n=(e=t.scrollTop)+n,o=(t=t.scrollLeft)+o,e=f.bisectLeft(a,e,"y0"),n=f.bisectRight(a,n,"y1")-1,t=f.bisectLeft(a,t,"x0"),a=f.bisectRight(a,o,"x1")-1,o=Math.max(t,e),t=Math.min(a,n),f.constrainRange(o,t,this.numPages-1))},setCurrentPage:function(e){var t=this.state;t.currentPage!==e?(t.currentPage=e,this.updateVisiblePages(),r.broadcast("pagefocus",{page:t.currentPage,numPages:this.numPages,visiblePages:f.extend([],t.visiblePages),fullyVisiblePages:f.extend([],t.fullyVisiblePages)})):this.updateVisiblePages()},updateVisiblePages:function(e){var t,a,n,o=this.state,i=this.calculateVisibleRange(),r=this.calculateFullyVisibleRange();for(o.visiblePages.length=0,t=o.fullyVisiblePages.length=0,a=this.$pages.length;t<a;++t)n=this.$pages.eq(t),t<i.min||t>i.max?e&&n.hasClass(s)&&n.removeClass(s):(e&&!n.hasClass(s)&&n.addClass(s),o.visiblePages.push(t+1)),t>=r.min&&t<=r.max&&o.fullyVisiblePages.push(t+1)},updatePageStates:function(e){var t,a,n,o,i,r=this.state,s=r.pages,l=r.rows,c=this.$viewport.scrollTop(),u=this.$viewport.scrollLeft(),d=0,g=0,h=0,p=0;for(l.length=r.sumWidths=r.sumHeights=r.totalWidth=r.totalHeight=0,t=r.widestPage.totalActualWidth=r.tallestPage.totalActualHeight=0,a=this.$pages.length;t<a;++t)o=(i=this.$pages.eq(t))[0],(n=s[t])&&!e||(i.css("padding",""),n={index:t,paddingLeft:parseFloat(i.css("padding-left")),paddingRight:parseFloat(i.css("padding-right")),paddingTop:parseFloat(i.css("padding-top")),paddingBottom:parseFloat(i.css("padding-bottom"))}),n.actualWidth||(n.actualWidth=parseFloat(o.getAttribute("data-width"))),n.actualHeight||(n.actualHeight=parseFloat(o.getAttribute("data-height"))),n.totalActualWidth=n.actualWidth+n.paddingLeft+n.paddingRight,n.totalActualHeight=n.actualHeight+n.paddingTop+n.paddingBottom,n.width=o.offsetWidth,n.height=o.offsetHeight,n.x0=o.offsetLeft,n.y0=o.offsetTop,n.x1=n.width+n.x0,n.y1=n.height+n.y0,g&&((t,e)=>e&&0!==e.length?(e=f.map(e,function(e){return t[e].y1}),Math.max.apply(Math,e)):1/0)(s,l[d])<=n.y0+2&&d++,g=n.y1,l[d]||(l[d]=[]),n.totalActualWidth>r.widestPage.totalActualWidth&&(r.widestPage=n),n.totalActualHeight>r.tallestPage.totalActualHeight&&(r.tallestPage=n),r.sumWidths+=n.width,r.sumHeights+=n.height,n.rowIndex=d,s[t]=n,l[d].push(t),s[h].x0+s[h].width<n.x0+n.width&&(h=t),s[p].y0+s[p].height<n.y0+n.height&&(p=t);r.totalWidth=s[h].x0+s[h].width,r.totalHeight=s[p].y0+s[p].height,r.scrollTop=c,r.scrollLeft=u,this.setCurrentPage(this.calculateCurrentPage())},updateCurrentPage:function(){var e=this.calculateCurrentPage();this.setCurrentPage(e)},handleResize:function(e){var t=this.state.zoomState.zoomMode;this.state.viewportDimensions=e,this.updateZoomLevels(),this.setZoom(t)},handleScrollEnd:function(e){this.$doc.find("."+i).removeClass(i),this.$pages.eq(this.state.currentPage-1).addClass(i),this.updateVisiblePages(!0),this.handleScroll(e)},updateScrollPosition:function(e){var t=this.state,a=t.zoomState,a=a.zoom/a.prevZoom,n=t.scrollLeft*a,o=t.scrollTop*a;!0!==e&&(o+=t.viewportDimensions.offsetHeight*(a-1)/2,n+=t.viewportDimensions.offsetWidth*(a-1)/2),this.scrollToOffset(n,o)},updateLayout:function(){},calculateZoomAutoValue:function(){return 1},calculateNextPage:function(){return 1},calculatePreviousPage:function(){return 1}})}),_.addComponent("layout-"+F,["layout-"+o],function(e,a){var t=e.getUtility("common");return a.extend({init:function(){this.twoPageMode=!0,a.init.call(this)},calculateNextPage:function(){return this.state.currentPage+2},calculatePreviousPage:function(){return this.state.currentPage-2},calculateZoomValue:function(e){var t=a.calculateZoomValue.call(this,e);return e===C&&(t/=2),t},scrollToPage:function(e){a.scrollToPage.call(this,e-(e+1)%2)},calculateVisibleRange:function(){var e=this.state.currentPage-1;return t.constrainRange(e,1+e,this.numPages)},calculateFullyVisibleRange:function(){return this.calculateVisibleRange()}})}),_.addComponent("layout-"+o,["layout-paged"],function(e,n){var o=e.getUtility("common");return n.extend({init:function(){n.init.call(this),this.updatePageMargins(),this.updatePageClasses()},destroy:function(){n.destroy.call(this),this.$pages.css({margin:"",left:""}).removeClass(S)},calculateZoomAutoValue:function(){var e=this.calculateZoomValue(C),t=this.calculateZoomValue(L);return Math.min(e,t)},calculateCurrentPage:function(){return this.state.currentPage},calculateNextPage:function(){return this.state.currentPage+1},calculatePreviousPage:function(){return this.state.currentPage-1},calculateVisibleRange:function(){var e=this.state.currentPage-1;return o.constrainRange(e,e,this.numPages)},calculateFullyVisibleRange:function(){return this.calculateVisibleRange()},setCurrentPage:function(e){var t,a=o.clamp(e-1,0,this.numPages);n.setCurrentPage.call(this,e),this.$doc.find("."+r).removeClass(r),e=this.$doc.find("."+i),t=this.$pages.eq(a),e[0]!==t[0]&&(e.addClass(r).removeClass(i),t.addClass(i)),this.updateVisiblePages(!0),this.updatePageClasses(a)},scrollToPage:function(e){this.setCurrentPage(e)},updateLayout:function(){var e=this.state,t=e.zoomState.zoom,a=this.currentPage||1,n=e.pages[a-1],a=this.twoPageMode?e.pages[a]:n,o=e.viewportDimensions.clientWidth,e=e.viewportDimensions.clientHeight,i=a.actualWidth,i=n.actualWidth+(this.twoPageMode?i:0),i=Math.floor((i+n.paddingLeft+a.paddingRight)*t),a=Math.floor(n.totalActualHeight*t),n=Math.max(i,o),t=Math.max(a,e);this.$doc.css({width:n,height:t}),this.updatePageMargins(),o<n||e<t?this.$el.addClass("crocodoc-scrollable"):this.$el.removeClass("crocodoc-scrollable")},updatePageMargins:function(){for(var e,t,a,n,o=this.state,i=o.viewportDimensions.clientWidth,r=o.viewportDimensions.clientHeight,s=0,l=this.$pages.length;s<l;++s)e=this.$pages.eq(s),t=o.pages[s],n=this.twoPageMode?s%2==1?t.paddingRight:t.paddingLeft:t.paddingRight+t.paddingLeft,n=(t.actualWidth+n)*o.zoomState.zoom,t=(t.actualHeight+t.paddingTop+t.paddingBottom)*o.zoomState.zoom,this.twoPageMode?(a=Math.max(0,(i-2*n)/2),s%2==1&&(a+=n)):a=(i-n)/2,n=(r-t)/2,a=Math.max(a,0),n=Math.max(n,0),e.css({marginLeft:a,marginTop:n})},updatePageClasses:function(){var e=this.$pages,t=this.state.currentPage-1,a=1+t,n=t-1;e.removeClass(S),this.twoPageMode?(a=2+t,n=t-2,e.slice(Math.max(n,0),t).addClass(d),e.slice(a,a+2).addClass(y)):(0<=n&&e.eq(n).addClass(d),a<this.numPages&&e.eq(a).addClass(y)),e.slice(0,t).addClass(b),e.slice(Math.max(0,t-20),t).addClass(T),e.slice(a).addClass(P),e.slice(a,Math.min(this.numPages,a+20)).addClass(x)}})}),_.addComponent("layout-"+O,["layout-base"],function(o,e){var i=o.getUtility("common");return e.extend({init:function(){e.init.call(this),this.zoomLevels=this.config.zoomLevels.slice(),this.minZoom=this.zoomLevels[0],this.maxZoom=this.zoomLevels[this.zoomLevels.length-1]},setZoom:function(e){var t=this.state.zoomState,a=t.zoom,n="string"==typeof e?(n=this.calculateNextZoomLevel(e))||("auto"===e||"fitwidth"===e||"fitheight"===e?1:a):parseFloat(e)||a;n=i.clamp(n,this.minZoom,this.maxZoom),this.config.$doc.css("font-size",10*n+"pt"),t.prevZoom=a,t.zoom=n,t.canZoomIn=!1!==this.calculateNextZoomLevel(_.ZOOM_IN),t.canZoomOut=!1!==this.calculateNextZoomLevel(_.ZOOM_OUT),o.broadcast("zoom",i.extend({isDraggable:this.isDraggable()},t))}})}),_.addComponent("layout-"+W,["layout-"+t],function(e,t){return t}),_.addComponent("layout-"+t,["layout-paged"],function(e,t){var n=e.getUtility("common"),o=e.getUtility("browser");return t.extend({calculateZoomAutoValue:function(){var e=this.state,t=this.calculateZoomValue(C),a=this.calculateZoomValue(L);return e.widestPage.actualWidth>e.tallestPage.actualHeight?Math.min(1,t,a):o.mobile?t:Math.min(1,t)},calculateCurrentPage:function(){var e=this.state,t=e.pages,a=n.bisectRight(t,e.scrollTop,"y0")-1;return a<0?1:(a=e.scrollTop+t[a].height/2,t=t[n.bisectRight(t,a,"y0")-1].rowIndex,1+e.rows[t][0])},calculateNextPage:function(){var e=this.state,t=e.pages[e.currentPage-1].rowIndex,t=e.rows[t+1];return t&&t[0]+1||e.currentPage},calculatePreviousPage:function(){var e=this.state,t=e.pages[e.currentPage-1].rowIndex,t=e.rows[t-1];return t&&t[0]+1||e.currentPage},handleResize:function(e){t.handleResize.call(this,e),this.updateCurrentPage()},handleScroll:function(e){t.handleScroll.call(this,e),this.updateCurrentPage()},updateLayout:function(){var e=this.state,t=e.zoomState.zoom,t=Math.floor(e.widestPage.totalActualWidth*t),e=t<=e.viewportDimensions.clientWidth?"auto":t;this.$doc.css({width:e})}})}),_.addComponent("lazy-loader",function(e){var o,a,t,n,i,r=e.getUtility("common"),s=e.getUtility("browser"),l={},c=[],u=1,d=!0,g=1,h=!1,p={page:1,visiblePages:[1]};function f(e){e=e||u;var t=p.page-1;return r.constrainRange(t-e,t+e,a-1)}function m(){var e;clearTimeout(i),0<c.length?(e=c.shift(),o[e]?l.loadPage(e,function(e){!1===e?m():i=setTimeout(m,100)}):m()):v()}function v(){clearTimeout(i),d=!0}function y(e){c.push(e),d&&(clearTimeout(i),d=!1,i=setTimeout(m,100))}function b(e,t){t=f(t);return e>=t.min&&e<=t.max}function P(e){return-1<r.inArray(e+1,p.visiblePages)}function T(e,t){for(var a=r.sign(t-e);e!==t;)l.queuePageToLoad(e),e+=a;l.queuePageToLoad(e)}return r.extend(l,{messages:["beforezoom","pageavailable","pagefocus","ready","scroll","scrollend","zoom"],onmessage:function(e,t){switch(e){case"beforezoom":this.handleBeforeZoom(t);break;case"pageavailable":this.handlePageAvailable(t);break;case"pagefocus":this.handlePageFocus(t);break;case"ready":this.handleReady();break;case"scroll":this.handleScroll();break;case"scrollend":this.handleScrollEnd();break;case"zoom":this.handleZoom(t)}},init:function(e){a=(o=e).length,u=s.mobile||s.ielt10?8:32,u=Math.min(u,a)},destroy:function(){this.cancelAllLoading()},updateLayoutState:function(e){g=r.sign(e.page-p.page),p=e},loadNecessaryPages:r.debounce(100,function(){this.cancelAllLoading(),this.queuePageToLoad(p.page-1),this.loadVisiblePages(),this.loadPagesInRange(u)}),loadPagesInRange:function(e){var t=p.page-1;0<e&&(e=f(e),0<=g?(T(1+t,e.max),T(t-1,e.min)):(T(t-1,e.min),T(1+t,e.max)))},loadVisiblePages:function(){for(var e=0,t=p.visiblePages.length;e<t;++e)this.queuePageToLoad(p.visiblePages[e]-1)},queuePageToLoad:function(e){(e=>{if(o[e]){if(b(e))return 1;if(P(e))return 1}})(e)&&(o[e].preload(),y(e))},cancelAllLoading:function(){clearTimeout(n),clearTimeout(t),c.length=0,v()},loadPage:function(e,t){w.when(o[e]&&o[e].load()).always(t)},unloadPage:function(e){e=o[e];e&&e.unload()},unloadUnnecessaryPages:function(e){for(var t,a=0,n=o.length;a<n;++a)b(t=a,e)||P(t)||this.unloadPage(a)},handleReady:function(){h=!0,this.loadVisiblePages(),n=setTimeout(function(){l.loadNecessaryPages()},1e3)},handlePageAvailable:function(e){var t;if(h)if(!0===e.all&&(e.upto=a),e.page)this.queuePageToLoad(e.page-1);else if(e.upto)for(t=0;t<e.upto;++t)this.queuePageToLoad(t)},handlePageFocus:function(e){this.updateLayoutState(e),h&&(this.cancelAllLoading(),t=setTimeout(function(){l.loadNecessaryPages()},200))},handleBeforeZoom:function(e){h&&(this.cancelAllLoading(),this.unloadUnnecessaryPages(2*e.visiblePages.length))},handleZoom:function(e){this.updateLayoutState(e),h&&this.loadNecessaryPages()},handleScroll:function(){this.cancelAllLoading()},handleScrollEnd:function(){h&&(this.loadNecessaryPages(),this.unloadUnnecessaryPages(u))}})}),_.addComponent("page-img",function(t){var a,n,e,o,i=t.getUtility("browser"),r=!1,s=i.mobile;return{init:function(e,t){n=w(e),o=t},destroy:function(){s=!0,this.unload(),n.empty()},prepare:function(){},preload:function(){e=e||t.get("page-img",o)},load:function(){return this.preload(),e.done(function(e){r||(r=!0,a=w(e).appendTo(n))}),e.fail(function(e){r=!1,e&&t.broadcast("asseterror",e)}),e},unload:function(){e&&(e.abort(),e=null),s&&(a&&(a.remove(),a=null),r=!1)}}}),_.addComponent("page-links",function(a){var i,r=a.getUtility("browser");function s(e){var t=r.ie?e.target.parentNode:e.target,t=w(t).data("link");t&&a.broadcast("linkclick",t),e.preventDefault()}return{init:function(e,t){i=w(e),this.createLinks(t),r.ie||i.on("click","."+u,s)},destroy:function(){i.empty().off("click"),i=r=null},createLinks:function(e){for(var t=0,a=e.length;t<a;++t)(e=>{var t=w("<a>").addClass(u),a=e.bbox[0],n=e.bbox[1],o={};if(r.ie&&w("<span>").appendTo(t).on("click",s),t.css({left:a+"pt",top:n+"pt",width:e.bbox[2]-a+"pt",height:e.bbox[3]-n+"pt"}),e.uri){if(!/^http|^mailto/.test(e.uri))return;o.href=encodeURI(e.uri),o.target="_blank"}else e.destination&&(o.href="#page-"+e.destination.pagenum);t.attr(o),t.data("link",e),t.appendTo(i)})(e[t])}}}),_.addComponent("page-svg",function(c){var u,a,t,d,g=c.getUtility("browser"),h=j.DOMParser,n=!1,o=!1,i=!1,r=c.getConfig(),s=g.mobile||g.ielt10,p=g.ielt11||g.firefox?8:1;function e(){u&&0!==u.length||(i=!1,u=(()=>{switch(p){case 1:case 7:return w("<iframe>");case 6:case 2:return w("<object>").attr({type:U,data:"data:"+U+";base64,"+j.btoa(q)});case 3:return w("<div>");case 4:return w("<object>");case 5:case 8:return w("<img>")}})()),0===u.parent().length&&u.appendTo(a)}function l(e){n||o||(!i&&e&&((e=>{var t,a,n,o=u[0].contentDocument,i=u[0].contentWindow||o&&o.defaultView;switch(p){case 1:g.ielt10&&(e=e.replace(/<xhtml:link.*/,"")),r=$+e,g.ielt10?o.body.innerHTML=r:(o.documentElement.innerHTML=r,(g.ios||g.safari)&&g.version<7&&(r=(n=o).querySelectorAll("use"),[].forEach.call(r,function(e){var t=e.getAttribute("xlink:href"),t=n.querySelector(t).cloneNode(),a=e.parentNode;t.removeAttribute("id"),t.setAttribute("transform",e.getAttribute("transform")),a.replaceChild(t,e)}))),a=o.getElementsByTagName("svg")[0];break;case 7:o.documentElement.innerHTML=$;var r=o.getElementsByTagName("head")[0]||o.documentElement,s=o.createElement("script"),l="("+proxySVG+")()";s.type="text/javascript";try{s.appendChild(document.createTextNode(l))}catch(e){s.text=l}return r.insertBefore(s,r.firstChild),"complete"===o.readyState?i.loadSVG(e):i.onload=function(){this.loadSVG(e)};case 2:t=(new h).parseFromString(e,U),a=o.importNode(t.documentElement,!0),o.documentElement.appendChild(a);break;case 6:i.loadSVG(e),a=o.querySelector("svg");break;case 3:t=(new h).parseFromString(e,U),a=document.importNode(t.documentElement,!0),u.append(a);break;case 4:u.attr({type:U,data:c.getDataProvider("page-svg").getURL(d)}),a=u[0];break;case 5:(a=u[0]).src=c.getDataProvider("page-svg").getURL(d);break;case 8:a=u[0],l="data:"+U,!g.ie&&j.btoa?a.src=l+";base64,"+j.btoa(e):a.src=l+","+encodeURIComponent(e)}a.setAttribute("width","100%"),a.setAttribute("height","100%")})(e),i=!0,s||(t.abort(),t=null)),0===u.parent().length&&u.appendTo(a))}function f(e){c.broadcast("asseterror",e),i=!1,t&&t.abort()}return{init:function(e,t){a=e,d=t,p=r.embedStrategy||p},destroy:function(){s=n=!0,this.unload(),a.empty()},prepare:function(){e()},preload:function(){this.prepare(),t=t||(i||4===p||5===p?w.Deferred().resolve().promise({abort:function(){}}):c.get("page-svg",d))},load:function(){return o=!1,this.preload(),t.done(l).fail(f),t},unload:function(){o=!0,t&&"resolved"!==t.state()&&(t.abort(),t=null),s&&(u&&(u.remove(),u=null),i=!1)}}}),_.addComponent("page-text",function(t){var a,e,n,o=t.getUtility("browser"),i=t.getUtility("subpx"),r=!1,s=!1,l=t.getConfig();function c(e){var t;!e||s||r||(s=!0,(t=document.implementation.createHTMLDocument("")).getElementsByTagName("body")[0].innerHTML=e,e=null,e=document.importNode(t.querySelector("."+g),!0),a.attr("class",e.getAttribute("class")),a.html(e.innerHTML),i.fix(a))}function u(e){e&&t.broadcast("asseterror",e)}function d(){return e=e||(l.enableTextSelection&&!o.ielt9?t.get("page-text",n):w.Deferred().resolve().promise({abort:function(){}}))}return{init:function(e,t){a=e,n=t},destroy:function(){r=!0,this.unload(),a.empty()},preload:function(){d()},load:function(){return d().done(c).fail(u)},unload:function(){e&&"resolved"!==e.state()&&(e.abort(),e=null)},enable:function(){a.css("display",""),e&&!s&&(e=null)},disable:function(){a.css("display","none")}}}),_.addComponent("page",function(o){var i,r,s,l,c,a,u,d=o.getUtility("support"),n=o.getUtility("common"),t=!1;return{messages:["pageavailable","pagefocus","textenabledchange","zoom"],onmessage:function(e,t){switch(e){case"pageavailable":(t.page===c+1||t.upto>c||!0===t.all)&&u===R&&(u=E);break;case"textenabledchange":!0===t.enabled?this.enableTextSelection():this.disableTextSelection();break;case"pagefocus":case"zoom":a=l===t.page||-1<n.inArray(l,t.visiblePages)}},init:function(e,t){var a=(i=e).find("."+k),n=e.find("."+g),e=e.find("."+V);u=t.status||E,l=(c=t.index)+1,(this.config=t).url=t.url||"",r=o.createComponent("page-text"),s=d.svg?o.createComponent("page-svg"):o.createComponent("page-img"),r.init(n,l),s.init(a,l),t.enableLinks&&t.links.length&&o.createComponent("page-links").init(e,t.links)},destroy:function(){this.unload()},preload:function(){s.prepare(),u===E&&(s.preload(),r.preload())},load:function(){var e=this;return t=!0,"error"!==u&&u!==R&&(u!==Z&&(u="loading"),w.when(s.load(),r.load()).done(function(){t?u!==Z&&(i.removeClass(h),u=Z,o.broadcast("pageload",{page:l})):e.unload()}).fail(function(e){u="error",i.addClass(p),o.broadcast("pagefail",{page:c+1,error:e})}))},unload:function(){t=!1,s.unload(),r.unload(),u===Z&&(u=E,i.addClass(h),i.removeClass(p),o.broadcast("pageunload",{page:l}))},enableTextSelection:function(){r.enable(),a&&r.load()},disableTextSelection:function(){r.disable()}}}),_.addComponent("resizer",function(a){var n,o,i,r,s,l=a.getUtility("common"),c=[""," webkit"," moz"," "].join("fullscreenchange")+"MSFullscreenChange",u=w(j),d=w(document),g=0,h=(()=>{try{return j.self!==j.top}catch(e){return!0}})();function p(){var e=n.offsetHeight,t=n.offsetWidth;h&&0===g&&0!==j.innerWidth?(g=j.innerWidth,a.broadcast("layoutchange")):!e||e===s&&t===r||(s=e,r=t,i=n.clientHeight,o=n.clientWidth,a.broadcast("resize",{width:r,height:s,clientWidth:o,clientHeight:i,offsetWidth:r,offsetHeight:s}))}return{messages:["layoutchange"],onmessage:function(){s=null,p()},init:function(e){var t;((n=w(e).get(0))===j?(n=document.documentElement,u):(e=w('<iframe frameborder="0">'),t=w("<div>"),e.add(t).css({opacity:0,visiblility:"hidden",position:"absolute",width:"100%",height:"100%",top:0,left:0,border:0}),e.prependTo(t.prependTo(n)),"static"===l.getComputedStyle(n).position&&w(n).css({position:"relative"}),u=w(e[0].contentWindow))).on("resize",p),d.on(c,p),p()},destroy:function(){d.off(c,p),u.off("resize",p)}}}),_.addComponent("scroller",function(e){var t,a,n=e.getUtility("common"),o=e.getUtility("browser"),i=3e3,r=30,s=o.mobile?500:250,l=!1,c=!1,u=null;function d(){return{scrollTop:t.scrollTop(),scrollLeft:t.scrollLeft()}}var g=n.throttle(200,function(){e.broadcast("scroll",d())});function h(){l=!1,u=null,clearTimeout(a),e.broadcast("scrollend",d())}function p(){l||(l=!0,e.broadcast("scrollstart",d())),clearTimeout(a),a=setTimeout(h,s),g()}function f(){c=!!0,p()}function m(){c=!0,p()}function v(){0,(new Date).getTime(),c&&y()}function y(){clearTimeout(a),null===u&&(u=(new Date).getTime()),(new Date).getTime()-u>i?h():(g(),a=setTimeout(y,r))}return{init:function(e){(t=w(e)).on("scroll",p),t.on("touchstart",f),t.on("touchmove",m),t.on("touchend",v)},destroy:function(){clearTimeout(a),t.off("scroll",p),t.off("touchstart",f),t.off("touchmove",m),t.off("touchend",v)}}}),_.addComponent("viewer-base",function(i){var n,r,o,s,l,c,u,d=i.getUtility("common"),g=i.getUtility("browser"),h=i.getUtility("support");function p(){var e;o.attr("data-svg-version",r.metadata.version||"0.0.0"),g.mobile&&o.addClass("crocodoc-mobile"),g.ielt9&&o.addClass("crocodoc-ielt9"),h.svg&&o.addClass("crocodoc-supports-svg"),i.createComponent("scroller").init(r.$viewport),i.createComponent("resizer").init(r.$viewport),"text"===r.metadata.type?(e=i.createComponent("controller-text"),r.layout=O):e=i.createComponent("controller-paged"),e.init(),"text"===r.metadata.type?r.enableTextSelection||n.disableTextSelection():g.ielt9&&n.disableTextSelection(),r.enableLinks&&!g.ielt9||n.disableLinks(),n.setLayout(r.layout),i.broadcast("ready",{page:r.page||1,numPages:r.numPages}),i.ready()}return{messages:["asseterror","destroy","dragend","dragstart","fail","layoutchange","linkclick","pagefail","pagefocus","pageload","pageunload","ready","resize","scrollstart","scrollend","zoom"],onmessage:function(e,t){switch(e){case"layoutchange":n.updateLayout();break;case"linkclick":a=t,n.fire("linkclick",a).isDefaultPrevented()||(a.uri?j.open(a.uri):a.destination&&n.scrollTo(a.destination.pagenum));break;case"zoom":t.zoom*=r.pageScale,t.prevZoom*=r.pageScale,r.enableDragging&&(t.isDraggable?c||(o.addClass(m),(c=i.createComponent("dragger")).init(r.$viewport)):c&&(o.removeClass(m),i.destroyComponent(c),c=null)),n.fire(e,t);break;case"dragstart":o.hasClass(v)||o.addClass(v),n.fire(e,t);break;case"dragend":o.hasClass(v)&&o.removeClass(v),n.fire(e,t);break;default:n.fire(e,t)}var a},init:function(){if(r=i.getConfig(),n=r.api,r.namespace=f+"-"+r.id,(o=r.$el).addClass(f),o.addClass(r.namespace),!r.url)throw new Error("no URL given for viewer assets");var e,t,a;for(t in/\/$/.test(r.url)||(r.url+="/"),r.url=i.getUtility("url").makeAbsolute(r.url),r.queryParams&&(e="string"==typeof r.queryParams?r.queryParams.replace(/^\?/,""):d.param(r.queryParams)),r.queryString=e?"?"+e:"",o.html(_.viewerTemplate),r.useWindowAsViewport?(r.$viewport=w(j),o.addClass("crocodoc-window-as-viewport")):r.$viewport=o.find("."+I),r.$doc=o.find("."+H),r.plugins||{})(a=i.createComponent("plugin-"+t))&&d.isFn(a.init)&&a.init(r.plugins[t])},destroy:function(){o.empty().removeClass(function(e,t){t=t.match(new RegExp("crocodoc\\S+","g"));return t&&t.join(" ")}),w(s).remove(),u&&u.abort()},setLayout:function(e){var t,a=r.page,n=r.zoom||1,o=r.layout;if(l){if(e===o)return l;a=l.state.currentPage,n=l.state.zoomState}if(t=i.createComponent("layout-"+e))return l&&i.destroyComponent(l),r.layout=e,(l=t).init(),l.setZoom(n.zoomMode||n.zoom||n),d.isFn(l.scrollTo)&&l.scrollTo(a),r.currentLayout=l,i.broadcast("layoutchange",{previousLayout:o,layout:e}),l;throw new Error("Invalid layout "+e)},loadAssets:function(){var e,t,a,n;u||((t=i.get("metadata")).then(function(e){r.metadata=e}),g.ielt9?(s=d.insertCSS(""),r.stylesheet=s.styleSheet,e=w.when("").promise({abort:function(){}})):(e=i.get("stylesheet")).then(function(e){s=d.insertCSS(e),r.stylesheet=s.sheet}),!r.autoloadFirstPage||r.pageStart&&1!==r.pageStart||(h.svg?a=i.get("page-svg",1):r.conversionIsComplete&&(a=i.get("page-img",1)),r.enableTextSelection&&(n=i.get("page-text",1))),u=w.when(t,e).fail(function(e){u&&u.abort(),i.ready(),i.broadcast("asseterror",e),i.broadcast("fail",e)}).then(p).promise({abort:function(){u=null,t.abort(),e.abort(),a&&a.abort(),n&&n.abort()}}))}}}),_},"object"!=typeof exports?e(jQuery):void(module.exports=e))})("undefined"!=typeof window?window:this);
//# sourceMappingURL=crocodoc.viewer.min.js.map
