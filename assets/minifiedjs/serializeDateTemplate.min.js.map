{"version":3,"sources":["serializeForm.js","dateWidget.js","template.js","advancedSearchForm.js"],"names":["$","fn","serializeForm","this","length","data","lookup","selector","parse","named","name","replace","split","cap","$el","i","undefined","push","val","filter","each","find","jQuery","modifyRange","event","closest","text","window","mozInnerScreenX","show","hide","parseDateString","dateString","Date","create","isValid","dateNumeric","utc","getTime","target","siblings","toLowerCase","indexOf","matches","match","yearsAgo","bceDate","parseDate","document","ready","on","trigger","mapGetScript","url","callback","cache","ajax","type","success","dataType","async","e","cachedWidth","navbarToTopHeight","navbarHeight","scrollManage","documentElement","clientWidth","offset","top","parseFloat","css","height","_height","parseInt","addClass","scroll","y","scrollTop","z","removeClass","load","resize","Mousetrap","bind","toggle","preventDefault","targetItem","searchId","loadLastSearch","cookie","removeCookie","path","err","getRedirect","direction","objectId","get","basePath","parsed","parseJSON","status","nextResultLink","targetId","location","search","specificSearch","newSpecificSearch","clone","after","collectionCopy","newCollection","templateCopy","newTemplate","selectedOption","content","templateId","targetGroup","post","fieldTitle","template","textStatus","xhr","html","selectElement","values","index","append","value"],"mappings":"CAOC,SAAUA,GACTA,EAAEC,GAAGC,cAAgB,WAGnB,GAAKC,KAAKC,OAAS,EACjB,OAAO,EAGT,IAAIC,EAAO,GACPC,EAASD,EACTE,EAAW,yDACXC,EAAQ,WAGV,IAAIC,EAAQN,KAAKO,KAAKC,QAAQ,iBAAkB,OAAOC,MAAM,KACzDC,EAAMJ,EAAML,OAAS,EACrBU,EAAMd,EAAGG,MAGb,GAAKM,EAAO,GAAM,CAChB,IAAM,IAAIM,EAAI,EAAGA,EAAIF,EAAKE,IAExBT,EAASA,EAAQG,EAAMM,IAAOT,EAAQG,EAAMM,MACrB,KAAnBN,EAAOM,EAAI,GAAa,GAAK,SAIXC,IAAnBV,EAAOF,OACVE,EAAOW,KAAMH,EAAII,OAEjBZ,EAAQG,EAAOI,IAAWC,EAAII,MAIhCZ,EAASD,IAWb,OANAF,KAAKgB,OAAQZ,GAAWa,KAAMZ,GAG9BL,KAAKkB,KAAMd,GAAWa,KAAMZ,GAGrBH,GA7CX,CA+CGiB;AClDH,SAASC,YAAYC,GACA,GAAjBxB,EAAEG,MAAMe,OACVlB,EAAEG,MAAMsB,QAAQ,mBAAmBJ,KAAK,eAAeK,KAAK,SAG7B,MAA1BC,OAAOC,gBACX5B,EAAEG,MAAMsB,QAAQ,mBAAmBJ,KAAK,cAAcQ,OAGtD7B,EAAEG,MAAMsB,QAAQ,mBAAmBJ,KAAK,cAAcQ,KAAK,QAAQ,iBAOpE7B,EAAEG,MAAMsB,QAAQ,mBAAmBJ,KAAK,eAAeK,KAAK,QAC7B,MAA1BC,OAAOC,gBACX5B,EAAEG,MAAMsB,QAAQ,mBAAmBJ,KAAK,cAAcS,OAGtD9B,EAAEG,MAAMsB,QAAQ,mBAAmBJ,KAAK,cAAcS,KAAK,QAAQ,gBAStE,SAASC,gBAAgBC,EAAYR,GACpC,GAAGQ,EAAW5B,OAAS,EAAG,CACzB,GAAG6B,KAAKC,OAAOF,GAAYG,UAAW,CACrC,IAAIC,EAAcH,KAAKI,IAAIH,OAAOF,GAAYM,UAAU,IAKxD,OAJGd,GACFxB,EAAEwB,EAAMe,QAAQC,SAAS,eAAetB,IAAIkB,IAGtC,EAGP,IAA8C,GAA3CJ,EAAWS,cAAcC,QAAQ,MAoBnC,OAAO,EAlBP,IACIC,GAFJX,EAAaA,EAAWrB,QAAQ,KAAM,KAEbiC,MADX,WAEd,GAAGD,EAAQvC,OAAO,EAAG,CACpB,IAAIyC,EAAWF,EAAQ,IAC4B,GAAhDX,EAAWS,cAAcC,QAAQ,aACnCG,GAAsB,KAGvB,IAAIC,GAAY,EAAID,EAAW,SAAY,WAK3C,OAJGrB,GACFxB,EAAEwB,EAAMe,QAAQC,SAAS,eAAetB,IAAI4B,IAGtC,QAUV9C,EAAEwB,EAAMe,QAAQC,SAAS,eAAetB,IAAI,IAI9C,SAAS6B,UAAUvB,GAElBO,gBADiB/B,EAAEG,MAAMe,MACGM,GAG7BxB,EAAEgD,UAAUC,OAAM,WACjBjD,EAAEgD,UAAUE,GAAI,SAAU,eAAgB3B,aAC1CvB,EAAG,gBAAiBmD,QAAS,UAC7BnD,EAAEgD,UAAUE,GAAG,SAAU,YAAaH;AClFvC/C,EAAEoD,aAAe,SAASC,EAAKC,EAAUC,GACvC,OAAOvD,EAAEwD,KAAK,CACZC,KAAM,MACNJ,IAAKA,EACLK,QAASJ,EACTK,SAAU,SACVJ,OAAO,EACPK,OAAO,KAKX5D,EAAEgD,UAAUC,OAAM,WAMhBjD,EAAE,wBAAwBkD,GAAG,kBAAkB,SAASW,GACtD7D,EAAE,uBAAuBkB,IAAIlB,EAAE,eAAekB,aAKlD,IAAI4C,YAAc,EACdC,kBAAoB,EACpBC,aAAe,EAEnB,SAASC,eACP,GAAGjB,SAASkB,gBAAgBC,aAAeL,cAG3CA,YAAcd,SAASkB,gBAAgBC,YACnCnE,EAAE,WAAWI,QAAjB,CAGA2D,kBAAoB/D,EAAE,WAAWoE,SAASC,IAAMC,WAAWtE,EAAE,WAAWuE,IAAI,cAAc5D,QAAQ,OAAQ,IAC1GqD,aAAehE,EAAE,WAAWwE,SAC5B,IAAIC,EAAUzE,EAAE,WAAWwE,SACF,IAAtBT,mBAEEf,SAASkB,gBAAgBC,YAAc,IACxCnE,EAAE,gBAAgBuE,IAAI,cAAe,GAAKG,SAAS1E,EAAE,WAAWuE,IAAI,YAGpEvE,EAAE,gBAAgBuE,IAAI,cAAe,GAEvCvE,EAAE,WAAW2E,SAAS,qBAGtB3E,EAAE2B,QAAQiD,QAAO,SAASpD,GACxB,IAAIqD,EAAI7E,EAAEG,MAAM2E,YACZC,EAAI/E,EAAE,WAAWoE,SAASC,IAE3BU,EAAI/E,EAAGgD,UAAWwB,WAGjBK,GAAKd,mBAAsBc,EAAEJ,EAAWM,GAEvC/B,SAASkB,gBAAgBC,YAAc,IACxCnE,EAAE,gBAAgBuE,IAAI,cAAeG,SAAS1E,EAAE,WAAWuE,IAAI,WAAa,IAG5EvE,EAAE,gBAAgBuE,IAAI,cAAe,GAEvCvE,EAAE,WAAW2E,SAAS,sBAGnB3B,SAASkB,gBAAgBC,YAAc,KACxCnE,EAAE,gBAAgBuE,IAAI,cAAe,GAEvCvE,EAAE,WAAWgF,YAAY,0BAOjChF,EAAE2B,QAAQsD,MAAK,WACbhB,kBAIFjE,EAAE2B,QAAQuD,QAAO,WACfjB,kBAIFkB,UAAUC,KAAK,kBAAkB,WAC/BpF,EAAE,oBAAoBqF,YAGxBrF,EAAE,2BAA2BkD,GAAG,SAAS,SAASW,GAEhDA,EAAEyB,iBAEFC,WAAavF,EAAEG,MAAME,KAAK,iBAE1BL,EAAE,eAAekB,IAAIqE,YACrBvF,EAAE,mBAAmB0B,KAAK1B,EAAEG,MAAMuB,WAQpC,IAAI8D,SAAW,KACf,SAASC,iBACP,IACED,SAAWxF,EAAE0F,OAAO,cACpB1F,EAAE2F,aAAa,aAAc,CAC7BC,KAAM,MAGR,MAAMC,IAMN,GAAIL,SAAU,CACZxF,EAAE,wBAAwBgF,YAAY,QAEtC,IAAIc,EAAc,SAASC,EAAWP,EAAUQ,GAE9ChG,EAAE0F,OAAO,aAAcF,EAAU,CAC/BI,KAAM,MAGR5F,EAAEiG,IAAIC,SAAW,oBAAsBH,EAAY,IAAMP,EAAW,IAAMQ,GAAU,SAAU3F,GAC5F,IAAI8F,EAASnG,EAAEoG,UAAU/F,GACJ,SAAjB8F,EAAOE,OACTC,eAAeH,EAAOI,UAEtB5E,OAAO6E,SAAWN,SAAW,YAAcC,EAAOM,WAKxDzG,EAAE,mBAAmBkD,GAAG,SAAS,SAAUW,GAEzCA,EAAEyB,iBACFQ,EAAY,WAAYN,SAAUQ,aAEpChG,EAAE,eAAekD,GAAG,SAAS,SAAUW,GACrCA,EAAEyB,iBACFQ,EAAY,OAAQN,SAAUQ;AClJpChG,EAAEgD,UAAUE,GAAG,QAAS,uBAAuB,WAC3ClD,EAAE,kBAAkBgF,YAAY,QAChC,IAAI0B,EAAiB1G,EAAEG,MAAMsB,QAAQ,mBACjCkF,EAAoB3G,EAAE0G,GAAgBE,OAAM,GAChDD,EAAkBtF,KAAK,sBAAsBH,IAAI,IACjDlB,EAAE0G,GAAgBG,MAAMF,MAI5B3G,EAAEgD,UAAUE,GAAG,QAAS,yBAAyB,WAC7C,IAAI4D,EAAiB9G,EAAEG,MAAMsB,QAAQ,eACjCsF,EAAgB/G,EAAE8G,GAAgBF,OAAM,GAC5CG,EAAc1F,KAAK,sBAAsBH,IAAI,IAC7ClB,EAAE8G,GAAgBD,MAAME,MAG5B/G,EAAEgD,UAAUE,GAAG,QAAS,uBAAuB,WAC3C,IAAI8D,EAAehH,EAAEG,MAAMsB,QAAQ,eAC/BwF,EAAcjH,EAAEgH,GAAcJ,OAAM,GACxC5G,EAAEgH,GAAcH,MAAMI,MAI1BjH,EAAEgD,UAAUE,GAAG,SAAU,mBAAmB,WACxC,IAAIgE,EAAiBlH,EAAEG,MAAMkB,KAAK,aAC9B8F,EAAUnH,EAAEkH,GAAgBhG,MAC5BkG,EAAapH,EAAEkH,GAAgB7G,KAAK,cACpCgH,EAAcrH,EAAEG,MAAMsB,QAAQ,eAAeJ,KAAK,gCACtDrB,EAAEsH,KAAKpB,SAAW,sBAAuB,CAACqB,WAAYJ,EAASK,SAAUJ,IAAa,SAAS/G,EAAMoH,EAAYC,GAC7F,QAAbrH,EAAKoD,MACJzD,EAAEqH,GAAaM,KAAK,IACpB3H,EAAEqH,GAAaM,KAAK,4IAGpB3H,EAAEqH,GAAaM,KAAK,IACpB3H,EAAEqH,GAAaM,KAAK,sHACpBC,cAAgB5H,EAAEqH,GAAahG,KAAK,UACpCrB,EAAEoB,KAAKf,EAAKwH,QAAQ,SAASC,EAAO5G,GACb,iBAAT4G,EACN9H,EAAE4H,eAAeG,OAAO/H,EAAE,WAAY,CAACgI,MAAOF,IAAQpG,KAAKR,IAG3DlB,EAAE4H,eAAeG,OAAO/H,EAAE,WAAY,CAACgI,MAAO9G,IAAMQ,KAAKR","file":"serializeDateTemplate.min.js","sourcesContent":["/*\n * serializeForm\n * https://github.com/danheberden/serializeForm\n *\n * Copyright (c) 2012 Dan Heberden\n * Licensed under the MIT, GPL licenses.\n */\n(function( $ ){\n  $.fn.serializeForm = function() {\n\n    // don't do anything if we didn't get any elements\n    if ( this.length < 1) {\n      return false;\n    }\n\n    var data = {};\n    var lookup = data; //current reference of data\n    var selector = ':input[type!=\"checkbox\"][type!=\"radio\"], input:checked';\n    var parse = function() {\n\n      // data[a][b] becomes [ data, a, b ]\n      var named = this.name.replace(/\\[([^\\]]+)?\\]/g, ',$1').split(',');\n      var cap = named.length - 1;\n      var $el = $( this );\n\n      // Ensure that only elements with valid `name` properties will be serialized\n      if ( named[ 0 ] ) {\n        for ( var i = 0; i < cap; i++ ) {\n          // move down the tree - create objects or array if necessary\n          lookup = lookup[ named[i] ] = lookup[ named[i] ] ||\n            ( named[ i + 1 ] === \"\" ? [] : {} );\n        }\n\n        // at the end, push or assign the value\n        if ( lookup.length !==  undefined ) {\n          lookup.push( $el.val() );\n        }else {\n          lookup[ named[ cap ] ]  = $el.val();\n        }\n\n        // assign the reference back to root\n        lookup = data;\n      }\n    };\n\n    // first, check for elements passed into this function\n    this.filter( selector ).each( parse );\n\n    // then parse possible child elements\n    this.find( selector ).each( parse );\n\n    // return data\n    return data;\n  };\n}( jQuery ));","\n\n\n\nfunction modifyRange(event) {\n\tif($(this).val() == 1) {\n\t\t$(this).closest(\".widgetContents\").find('.startLabel').text(\"Start\");\n\t\t// Firefox fails to handle animation when items are off-screen.  Disable animation.\n\t\t// TODO: refactor this in a smarter way.\n\t\tif(!(window.mozInnerScreenX == null)) {\n\t\t\t$(this).closest(\".widgetContents\").find('.dateRange').show();\n\t\t}\n\t\telse {\n\t\t\t$(this).closest(\".widgetContents\").find('.dateRange').show('fast', function() {\n\n\t\t\t});\t\n\t\t}\n\t\t\n\t}\n\telse {\n\t\t$(this).closest(\".widgetContents\").find('.startLabel').text(\"Date\");\n\t\tif(!(window.mozInnerScreenX == null)) {\n\t\t\t$(this).closest(\".widgetContents\").find('.dateRange').hide();\n\t\t}\n\t\telse {\n\t\t\t$(this).closest(\".widgetContents\").find('.dateRange').hide('fast', function() {\n\n\t\t\t});\n\t\t}\n\t\t\n\t}\n\n}\n\nfunction parseDateString(dateString, event) {\n\tif(dateString.length > 0) {\n\t\tif(Date.create(dateString).isValid()) {\n\t\t\tvar dateNumeric = Date.utc.create(dateString).getTime()/1000;\n\t\t\tif(event) {\n\t\t\t\t$(event.target).siblings('.dateHidden').val(dateNumeric);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\tif(dateString.toLowerCase().indexOf('bc') != -1) {\n\t\t\t\tdateString = dateString.replace(/,/g, '');\n\t\t\t\tvar pattern = /[0-9]+/g;\n\t\t\t\tvar matches = dateString.match(pattern);\n\t\t\t\tif(matches.length>0) {\n\t\t\t\t\tvar yearsAgo = matches[0];\n\t\t\t\t\tif(dateString.toLowerCase().indexOf('century') != -1) {\n\t\t\t\t\t\tyearsAgo = yearsAgo * 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar bceDate = (-1 * yearsAgo * 31556900) - (1970*31556900); // seconds in a year\n\t\t\t\t\tif(event) {\n\t\t\t\t\t\t$(event.target).siblings('.dateHidden').val(bceDate);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t//TODO: make this trigger parse error instead!\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\t$(event.target).siblings('.dateHidden').val(\"\");\n\t}\n}\n\nfunction parseDate(event) {\n\tvar dateString = $(this).val();\n\tparseDateString(dateString, event);\n}\n\n$(document).ready(function() {\n\t$(document).on( \"change\", \".rangeModify\", modifyRange );\n\t$( \".rangeModify\" ).trigger( \"change\" );\n\t$(document).on(\"change\", \".dateText\", parseDate);\n});\n","$.mapGetScript = function(url, callback, cache){\n  return $.ajax({\n    type: \"GET\",\n    url: url,\n    success: callback,\n    dataType: \"script\",\n    cache: false,\n    async: false\n  });\n};\n\n\n$(document).ready(function() {\n  /**\n  * don't load the map js stuff until we need the advancedSearch modal\n  * @param  {[type]} e [description]\n  * @return {[type]}   [description]\n  */\n  $(\"#advancedSearchModal\").on(\"shown.bs.modal\", function(e) {\n    $(\".advancedSearchText\").val($(\".searchText\").val());\n  });\n});\n\n\nvar cachedWidth = 0;\nvar navbarToTopHeight = 0;\nvar navbarHeight = 0;\n\nfunction scrollManage() {\n  if(document.documentElement.clientWidth == cachedWidth) {\n    return;\n  }\n  cachedWidth = document.documentElement.clientWidth;\n  if(!$('.navbar').length) {\n    return;\n  }\n  navbarToTopHeight = $('.navbar').offset().top - parseFloat($('.navbar').css('margin-top').replace(/auto/, 0));\n  navbarHeight = $('.navbar').height();\n  var _height = $('.navbar').height();\n  if(navbarToTopHeight === 0) {\n    \n    if(document.documentElement.clientWidth > 768) {\n      $('.mainContent').css('padding-top', 20 + parseInt($('.navbar').css('height')));\n    }\n    else {\n      $('.mainContent').css('padding-top', 0);\n    }\n    $('.navbar').addClass('navbar-fixed-top');\n  }\n  else {\n    $(window).scroll(function(event) {\n      var y = $(this).scrollTop();\n      var z = $('.footer').offset().top;\n      \n      if(z > $( document ).height()) {\n        return;\n      }\n      if (y >= navbarToTopHeight && (y+_height) < z) {\n        \n        if(document.documentElement.clientWidth > 768) {\n          $('.mainContent').css('padding-top', parseInt($('.navbar').css('height')) + 20);\n        }\n        else {\n          $('.mainContent').css('padding-top', 0);\n        }\n        $('.navbar').addClass('navbar-fixed-top');\n      } else {\n        \n        if(document.documentElement.clientWidth > 768) {\n          $('.mainContent').css('padding-top', 0);\n        }\n        $('.navbar').removeClass('navbar-fixed-top');\n      }\n    });\n  }\n}\n\n// handle sticky header regardless of header size.\n$(window).load(function() {\n  scrollManage();\n});\n\n\n$(window).resize(function() {\n  scrollManage();\n});\n\n// command-control-h reveals hidden content (anything flagged advancedContent)\nMousetrap.bind('command+ctrl+h', function() {\n  $(\".advancedContent\").toggle();\n});\n\n$(\".collectionFilterSelect\").on(\"click\", function(e) {\n  \n  e.preventDefault();\n  \n  targetItem = $(this).data(\"collection-id\");\n  \n  $(\"#collection\").val(targetItem);\n  $(\"#search_concept\").text($(this).text());\n});\n\n\n/**\n* Management for \"searchsearch\" functionality on asset page and editing\n*/\n\nvar searchId = null;\nfunction loadLastSearch() {\n  try {\n    searchId = $.cookie(\"lastSearch\");\n    $.removeCookie(\"lastSearch\", {\n    path: '/'\n  });\n  }\n  catch(err) {\n  \n  }\n  \n  \n  \n  if (searchId) {\n    $(\".searchResultsNavBar\").removeClass(\"hide\");\n    \n    var getRedirect = function(direction, searchId, objectId) {\n      \n      $.cookie('lastSearch', searchId, {\n        path: \"/\"\n      });\n      \n      $.get(basePath + \"search/getResult/\" + direction + \"/\" + searchId + \"/\" + objectId, function (data) {\n        var parsed = $.parseJSON(data);\n        if (parsed.status == \"found\") {\n          nextResultLink(parsed.targetId);\n        } else {\n          window.location = basePath + \"search/s/\" + parsed.search;\n        }\n      });\n    }\n    \n    $(\".previousResult\").on(\"click\", function (e) {\n      \n      e.preventDefault();\n      getRedirect(\"previous\", searchId, objectId);\n    });\n    $(\".nextResult\").on(\"click\", function (e) {\n      e.preventDefault();\n      getRedirect(\"next\", searchId, objectId);\n    });\n  }\n  \n}\n","// Manages the advanced search\n$(document).on(\"click\", \".addAnotherSpecific\", function() {\n    $(\".searchCombine\").removeClass(\"hide\");\n    var specificSearch = $(this).closest('.specificSearch');\n    var newSpecificSearch = $(specificSearch).clone(false);\n    newSpecificSearch.find(\"input[type='text']\").val(\"\");\n    $(specificSearch).after(newSpecificSearch);\n\n});\n\n$(document).on(\"click\", \".addAnotherCollection\", function() {\n    var collectionCopy = $(this).closest('.form-group');\n    var newCollection = $(collectionCopy).clone(false);\n    newCollection.find(\"input[type='text']\").val(\"\");\n    $(collectionCopy).after(newCollection);\n});\n\n$(document).on(\"click\", \".addAnotherTemplate\", function() {\n    var templateCopy = $(this).closest('.form-group');\n    var newTemplate = $(templateCopy).clone(false);\n    $(templateCopy).after(newTemplate);\n});\n\n\n$(document).on(\"change\", \".searchDropdown\", function() {\n    var selectedOption = $(this).find(\":selected\");\n    var content = $(selectedOption).val();\n    var templateId = $(selectedOption).data('templateid');\n    var targetGroup = $(this).closest(\".form-group\").find(\".specificSearchTextContainer\");\n    $.post(basePath + 'search/getFieldInfo', {fieldTitle: content, template: templateId}, function(data, textStatus, xhr) {\n        if(data.type == \"text\") {\n            $(targetGroup).html(\"\");\n            $(targetGroup).html('<input type=\"text\" name=\"specificSearchText[]\"  autocomplete=\"off\" class=\"form-control advancedOption advancedSearchContent\" value=\"\">');\n        }\n        else {\n            $(targetGroup).html(\"\");\n            $(targetGroup).html('<select name=\"specificSearchText[]\"  autocomplete=\"off\" class=\"form-control advancedOption advancedSearchContent\">');\n            selectElement = $(targetGroup).find(\"select\");\n            $.each(data.values, function(index, val) {\n                if(typeof index == \"string\") {\n                    $(selectElement).append($('<option>', {value: index}).text(val));\n                }\n                else {\n                    $(selectElement).append($('<option>', {value: val}).text(val));\n                }\n                \n            });\n\n        }\n\n    });\n});\n\n"]}