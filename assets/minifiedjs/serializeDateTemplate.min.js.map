{"version":3,"sources":["serializeForm.js","dateWidget.js","template.js"],"names":["$","fn","serializeForm","this","length","data","lookup","selector","parse","named","name","replace","split","cap","$el","i","undefined","push","val","filter","each","find","jQuery","modifyRange","event","closest","text","window","mozInnerScreenX","show","hide","parseDateString","dateString","Date","create","isValid","dateNumeric","utc","getTime","target","siblings","toLowerCase","indexOf","pattern","matches","match","yearsAgo","bceDate","parseDate","document","ready","on","trigger","scrollManage","documentElement","clientWidth","cachedWidth","navbarToTopHeight","offset","top","parseFloat","css","navbarHeight","height","_height","parseInt","addClass","scroll","y","scrollTop","z","removeClass","mapGetScript","url","callback","cache","ajax","type","success","dataType","async","e","goMap","doc_write","write","s","appendTo","done","setTimeout","load","resize","Mousetrap","bind","toggle","preventDefault","targetItem"],"mappings":"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","file":"serializeDateTemplate.min.js","sourcesContent":["/*\n * serializeForm\n * https://github.com/danheberden/serializeForm\n *\n * Copyright (c) 2012 Dan Heberden\n * Licensed under the MIT, GPL licenses.\n */\n(function( $ ){\n  $.fn.serializeForm = function() {\n\n    // don't do anything if we didn't get any elements\n    if ( this.length < 1) {\n      return false;\n    }\n\n    var data = {};\n    var lookup = data; //current reference of data\n    var selector = ':input[type!=\"checkbox\"][type!=\"radio\"], input:checked';\n    var parse = function() {\n\n      // data[a][b] becomes [ data, a, b ]\n      var named = this.name.replace(/\\[([^\\]]+)?\\]/g, ',$1').split(',');\n      var cap = named.length - 1;\n      var $el = $( this );\n\n      // Ensure that only elements with valid `name` properties will be serialized\n      if ( named[ 0 ] ) {\n        for ( var i = 0; i < cap; i++ ) {\n          // move down the tree - create objects or array if necessary\n          lookup = lookup[ named[i] ] = lookup[ named[i] ] ||\n            ( named[ i + 1 ] === \"\" ? [] : {} );\n        }\n\n        // at the end, push or assign the value\n        if ( lookup.length !==  undefined ) {\n          lookup.push( $el.val() );\n        }else {\n          lookup[ named[ cap ] ]  = $el.val();\n        }\n\n        // assign the reference back to root\n        lookup = data;\n      }\n    };\n\n    // first, check for elements passed into this function\n    this.filter( selector ).each( parse );\n\n    // then parse possible child elements\n    this.find( selector ).each( parse );\n\n    // return data\n    return data;\n  };\n}( jQuery ));","\n\n\n\nfunction modifyRange(event) {\n\tif($(this).val() == 1) {\n\t\t$(this).closest(\".widgetContents\").find('.startLabel').text(\"Start\");\n\t\t// Firefox fails to handle animation when items are off-screen.  Disable animation.\n\t\t// TODO: refactor this in a smarter way.\n\t\tif(!(window.mozInnerScreenX == null)) {\n\t\t\t$(this).closest(\".widgetContents\").find('.dateRange').show();\n\t\t}\n\t\telse {\n\t\t\t$(this).closest(\".widgetContents\").find('.dateRange').show('fast', function() {\n\n\t\t\t});\t\n\t\t}\n\t\t\n\t}\n\telse {\n\t\t$(this).closest(\".widgetContents\").find('.startLabel').text(\"Date\");\n\t\tif(!(window.mozInnerScreenX == null)) {\n\t\t\t$(this).closest(\".widgetContents\").find('.dateRange').hide();\n\t\t}\n\t\telse {\n\t\t\t$(this).closest(\".widgetContents\").find('.dateRange').hide('fast', function() {\n\n\t\t\t});\n\t\t}\n\t\t\n\t}\n\n}\n\nfunction parseDateString(dateString, event) {\n\tif(dateString.length > 0) {\n\t\tif(Date.create(dateString).isValid()) {\n\t\t\tvar dateNumeric = Date.utc.create(dateString).getTime()/1000;\n\t\t\tif(event) {\n\t\t\t\t$(event.target).siblings('.dateHidden').val(dateNumeric);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\tif(dateString.toLowerCase().indexOf('bc') != -1) {\n\t\t\t\tdateString = dateString.replace(/,/g, '');\n\t\t\t\tvar pattern = /[0-9]+/g;\n\t\t\t\tvar matches = dateString.match(pattern);\n\t\t\t\tif(matches.length>0) {\n\t\t\t\t\tvar yearsAgo = matches[0];\n\t\t\t\t\tif(dateString.toLowerCase().indexOf('century') != -1) {\n\t\t\t\t\t\tyearsAgo = yearsAgo * 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar bceDate = (-1 * yearsAgo * 31556952) - (1970*31556952); // seconds in a year\n\t\t\t\t\tif(event) {\n\t\t\t\t\t\t$(event.target).siblings('.dateHidden').val(bceDate);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t//TODO: make this trigger parse error instead!\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\t$(event.target).siblings('.dateHidden').val(\"\");\n\t}\n}\n\nfunction parseDate(event) {\n\tvar dateString = $(this).val();\n\tparseDateString(dateString, event);\n}\n\n$(document).ready(function() {\n\t$(document).on( \"change\", \".rangeModify\", modifyRange );\n\t$( \".rangeModify\" ).trigger( \"change\" );\n\t$(document).on(\"change\", \".dateText\", parseDate);\n});\n","$.mapGetScript = function(url, callback, cache){\n\treturn $.ajax({\n\t\ttype: \"GET\",\n\t\turl: url,\n\t\tsuccess: callback,\n\t\tdataType: \"script\",\n\t\tcache: false,\n\t\tasync: false\n\t});\n};\n\n\n$(document).ready(function() {\n  /**\n   * don't load the map js stuff until we need the advancedSearch modal\n   * @param  {[type]} e [description]\n   * @return {[type]}   [description]\n   */\n  $(\"#advancedSearchModal\").on(\"show.bs.modal\" ,function(e) {\n    if(!jQuery().goMap) {\n      var doc_write = document.write; // Remember original method;\n      document.write = function(s) {$(s).appendTo('body');};\n      $.mapGetScript(\"http://maps.google.com/maps/api/js?sensor=false\").done(function() {\n        setTimeout(function() {\n          document.write = doc_write;\n          $.mapGetScript(\"/assets/js/jquery.gomap-1.3.2.js\", function(){}, true);\n          $.mapGetScript(\"/assets/js/markerclusterer.js\", function(){}, true);\n          $.mapGetScript(\"/assets/js/mapWidget.js\", function(){}, true);\n        }, 300);\n      });\n    }\n  });\n  $(\"#advancedSearchModal\").on(\"shown.bs.modal\", function(e) {\n    $(\".advancedSearchText\").val($(\".searchText\").val());\n  });\n\n\n\n});\n\n\nvar cachedWidth = 0;\nvar navbarToTopHeight = 0;\nvar navbarHeight = 0;\n\n function scrollManage() {\n  if(document.documentElement.clientWidth == cachedWidth) {\n    return;\n  }\n  cachedWidth = document.documentElement.clientWidth;\n  if(!$('.navbar').length) {\n    return;\n  }\n    navbarToTopHeight = $('.navbar').offset().top - parseFloat($('.navbar').css('margin-top').replace(/auto/, 0));\n    navbarHeight = $('.navbar').height();\n   var _height = $('.navbar').height();\n   if(navbarToTopHeight === 0) {\n\n    if(document.documentElement.clientWidth > 768) {\n      $('.mainContent').css('padding-top', 20 + parseInt($('.navbar').css('height')));\n    }\n    else {\n       $('.mainContent').css('padding-top', 0);\n    }\n        $('.navbar').addClass('navbar-fixed-top');\n  }\n  else {\n   $(window).scroll(function(event) {\n    var y = $(this).scrollTop();\n    var z = $('.footer').offset().top;\n\n    if(z > $( document ).height()) {\n      return;\n    }\n    if (y >= navbarToTopHeight && (y+_height) < z) {\n\n      if(document.documentElement.clientWidth > 768) {\n        $('.mainContent').css('padding-top', parseInt($('.navbar').css('height')) + 20);\n      }\n      else {\n         $('.mainContent').css('padding-top', 0);\n      }\n      $('.navbar').addClass('navbar-fixed-top');\n    } else {\n\n      if(document.documentElement.clientWidth > 768) {\n        $('.mainContent').css('padding-top', 0);\n      }\n      $('.navbar').removeClass('navbar-fixed-top');\n    }\n  });\n  }\n}\n\n// handle sticky header regardless of header size.\n$(window).load(function() {\n  scrollManage();\n});\n\n\n$(window).resize(function() {\n  scrollManage();\n});\n\n// command-control-h reveals hidden content (anything flagged advancedContent)\nMousetrap.bind('command+ctrl+h', function() {\n  $(\".advancedContent\").toggle();\n});\n\n$(\".collectionFilterSelect\").on(\"click\", function(e) {\n\n  e.preventDefault();\n\n  targetItem = $(this).data(\"collection-id\");\n\n  $(\"#collection\").val(targetItem);\n  $(\"#search_concept\").text($(this).text());\n});\n\n"]}