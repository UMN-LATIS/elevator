{"version":3,"sources":["assetView.js","drawers.js"],"names":["nextResultLink","targetId","window","location","basePath","loadEmbedViewPointer","targetObjectId","$","data","targetAsset","document","find","length","first","hasClass","trigger","ajaxPrefilter","options","originalOptions","jqXHR","dataType","cache","Mousetrap","bind","closest","prev","next","on","registerHandlers","loadLastSearch","fullscreen","isNativelySupported","append","slicePoint","slicePointDefault","expander","hash","nestedObjectId","replace","searchId","post","objectId","textStatus","xhr","json","parseJSON","haveSelectedTarget","each","index","element","resize","resizeElement","loadView","e","this","removeClass","addClass","loadRelatedList","stopPropagation","undefined","loadMapModal","select","parent","children","toggle","loadExif","loadMoreLikeThis","is","target","has","popover","cookie","path","maxHeight","ratio","isNaN","targetHeight","width","height","originalEvent","preventDefault","fileObjectId","needLoadNestedView","parentObject","get","html","el","y","scrollTop","offset","top","animate","lazyElements","lazyInstance","addItems","update","setTimeout","loadedCallback","targetElement","parentObjectId","parents","eq","fileObject","Handlebars","registerHelper","item","fn","inverse","getJSON","baseDiv","exif","registerPartial","source","template","compile","bootbox","dialog","title","message","buttons","success","label","className","latitude","relatedTarget","longitude","loadMap","markers","clearLayers","L","layerGroup","map","setView","localMarker","marker","addLayer","attr","image","searchRequest","searchText","suppressRecent","searchRelated","searchQuery","JSON","stringify","foundRelated","jsonObject","empty","matches","value","base_url","resultCount","fail","readyState","alert","triggerClose","css","event","key","ready","postData","serializeArray","formURL","push","name","excerptId","cachedResults","searchResults","ajax","url","type","modal","error","errorThrown","console","log","newDrawer","drawerId","parseInt","drawerTitle","val","fadeIn","fadeOut"],"mappings":"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","file":"assetMaster.min.js","sourcesContent":["\n// disable cache-busted of embedded JS by jquery\n$.ajaxPrefilter(function( options, originalOptions, jqXHR ) {\n  if ( options.dataType == 'script' || originalOptions.dataType == 'script' ) {\n      options.cache = true;\n  }\n});\n\n\nMousetrap.bind('left', function () {\n\t$(\".relatedThumbHighlight\").closest(\".col-sm-2\").prev().find(\"img\").trigger(\"click\");\n});\n\nMousetrap.bind('right', function () {\n\t$(\".relatedThumbHighlight\").closest(\".col-sm-2\").next().find(\"img\").trigger(\"click\");\n});\n\n\n// handle \"next\" and \"previous\" while browsing results\nfunction nextResultLink(targetId) {\n\twindow.location = basePath + \"asset/viewAsset/\" + targetId;\n}\n\n$(document).on(\"ready\", function() {\n\tregisterHandlers();\n\t// registered in template.js\n\tloadLastSearch();\n\n\t// if we don't support fullscreen, hide hte button entirely\n\tif(!$.fullscreen.isNativelySupported()) {\n\t\t$(\"head\").append('<style> .canFullscreen { display: none;</style>');\n\t}\n\n\tslicePoint = 400;\n\tif(typeof slicePointDefault !== 'undefined') {\n\t\tslicePoint = slicePointDefault;\n\t}\n\t$(\".textareaView li div\").expander({\n\t\tslicePoint: slicePoint\n\t});\n\n\t// if they came in with a hash, let's find and load that asset.\n\tif(window.location.hash) {\n\t\tnestedObjectId = window.location.hash.replace(\"#\",\"\");\n\t\tvar targetAsset = $(document).find('[data-fileobjectid=\"' + nestedObjectId + '\"]');\n\t\tif(targetAsset.length>0) {\n\n\t\t}\n\t\telse { // maybe it's a related asset, try that\n\t\t\ttargetAsset = $(document).find('[data-objectid=\"' + nestedObjectId + '\"]').find(\".loadView\");\n\t\t}\n\n\t\tif(targetAsset.length>0) {\n\t\t\t$(targetAsset).trigger(\"click\");\n\t\t}\n\t\telse {\n\t\t\t// load a default element\n\t\t\tloadEmbedViewPointer();\n\t\t}\n\n\t}\n\telse if(searchId && $(\".rightColumn\").find(\".uploadContent\").length == 0 && $(\".rightColumn\").find(\".loadView\").length>1) {\n\t\t// we have multiple subviews, let's ask the search engine if there's one we should highlight\n\t\t$.post(basePath + \"search/getHighlight\", {searchId: searchId, objectId: objectId}, function(data, textStatus, xhr) {\n\t\t\tvar json = $.parseJSON(data);\n\n\t\t\tvar targetAsset = null;\n\t\t\tvar haveSelectedTarget = false;\n\t\t\t$.each(json, function(index, element) {\n\t\t\t\tif(element != $(\"#embedView\").data(\"objectid\")) {\n\t\t\t\t\ttargetAsset = $(document).find('[data-fileobjectid=\"' + element + '\"]');\n\t\t\t\t\tif(targetAsset.length>0) {\n\n\t\t\t\t\t}\n\t\t\t\t\telse { // maybe it's a related asset, try that\n\t\t\t\t\t\ttargetAsset = $(document).find('[data-objectid=\"' + element + '\"]').find(\".loadView\");\n\t\t\t\t\t}\n\t\t\t\t\tif(targetAsset.length>0) {\n\t\t\t\t\t\t$(targetAsset).trigger(\"click\");\n\t\t\t\t\t\thaveSelectedTarget = true;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\tif(!haveSelectedTarget) {\n\t\t\t\t// just load a default\n\t\t\t\tloadEmbedViewPointer();\n\t\t\t}\n\n\t\t});\n\t}\n\telse {\n\t\tloadEmbedViewPointer();\n\t}\n});\n\n\nfunction loadEmbedViewPointer() {\n\n\ttargetObjectId = $(\"#embedView\").data(\"objectid\");\n\tvar targetAsset = $(document).find('[data-fileobjectid=\"' + targetObjectId + '\"]');\n\tif(targetAsset.length>0) {\n\n\t}\n\telse { // maybe it's a related asset, try that\n\t\ttargetAsset = $(document).find('[data-objectid=\"' + targetObjectId + '\"]').find(\".loadView\");\n\t}\n\n\tif(targetAsset.length > 1) {\n\t\ttargetAsset = targetAsset.first();\n\t}\n\tif ($(targetAsset).hasClass('ignoreForDigitalAsset')) {\n\n\t}\n\telse {\n\t\t$(targetAsset).trigger(\"click\");\n\t}\n\n\n}\n\n\nvar registerHandlers = function() {\n\t$(window).resize(resizeElement);\n\n\t/**\n\t * Metadata Handlers\n\t */\n\n\t$(document).on(\"click\", \".loadView\", loadView);\n\n\t// flip chevrons for related asset\n\t$(document).on(\"hide.bs.collapse\", \".relatedListToggle\", function (e) {\n\t\t$(this).find(\".expandRelated\").removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');\n\t});\n\t// load related asset\n\t$(document).on(\"show.bs.collapse\", \".relatedListToggle\", loadRelatedList);\n\n\t// update hash when loading a related asset\n\t$(document).on(\"click\", \".relatedThumbContainer\", function(e) {\n\t\te.stopPropagation();\n\t\tvar nestedObjectId = $(this).data(\"objectid\");\n\t\tif(nestedObjectId !== undefined) {\n\t\t\twindow.location.hash = nestedObjectId;\n\t\t}\n\t\telse {\n\t\t\tnestedObjectId = $(this).data(\"fileobjectid\");\n\t\t\tif(nestedObjectId !== undefined) {\n\t\t\t\twindow.location.hash = nestedObjectId;\n\t\t\t}\n\t\t}\n\t});\n\n\t$(\"#mapModal\").on(\"shown.bs.modal\", loadMapModal);\n\n\t/**\n\t * Digital Asset Handlers\n\t */\n\t$(document).on(\"click\", \".embedControl\", function () {\n\t\t$(this).select();\n\t});\n\n\t$(document).on(\"click\", \".showDetails\", function () {\n\t\t$(this).parent().parent().children('.assetDetails').toggle(\"fast\");\n\t});\n\n\t$(document).on(\"click\", \".exifToggle\", loadExif);\n\n\t/**\n\t * Page Level Handlers\n\t */\n\n\t// flip chevron on 'more like this' accordion\n \t$('#relatedAccordian').on('hide.bs.collapse', function (e) {\n\t\t$(this).find(\".expandRelated\").removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');\n\t});\n\t\n\t$('#relatedAccordian').on('show.bs.collapse', loadMoreLikeThis);\n\n\t// hide popovers when you click elsehwere on the page\n\t$('body').on('click', function (e) {\n\t\t$('[data-toggle=\"popover\"]').each(function () {\n\t\t\t//the 'is' for buttons that trigger popups\n\t\t\t//the 'has' for icons within a button that triggers a popup\n\t\t\tif (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {\n\t\t\t\t$(this).popover('hide');\n\t\t\t}\n\t\t});\n\t});\n\n\t// reset the last search on edit so we can do forward/next in that case too\n\t$(document).on(\"click\", \".editAssetLink\", function (e) {\n\t\t$.cookie('lastSearch', searchId, {\n\t\t\tpath: \"/\"\n\t\t});\n\t});\n};\n\n\n/**\n * Digital Asset Methods\n */\n\n\nvar resizeElement = function(maxHeight) {\n\tvar ratio = $(\".embedAsset\").data(\"ratio\");\n\tif (!maxHeight) {\n\t\tmaxHeight = 0.7;\n\t}\n\tif(isNaN(ratio)) {\n\t\tratio = 1;\n\t}\n\tif(ratio) {\n\t\ttargetHeight = $(\".embedAsset\").width() / ratio;\n\t\tif (targetHeight > $(window).height() * maxHeight) {\n\t\t\ttargetHeight = $(window).height() * maxHeight;\n\t\t}\n\t\t$(\".embedAsset\").height(targetHeight);\n\t}\n};\n\n/**\n * Metadata Methods\n */\n\n\n// main handler for loading assets\nvar loadView = function (e) {\n\tif (e.originalEvent === undefined) {\n\t\te.preventDefault();\n\t}\n\tfileObjectId = $(this).data(\"fileobjectid\");\n\n\tvar parent = $(this).closest(\"[data-objectid]\");\n\n\tvar needLoadNestedView = false;\n\n\tif (parent.length > 0 && (!parent.hasClass('objectIdHost') || (parent.hasClass('objectIdHost') && parent.hasClass('sidebarContainer')))) {\n\t\t// we're within a nested asset, rather than a straight thumbnail, let's also load the content for that.\n\t\t// if we've been loaded in the left column, as a nested view, we want to make sure we load both the view and reload the metadata, which is why\n\t\t// we check for the sdiebar container\n\t\tparentObject = parent.data(\"objectid\");\n\t\tneedLoadNestedView = true;\n\t}\n\telse {\n\t\tparentObject = $(this).closest(\".objectIdHost\").data(\"objectid\");\n\t}\n\n\t// we pass in the page's objectId so that assets inside drawers load properly.\n\n\tif(!fileObjectId || fileObjectId.length < 10) {\n\t\treturn;\n\t}\n\n\t$.get(basePath + \"asset/getEmbedWithChrome/\" + fileObjectId + \"/\" + objectId, function (data) {\n\t\t$(\"#embedView\").html(data);\n\t\t$(\"#embedView\").data(\"objectid\", fileObjectId);\n\n\t\t$(document).find(\".relatedThumbHighlight\").removeClass(\"relatedThumbHighlight\");\n\t\tif ($(\".rightColumn\").find('[data-fileobjectid]').length > 1) {\n\t\t\tvar parentContainer = $(document).find('[data-fileobjectid=\"' + fileObjectId + '\"]').parent();\n\t\t\tparentContainer.each(function (index, el) {\n\t\t\t\tif ($(el).is('div')) {\n\t\t\t\t\t$(el).addClass(\"relatedThumbHighlight\");\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tvar y = $(window).scrollTop();\n\t\tvar z = $('#embedView').offset().top + 400;\n\t\tif (y > z) {\n\t\t\t$(\"html, body\").animate({ scrollTop: 0 }, \"fast\");\n\t\t}\n\n\t\tlazyElements = $(\"#embedView\").find(\".lazy\");\n\t\tlazyInstance.addItems(lazyElements);\n\t\tlazyInstance.update();\n\n\t\tif (needLoadNestedView) {\n\t\t\t// delay loading the asest by 50ms to avoid session concurrency issue with the server\n\t\t\tsetTimeout(function() {\n\t\t\t\t$.get(basePath + \"asset/viewAssetMetadataOnly/\" + objectId + \"/\" + parentObject, function (data) {\n\t\t\t\t\t$(\"#embedView\").append(data);\n\t\t\t\t\tlazyElements = $(\"#embedView\").find(\".lazy\");\n\t\t\t\t\tlazyInstance.addItems(lazyElements);\n\t\t\t\t\tlazyInstance.update();\n\t\t\t\t});\n\t\t\t}, 100);\n\t\t\t\n\t\t}\n\t\tlazyInstance.update();\n\n\t\tif (typeof loadedCallback == 'function') {\n\t\t\tloadedCallback();\n\t\t}\n\t});\n};\n\n\nvar loadRelatedList = function (e) {\n\te.stopPropagation();\n\tvar nestedObjectId = $(this).data(\"objectid\");\n\tvar targetElement = this;\n\t$(this).find(\".expandRelated\").removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');\n\n\tif ($(targetElement).parents(\".relatedAssetContainer\").length > 0) {\n\t\tparentObjectId = $(targetElement).parents(\".relatedAssetContainer\").eq(0).data(\"objectid\");\n\t}\n\telse {\n\t\tparentObjectId = $(this).closest(\".objectIdHost\").data(\"objectid\");\n\t}\n\n\t$.get(basePath + \"asset/viewAssetMetadataOnly/\" + parentObjectId + \"/\" + nestedObjectId, function (data) {\n\t\t$(targetElement).find('.relatedAssetContents').html(data);\n\t\tlazyElements = $(targetElement).find('.relatedAssetContents').find(\".lazy\");\n\t\tlazyInstance.addItems(lazyElements);\n\t\tlazyInstance.update();\n\t});\n};\n\n\n// show Exif data for images\nvar loadExif = function (e) {\n\te.preventDefault();\n\tvar fileObject = $(e.target).data(\"fileobject\");\n\tHandlebars.registerHelper('ifObject', function (item, options) {\n\t\tif (typeof item === \"object\") {\n\t\t\treturn options.fn(this);\n\t\t} else {\n\t\t\treturn options.inverse(this);\n\t\t}\n\t});\n\t$.getJSON(basePath + 'fileManager/getMetadataForObject/' + fileObject, {}, function (json, textStatus) {\n\t\tif (json.exif) {\n\t\t\tHandlebars.registerPartial(\"exif-template\", $(\"#exif-template\").html());\n\t\t\tvar source = $(\"#exif-template\").html();\n\t\t\tvar template = Handlebars.compile(source);\n\t\t\tvar baseDiv = $(\"<div class='exifDisplay' />\");\n\t\t\t// $.each(, function(index, value) {\n\t\t\tvar html = template(json.exif);\n\t\t\tbaseDiv.append(html);\n\t\t\t// });\n\n\t\t\tbootbox.dialog(\n\t\t\t\t{\n\t\t\t\t\ttitle: \"EXIF Data\",\n\t\t\t\t\tmessage: baseDiv.html(),\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tsuccess: {\n\t\t\t\t\t\t\tlabel: \"OK\",\n\t\t\t\t\t\t\tclassName: \"btn-primary\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t});\n};\n\n\n// load map modal\nvar loadMapModal = function (e) {\n\tvar latitude = $(e.relatedTarget).data(\"latitude\");\n\tvar longitude = $(e.relatedTarget).data(\"longitude\");\n\tvar label = $(e.relatedTarget).html();\n\n\t$(\"#mapModalLabel\").html(label);\n\n\tloadMap(\"mapModalContainer\");\n\t\n\tif (markers[\"mapModalContainer\"]) {\n\t\tmarkers[\"mapModalContainer\"].clearLayers();\n\t}\n\telse {\n\t\tmarkers[\"mapModalContainer\"] = new L.layerGroup();\n\t}\n\n\tmap[\"mapModalContainer\"].setView([latitude, longitude], 10);\n\n\n\tif (!markers) {\n\t\tmarkers[\"mapModalContainer\"] = new L.layerGroup();\n\t}\n\tlocalMarker = L.marker([latitude, longitude]);\n\tmarkers[\"mapModalContainer\"].addLayer(localMarker);\n\tmap[\"mapModalContainer\"].addLayer(markers[\"mapModalContainer\"]);\n\n\n\t$(\"#mapNearby\").attr(\"href\", basePath + \"search/nearbyAssets/\" + latitude + \"/\" + longitude);\n\n\treturn false;\n};\n\n\n\n\n\n/**\n * Document level listeners\n */\n\n// use the 2x image for mouseovers\n$(document).on(\"mouseover\", \".relatedThumbToggle\", function () {\n\tvar image = $(this).find(\".relatedThumbContainerImage\");\n\t$(image).data(\"oldURL\", $(image).attr(\"src\"));\n\tvar data = $(image).data(\"hover\");\n\t$(image).attr(\"src\", data);\n\n});\n\n// hide the 2x image\n$(document).on(\"mouseout\", \".relatedThumbToggle\", function () {\n\tvar image = $(this).find(\".relatedThumbContainerImage\");\n\tvar data = $(image).data(\"oldURL\");\n\t$(image).attr(\"src\", data);\n\n});\n\n\n/**\n * Page level methods\n */\n\nvar loadMoreLikeThis = function (e) {\n\t$(this).find(\".expandRelated\").removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');\n\tvar searchRequest = { \"searchText\": objectId};\n\n\t// get related results via search\n\t$.post( basePath + \"search/searchResults/\", {\"suppressRecent\": true, \"searchRelated\": true, searchQuery:JSON.stringify(searchRequest)}, function( data ) {\n\t\tconst jsonObject = data;\n\n\t\tif(jsonObject.success === true) {\n\n\t\t\t$(\"#relatedAssets\").empty();\n\t\t\tvar source   = $(\"#result-template\").html();\n\t\t\tvar template = Handlebars.compile(source);\n\t\t\tvar foundRelated = false;\n\t\t\tvar resultCount = 0;\n\t\t\t$.each(jsonObject.matches, function(index, value) {\n\t\t\t\tif(value.objectId != objectId) {\n\t\t\t\t\tvalue.base_url = basePath;\n\t\t\t\t\tvar html    = template(value);\n\t\t\t\t\t$(\"#relatedAssets\").append(html);\n\t\t\t\t\tfoundRelated = true;\n\t\t\t\t\tresultCount++;\n\t\t\t\t}\n\n\t\t\t});\n\t\t\tif(!foundRelated) {\n\t\t\t\t$(\"#relatedAssets\").append(\"<p>No Related Assets Found</p>\");\n\t\t\t}\n\t\t}\n\t}).fail(function (e) {\n\t\tif (e.readyState > 0) {\n\t\t\talert(JSON.stringify(e));\n\t\t}\n\n\t});\n};\n\n\n\n// Lightbox code\n\n$(document).on(\"click\", \".triggerLightbox\", function() {\n\t$(\".embedAsset\").addClass(\"lightboxAsset\");\n\t\n\t$(\".lightboxContainer\").css(\"display\",\"block\");\n\tresizeElement(\"0.9\");\n});\n\n$(document).on(\"click\", \".lightboxCloseButton\", function() { triggerClose() });\n$(document).on(\"click\", \".lightboxContainer\", function () {\n\ttriggerClose();\n});\n$(document).on('keydown', function (event) {\n\t\tif (event.key == \"Escape\") { \n\t\t\ttriggerClose();\n\t\t}\n});\nvar triggerClose = function() {\n\n\t$(\".lightboxContainer\").css(\"display\", \"none\");\n\t$(\".embedAsset\").removeClass(\"lightboxAsset\");\n\tresizeElement(\"0.7\");\n}","\n$(document).ready(function () {\n\n\t$(\"#addToDrawer\").on(\"submit\", function(e) {\n\n\t\te.preventDefault(); //STOP default action\n\t\tvar postData = $(this).serializeArray();\n\t\tif($(\"#drawerList\").find(\":selected\").length == 0) {\n\t\t\talert(\"You must create a drawer first\");\n\t\t}\n\t\tif(typeof(excerptId) != 'undefined') {\n\t\t\tpostData.push({name: 'excerptId', value: excerptId});\n\t\t}\n\n\t\tif(typeof(objectId) != 'undefined') {\n\t\t\tpostData.push({name: 'objectId', value: objectId});\n\t\t}\n\n\t\tif(typeof(cachedResults) != \"undefined\") {\n\t\t\tpostData.push({name: 'objectArray', value: JSON.stringify(cachedResults.searchResults)});\n\t\t}\n\n\t\tvar formURL = $(this).attr(\"action\");\n\t\t$.ajax({\n\t\t\turl : formURL,\n\t\t\ttype: \"POST\",\n\t\t\tdata : postData,\n\t\t\tsuccess:function(data, textStatus, jqXHR)\n\t\t\t{\n\t\t\t\t$(\"#drawerModal\").modal('toggle');\n\t\t\t},\n\t\t\terror: function(jqXHR, textStatus, errorThrown)\n\t\t\t{\n\t\t\t\tconsole.log(\"Error adding Drawer\");\n\t\t\t}\n\t\t});\n\n\n\n\t});\n\n\t$(\"#addNewDrawer\").on(\"submit\", function(e) {\n\t\tvar postData = $(this).serializeArray();\n\t\tvar formURL = $(this).attr(\"action\");\n\t\t$.ajax({\n\t\t\turl : formURL,\n\t\t\ttype: \"POST\",\n\t\t\tdata : postData,\n\t\t\tsuccess:function(newDrawer, textStatus, jqXHR)\n\t\t\t{\n\t\t\t\tvar drawerId = parseInt(newDrawer.drawerId,10);\n\t\t\t\t$(\"#drawerList\").append(\"<option value='\" + drawerId + \"'>\" + newDrawer.drawerTitle + \"</option>\");\n\n\t\t\t\t$('#drawerList').val(drawerId);\n\t\t\t\t$(\".drawerAddedSuccess\").fadeIn('400');\n\t\t\t\twindow.setTimeout(function() { $(\".drawerAddedSuccess\").fadeOut('400'); }, 2000);\n\t\t\t},\n\t\t\terror: function(jqXHR, textStatus, errorThrown)\n\t\t\t{\n\t\t\t\tconsole.log(\"Error adding Drawer\");\n\t\t\t}\n\t\t});\n\t\te.preventDefault(); //STOP default action\n\t});\n\n});\n"]}