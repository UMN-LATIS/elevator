function nextResultLink(e){window.location=basePath+"asset/viewAsset/"+e}function loadEmbedViewPointer(){targetObjectId=$("#embedView").data("objectid");var e=$(document).find('[data-fileobjectid="'+targetObjectId+'"]');e.length>0||(e=$(document).find('[data-objectid="'+targetObjectId+'"]').find(".loadView")),e.length>1&&(e=e.first()),$(e).hasClass("ignoreForDigitalAsset")||$(e).trigger("click")}$.ajaxPrefilter((function(e,t,a){"script"!=e.dataType&&"script"!=t.dataType||(e.cache=!0)})),Mousetrap.bind("left",(function(){$(".relatedThumbHighlight").closest(".col-sm-2").prev().find("img").trigger("click")})),Mousetrap.bind("right",(function(){$(".relatedThumbHighlight").closest(".col-sm-2").next().find("img").trigger("click")})),$(document).on("ready",(function(){if(registerHandlers(),loadLastSearch(),$.fullscreen.isNativelySupported()||$("head").append("<style> .canFullscreen { display: none;</style>"),slicePoint=400,"undefined"!=typeof slicePointDefault&&(slicePoint=slicePointDefault),$(".textareaView li div").expander({slicePoint:slicePoint}),window.location.hash){nestedObjectId=window.location.hash.replace("#","");var e=$(document).find('[data-fileobjectid="'+nestedObjectId+'"]');e.length>0||(e=$(document).find('[data-objectid="'+nestedObjectId+'"]').find(".loadView")),e.length>0?$(e).trigger("click"):loadEmbedViewPointer()}else searchId&&0==$(".rightColumn").find(".uploadContent").length&&$(".rightColumn").find(".loadView").length>1?$.post(basePath+"search/getHighlight",{searchId:searchId,objectId:objectId},(function(e,t,a){var n=$.parseJSON(e),i=null,o=!1;$.each(n,(function(e,t){if(t!=$("#embedView").data("objectid")&&((i=$(document).find('[data-fileobjectid="'+t+'"]')).length>0||(i=$(document).find('[data-objectid="'+t+'"]').find(".loadView")),i.length>0))return $(i).trigger("click"),o=!0,!1})),o||loadEmbedViewPointer()})):loadEmbedViewPointer()}));var registerHandlers=function(){$(window).resize(resizeElement),$(document).on("click",".loadView",loadView),$(document).on("hide.bs.collapse",".relatedListToggle",(function(e){$(this).find(".expandRelated").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down")})),$(document).on("show.bs.collapse",".relatedListToggle",loadRelatedList),$(document).on("click",".relatedThumbContainer",(function(e){e.stopPropagation();var t=$(this).data("objectid");(void 0!==t||void 0!==(t=$(this).data("fileobjectid")))&&(window.location.hash=t)})),$("#mapModal").on("shown.bs.modal",loadMapModal),$(document).on("click",".embedControl",(function(){$(this).select()})),$(document).on("click",".showDetails",(function(){$(this).parent().parent().children(".assetDetails").toggle("fast")})),$(document).on("click",".exifToggle",loadExif),$("#relatedAccordian").on("hide.bs.collapse",(function(e){$(this).find(".expandRelated").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down")})),$("#relatedAccordian").on("show.bs.collapse",loadMoreLikeThis),$("body").on("click",(function(e){$('[data-toggle="popover"]').each((function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$(".popover").has(e.target).length||$(this).popover("hide")}))})),$(document).on("click",".editAssetLink",(function(e){$.cookie("lastSearch",searchId,{path:"/"})}))},resizeElement=function(e){var t=$(".embedAsset").data("ratio");e||(e=.7),isNaN(t)&&(t=1),t&&(targetHeight=$(".embedAsset").width()/t,targetHeight>$(window).height()*e&&(targetHeight=$(window).height()*e),$(".embedAsset").height(targetHeight))},loadView=function(e){void 0===e.originalEvent&&e.preventDefault(),fileObjectId=$(this).data("fileobjectid");var t=$(this).closest("[data-objectid]"),a=!1;t.length>0&&(!t.hasClass("objectIdHost")||t.hasClass("objectIdHost")&&t.hasClass("sidebarContainer"))?(parentObject=t.data("objectid"),a=!0):parentObject=$(this).closest(".objectIdHost").data("objectid"),!fileObjectId||fileObjectId.length<10||$.get(basePath+"asset/getEmbedWithChrome/"+fileObjectId+"/"+objectId,(function(e){($("#embedView").html(e),$("#embedView").data("objectid",fileObjectId),$(document).find(".relatedThumbHighlight").removeClass("relatedThumbHighlight"),$(".rightColumn").find("[data-fileobjectid]").length>1)&&$(document).find('[data-fileobjectid="'+fileObjectId+'"]').parent().each((function(e,t){$(t).is("div")&&$(t).addClass("relatedThumbHighlight")}));$(window).scrollTop()>$("#embedView").offset().top+400&&$("html, body").animate({scrollTop:0},"fast"),lazyElements=$("#embedView").find(".lazy"),lazyInstance.addItems(lazyElements),lazyInstance.update(),a&&setTimeout((function(){$.get(basePath+"asset/viewAssetMetadataOnly/"+objectId+"/"+parentObject,(function(e){$("#embedView").append(e),lazyElements=$("#embedView").find(".lazy"),lazyInstance.addItems(lazyElements),lazyInstance.update()}))}),100),lazyInstance.update(),"function"==typeof loadedCallback&&loadedCallback()}))},loadRelatedList=function(e){e.stopPropagation();var t=$(this).data("objectid"),a=this;$(this).find(".expandRelated").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up"),$(a).parents(".relatedAssetContainer").length>0?parentObjectId=$(a).parents(".relatedAssetContainer").eq(0).data("objectid"):parentObjectId=$(this).closest(".objectIdHost").data("objectid"),$.get(basePath+"asset/viewAssetMetadataOnly/"+parentObjectId+"/"+t,(function(e){$(a).find(".relatedAssetContents").html(e),lazyElements=$(a).find(".relatedAssetContents").find(".lazy"),lazyInstance.addItems(lazyElements),lazyInstance.update()}))},loadExif=function(e){e.preventDefault();var t=$(e.target).data("fileobject");Handlebars.registerHelper("ifObject",(function(e,t){return"object"==typeof e?t.fn(this):t.inverse(this)})),$.getJSON(basePath+"fileManager/getMetadataForObject/"+t,{},(function(e,t){if(e.exif){Handlebars.registerPartial("exif-template",$("#exif-template").html());var a=$("#exif-template").html(),n=Handlebars.compile(a),i=$("<div class='exifDisplay' />"),o=n(e.exif);i.append(o),bootbox.dialog({title:"EXIF Data",message:i.html(),buttons:{success:{label:"OK",className:"btn-primary"}}})}}))},loadMapModal=function(e){var t=$(e.relatedTarget).data("latitude"),a=$(e.relatedTarget).data("longitude"),n=$(e.relatedTarget).html();return $("#mapModalLabel").html(n),loadMap("mapModalContainer"),markers.mapModalContainer?markers.mapModalContainer.clearLayers():markers.mapModalContainer=new L.layerGroup,map.mapModalContainer.setView([t,a],10),markers||(markers.mapModalContainer=new L.layerGroup),localMarker=L.marker([t,a]),markers.mapModalContainer.addLayer(localMarker),map.mapModalContainer.addLayer(markers.mapModalContainer),$("#mapNearby").attr("href",basePath+"search/nearbyAssets/"+t+"/"+a),!1};$(document).on("mouseover",".relatedThumbToggle",(function(){var e=$(this).find(".relatedThumbContainerImage");$(e).data("oldURL",$(e).attr("src"));var t=$(e).data("hover");$(e).attr("src",t)})),$(document).on("mouseout",".relatedThumbToggle",(function(){var e=$(this).find(".relatedThumbContainerImage"),t=$(e).data("oldURL");$(e).attr("src",t)}));var loadMoreLikeThis=function(e){$(this).find(".expandRelated").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up");var t={searchText:objectId};$.post(basePath+"search/searchResults/",{suppressRecent:!0,searchRelated:!0,searchQuery:JSON.stringify(t)},(function(e){try{jsonObject=$.parseJSON(e)}catch(t){return void alert(t+" "+e)}if(!0===jsonObject.success){$("#relatedAssets").empty();var t=$("#result-template").html(),a=Handlebars.compile(t),n=!1;$.each(jsonObject.matches,(function(e,t){if(t.objectId!=objectId){t.base_url=basePath;var i=a(t);$("#relatedAssets").append(i),n=!0}})),n||$("#relatedAssets").append("<p>No Related Assets Found</p>")}}))};$(document).on("click",".triggerLightbox",(function(){$(".embedAsset").addClass("lightboxAsset"),$(".lightboxContainer").css("display","block"),resizeElement("0.9")})),$(document).on("click",".lightboxCloseButton",(function(){triggerClose()})),$(document).on("click",".lightboxContainer",(function(){triggerClose()})),$(document).on("keydown",(function(e){"Escape"==e.key&&triggerClose()}));var triggerClose=function(){$(".lightboxContainer").css("display","none"),$(".embedAsset").removeClass("lightboxAsset"),resizeElement("0.7")};
//# sourceMappingURL=assetView.min.js.map
