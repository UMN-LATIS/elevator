{"version":3,"file":"loadDrawer.min.js","sources":["loadDrawer.js"],"sourcesContent":["var targetTemplate = \"#drawer-template\";\nvar listTemplate = \"#drawer-list-template\";\n\nfunction getDrawer() {\n\tvar url = window.location.href.replace(window.location.hash,\"\");\n\tvar drawerId = url.substring(url.lastIndexOf('/') + 1);\n\treturn drawerId;\n}\n\n$(document).on(\"click\", \".removeButton\",function () {\n\tdrawerId= getDrawer();\n\tif($(this).data(\"assettype\") == \"excerpt\") {\n\t\t$.get(basePath+\"drawers/removeExcerpt/\"+drawerId + \"/\" + $(this).data(\"excerptid\"));\n\t}\n\telse {\n\t\t$.get(basePath+\"drawers/removeFromDrawer/\"+drawerId + \"/\" + $(this).data(\"assetid\"));\n\t}\n\t$(this).closest('.searchContainer').remove();\n\n\n});\n\n$(document).ready(function() {\n\tloadDrawer();\n\n\t$(document).off(\"change\", \".sortBy\");\n\t$(document).on(\"change\", \".sortBy\", function() {\n\t\tupdateDrawerSortAndReload();\n\t});\n\n\t\n});\n\nfunction updateDrawerSortAndReload() {\n\tdrawerSort = $(\".sortBy\").val();\n\tdrawerId = getDrawer();\n\n\t$.get(basePath + \"drawers/setSortOrder/\" + drawerId + \"/\" + drawerSort, function() {\n\t\tloadDrawer();\t\n\t});\n\t\n}\n\nfunction serializeDrawerAndUpdate() {\n\torderArray = new Array();\n\t$(\".active .searchContainer\").each(function(index, el) {\n\t\torderArray.push($(el).data(\"drawerobjectid\"));\n\t});\n\t$.post(basePath + \"drawers/setCustomOrder/\" + drawerId, { orderArray: JSON.stringify(orderArray) }, \n\t\tfunction() {\n\t\t}\n\t);\n}\n\nfunction loadDrawer() {\n\tdrawerId= getDrawer();\n    if(drawerId.length > 10) {\n\t\treturn;\n\t}\n\t$(\"#results\").empty();\n    $(\"#listResults\").empty();\n\t\n\t$.getJSON(basePath+\"drawers/getDrawer/\"+drawerId, function(data){\n\t\tcachedResults = data;\n\t\tcachedDates = null;\n\n\t\tif(cachedResults.success === true) {\n            populateSearchResults(cachedResults);\n            if($(\".sortBy\").val() == \"custom\") {\n            \t$(\"#results\").sortable({\n\t    \t\t\tupdate: function (e, ui) {\n\t    \t\t\t\tserializeDrawerAndUpdate();\n\t\t\t\t\t}\n    \t\t\t});\n    \t\t\t$(\"#listResults\").sortable({\n\t    \t\t\tupdate: function (e, ui) {\n\t    \t\t\t\tserializeDrawerAndUpdate();\n\t\t\t\t\t}\n    \t\t\t});\n            }\n            else {\n            \tif($(\"#results\").sortable( \"instance\" )) {\n            \t\t$(\"#results\").sortable( \"destroy\" );\n            \t\t$(\"#listResults\").sortable( \"destroy\" );\t\n            \t}\n            }\n            \n        }\n    });\n}\n"],"names":["targetTemplate","listTemplate","getDrawer","url","window","location","href","replace","hash","substring","lastIndexOf","updateDrawerSortAndReload","drawerSort","$","val","drawerId","get","basePath","loadDrawer","serializeDrawerAndUpdate","orderArray","Array","each","index","el","push","data","post","JSON","stringify","length","empty","getJSON","cachedResults","cachedDates","success","populateSearchResults","sortable","update","e","ui","document","on","this","closest","remove","ready","off"],"mappings":"AAAA,IAAIA,eAAiB,mBACjBC,aAAe,wBAEnB,SAASC,YACR,IAAIC,EAAMC,OAAOC,SAASC,KAAKC,QAAQH,OAAOC,SAASG,KAAK,EAAE,EAE9D,OADeL,EAAIM,UAAUN,EAAIO,YAAY,GAAG,EAAI,CAAC,CAEtD,CA0BA,SAASC,4BACRC,WAAaC,EAAE,SAAS,EAAEC,IAAI,EAC9BC,SAAWb,UAAU,EAErBW,EAAEG,IAAIC,SAAW,wBAA0BF,SAAW,IAAMH,WAAY,WACvEM,WAAW,CACZ,CAAC,CAEF,CAEA,SAASC,2BACRC,WAAa,IAAIC,MACjBR,EAAE,0BAA0B,EAAES,KAAK,SAASC,EAAOC,GAClDJ,WAAWK,KAAKZ,EAAEW,CAAE,EAAEE,KAAK,gBAAgB,CAAC,CAC7C,CAAC,EACDb,EAAEc,KAAKV,SAAW,0BAA4BF,SAAU,CAAEK,WAAYQ,KAAKC,UAAUT,UAAU,CAAE,EAChG,YAED,CACD,CAEA,SAASF,aAEgB,IADxBH,SAAUb,UAAU,GACL4B,SAGfjB,EAAE,UAAU,EAAEkB,MAAM,EACjBlB,EAAE,cAAc,EAAEkB,MAAM,EAE3BlB,EAAEmB,QAAQf,SAAS,qBAAqBF,SAAU,SAASW,GAC1DO,cAAgBP,EAGa,EAF7BQ,YAAc,QAEXD,cAAcE,UACPC,sBAAsBH,aAAa,EACV,UAAtBpB,EAAE,SAAS,EAAEC,IAAI,GACnBD,EAAE,UAAU,EAAEwB,SAAS,CAC5BC,OAAQ,SAAUC,EAAGC,GACpBrB,yBAAyB,CAC7B,CACE,CAAC,EACDN,EAAE,cAAc,EAAEwB,SAAS,CAC1BC,OAAQ,SAAUC,EAAGC,GACpBrB,yBAAyB,CAC7B,CACE,CAAC,GAGQN,EAAE,UAAU,EAAEwB,SAAU,UAAW,IACrCxB,EAAE,UAAU,EAAEwB,SAAU,SAAU,EAClCxB,EAAE,cAAc,EAAEwB,SAAU,SAAU,GAKhD,CAAC,EACL,CAhFAxB,EAAE4B,QAAQ,EAAEC,GAAG,QAAS,gBAAgB,WACvC3B,SAAUb,UAAU,EACY,WAA7BW,EAAE8B,IAAI,EAAEjB,KAAK,WAAW,EAC1Bb,EAAEG,IAAIC,SAAS,yBAAyBF,SAAW,IAAMF,EAAE8B,IAAI,EAAEjB,KAAK,WAAW,CAAC,EAGlFb,EAAEG,IAAIC,SAAS,4BAA4BF,SAAW,IAAMF,EAAE8B,IAAI,EAAEjB,KAAK,SAAS,CAAC,EAEpFb,EAAE8B,IAAI,EAAEC,QAAQ,kBAAkB,EAAEC,OAAO,CAG5C,CAAC,EAEDhC,EAAE4B,QAAQ,EAAEK,MAAM,WACjB5B,WAAW,EAEXL,EAAE4B,QAAQ,EAAEM,IAAI,SAAU,SAAS,EACnClC,EAAE4B,QAAQ,EAAEC,GAAG,SAAU,UAAW,WACnC/B,0BAA0B,CAC3B,CAAC,CAGF,CAAC"}