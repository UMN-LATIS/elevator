{"version":3,"sources":["mapWidget.js"],"names":["$","document","on","mapElement","this","find","goMap","getMarkerCount","clearMarkers","address","closest","first","val","latitudeElement","longitudeElement","options","position","geocoder","google","maps","Geocoder","geocode","results","status","GeocoderStatus","OK","geometry","location","latitude","lat","longitude","lng","marker","createMarker","draggable","fitBounds","createListener","type","id","setMap","trigger","length","mapButton","parent","html","removeData","mapTypeControl","maptype","mapTypeControlOptions","style","addMarker","e"],"mappings":"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","file":"mapWidget.js","sourcesContent":["\n$(document).on(\"click\",\".clearMarker\", function() {\n\tvar mapElement = $(this).find(\".mapWidget\");\n\tmapElement.goMap();\n\tif($.goMap.getMarkerCount()>0) {\n\t\t$.goMap.clearMarkers();\n\t}\n});\n\n\n$(document).on(\"click\",\".searchMap\", function() {\n\n\tvar address = $(this).closest(\".mapContainer\").find(\".address\").first().val();\n\tvar mapElement = $(this).closest(\".mapContainer\").find(\".mapWidget\");\n\tvar latitudeElement = $(this).closest(\".mapContainer\").find('.latitude');\n\tvar longitudeElement = $(this).closest(\".mapContainer\").find('.longitude');\n\n\tmapElement.goMap();\n\tif($.goMap.getMarkerCount()>0) {\n\t\t$.goMap.clearMarkers();\n\t}\n\n\tvar options = {\n\t\tposition: null\n\t};\n\t// TODO: check query limit\n\tvar geocoder = new google.maps.Geocoder();\n\n\tgeocoder.geocode({'address': address}, function(results, status) {\n\t\tif (status == google.maps.GeocoderStatus.OK) {\n\t\t\toptions.position  = results[0].geometry.location;\n\t\t\toptions.geocode   = true;\n\n\t\t\tvar latitude = results[0].geometry.location.lat();\n\t\t\tvar longitude = results[0].geometry.location.lng();\n\n\t\t\tvar marker = $.goMap.createMarker({\n\t\t\t\tlongitude: longitude,\n\t\t\t\tlatitude: latitude,\n\t\t\t\tdraggable: true,\n\n\t\t\t});\n\t\t\tif(marker) {\n\t\t\t\t$.goMap.fitBounds();\n\n\t\t\t\t$.goMap.createListener({type:'marker', marker:marker.id}, 'dragend', function() {\n\t\t\t\t\tlatitudeElement.val(this.position.lat());\n\t\t\t\t\tlongitudeElement.val(this.position.lng());\n\t\t\t\t});\n\t\t\t\t$.goMap.setMap({\n\t\t\t\t\tlongitude: longitude,\n\t\t\t\t\tlatitude: latitude\n\t\t\t\t});\n\t\t\t\tlatitudeElement.val(latitude);\n\t\t\t\tlongitudeElement.val(longitude);\n\t\t\t\t$(latitudeElement).trigger(\"change\"); // fire change event so sidebar updates\n\t\t\t\t$(longitudeElement).trigger(\"change\"); // fire change event so sidebar updates\n\n\t\t\t}\n\n\t\t}\n\t});\n\n\n});\n\n\n$(document).on(\"change\",\".geoField\", function() {\n\tvar mapElement = $(this).find(\".mapWidget\");\n\tmapElement.goMap();\n\tif($.goMap.getMarkerCount()>0) {\n\t\t$.goMap.clearMarkers();\n\t}\n\n\tvar latitudeElement = $(this).closest(\".mapContainer\").find('.latitude');\n\tvar longitudeElement = $(this).closest(\".mapContainer\").find('.longitude');\n\n\tif(latitudeElement.val().length===0 || longitudeElement.val().length===0) {\n\t\treturn;\n\t}\n\n\tvar marker = $.goMap.createMarker({\n\t\tlatitude: latitudeElement.val(),\n\t\tlongitude: longitudeElement.val(),\n\t\tdraggable: true\n\t});\n\n\t$.goMap.fitBounds();\n\n\t$.goMap.createListener({type:'marker', marker:marker.id}, 'dragend', function() {\n\t\tlatitudeElement.val(this.position.lat());\n\t\tlongitudeElement.val(this.position.lng());\n\t});\n});\n\n$(document).on(\"hidden.bs.collapse\", \".maphost\", function(){\n\tvar mapElement = $(this).find(\".mapWidget\");\n\tvar mapButton = $(this).parent().find(\".mapToggle\");\n\tmapButton.html(\"Reveal Map\");\n\tmapElement.goMap();\n\t$.goMap.clearMarkers();\n\tmapElement.removeData();\n\n});\n\n$(document).on(\"shown.bs.collapse\", \".maphost\", function (){\n\tvar mapElement = $(this).find(\".mapWidget\");\n\tvar mapButton = $(this).parent().find(\".mapToggle\");\n\tmapButton.html(\"Hide Map\");\n\n\tvar latitudeElement = $(this).parent().find('.latitude');\n\tvar longitudeElement = $(this).parent().find('.longitude');\n\n\tmapElement.goMap({\n\t\tmapTypeControl:true,\n\t\tmaptype: 'ROADMAP',\n\t\tmapTypeControlOptions: {\n\t\t\tposition: 'TOP_RIGHT',\n\t\t\tstyle: 'DROPDOWN_MENU'\n\t\t},\n\t\taddMarker: \"single\"\n\n\t});\n\n\tmapElement.on(\"clickMarker\", function(e){\n\t\tvar marker = e.marker;\n\t\tlatitudeElement.val(marker.position.lat());\n\t\tlongitudeElement.val(marker.position.lng());\n\t\t$.goMap.createListener({type:'marker', marker:marker.id}, 'dragend', function() {\n\t\t\tlatitudeElement.val(this.position.lat());\n\t\t\tlongitudeElement.val(this.position.lng());\n\t\t});\n\t});\n\n\tvar longitude = longitudeElement.val();\n\tvar latitude = latitudeElement.val();\n\n\tif(longitude!==\"\") {\n\t\t$.goMap.setMap({\n\t\t\tlatitude: latitude,\n\t\t\tlongitude: longitude\n\t\t});\n\t\tmapElement.goMap();\n\t\tvar marker = $.goMap.createMarker({\n\t\t\tlatitude: latitude,\n\t\t\tlongitude: longitude,\n\t\t\tdraggable: true\n\t\t});\n\t\t$.goMap.fitBounds();\n\n\t\t$.goMap.createListener({type:'marker', marker:marker.id}, 'dragend', function() {\n\n\t\t\tlatitudeElement.val(this.position.lat());\n\t\t\tlongitudeElement.val(this.position.lng());\n\t\t});\n\n\t}\n\telse {\n\t\t$.goMap.setMap({address: \"Minneapolis, Minnesota\"});\n\t}\n\n\n});\n"],"sourceRoot":"/source/"}