{"version":3,"sources":["assetMaster.js"],"names":["loadEmbedViewPointer","targetObjectId","$","data","targetAsset","document","find","length","trigger","on","fullscreen","isNativelySupported","append","expander","slicePoint","e","latitude","relatedTarget","longitude","label","html","goMap","mapTypeControl","maptype","mapTypeControlOptions","position","style","getMarkerCount","clearMarkers","setMap","createMarker","draggable","fitBounds","attr","basePath","preventDefault","fileObject","target","getJSON","json","textStatus","exif","baseUL","each","index","el","bootbox","dialog","title","message","buttons","success","className","stopPropagation","nestedObjectId","this","window","location","hash","removeClass","addClass","targetElement","parents","parentObjectId","eq","closest","get","searchRequest","searchText","objectId","post","suppressRecent","searchRelated","searchQuery","JSON","stringify","jsonObject","parseJSON","alert","empty","source","template","Handlebars","compile","foundRelated","resultCount","matches","value","base_url","searchId","cookie","removeCookie","path","is","has","popover","replace","xhr","haveSelectedTarget","element","image","select","parent","children","toggle","undefined","originalEvent","fileObjectId","needLoadNestedView","parentObject","y","scrollTop","z","offset","top","setTimeout","hideAll","loadedCallback","ready","postData","serializeArray","push","name","excerptId","cachedResults","searchResults","formURL","ajax","url","type","jqXHR","modal","error","errorThrown","console","log","newDrawer","drawerId","parseInt","drawerTitle","val","fadeIn","fadeOut"],"mappings":"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","file":"assetMaster.js","sourcesContent":["\n\n$(document).on(\"ready\", function() {\n\n\t// if we don't support fullscreen, hide hte button entirely\n\tif(!$.fullscreen.isNativelySupported()) {\n\t\t$(\"head\").append('<style> .canFullscreen { display: none;</style>');\n\t}\n\n\t$(\".textareaView li div\").expander({\n\t\tslicePoint: 400\n\t});\n\n\t// show nearby assets\n\t$(\"#mapModal\").on(\"shown.bs.modal\",  function(e) {\n\t\tvar latitude = $(e.relatedTarget).data(\"latitude\");\n\t\tvar longitude = $(e.relatedTarget).data(\"longitude\");\n\t\tvar label = $(e.relatedTarget).html();\n\n\t\t$(\"#mapModalLabel\").html(label);\n\t\t$(\"#mapModalContainer\").goMap({\n\t\t\tmapTypeControl:true,\n\t\t\tmaptype: 'ROADMAP',\n\t\t\tmapTypeControlOptions: {\n\t\t\t\tposition: 'TOP_RIGHT',\n\t\t\t\tstyle: 'DROPDOWN_MENU'\n\t\t\t}\n\t\t});\n\n\t\tif($.goMap.getMarkerCount()>0) {\n\t\t\t$.goMap.clearMarkers();\n\t\t}\n\t\t$.goMap.setMap({\n\t\t\tlatitude: latitude,\n\t\t\tlongitude: longitude\n\t\t});\n\n\t\t$(\"#mapModalContainer\").goMap();\n\t\tvar marker = $.goMap.createMarker({\n\t\t\tlatitude: latitude,\n\t\t\tlongitude: longitude,\n\t\t\tdraggable: false\n\t\t});\n\t\t$.goMap.fitBounds();\n\n\t\t$(\"#mapNearby\").attr(\"href\", basePath + \"search/nearbyAssets/\" + latitude + \"/\" + longitude);\n\n\t\treturn false;\n\t});\n\n\n\t// show Exif data for images\n\t$(document).on(\"click\", \".exifToggle\", function(e) {\n\t\te.preventDefault();\n\t\tvar fileObject = $(e.target).data(\"fileobject\");\n\n\t\t$.getJSON(basePath + 'fileManager/getMetadataForObject/' + fileObject, {}, function(json, textStatus) {\n\t\t\tif(json.exif) {\n\t\t\t\tvar baseUL = $(\"<ul />\");\n\t\t\t\t$.each(json.exif, function(index, el) {\n\t\t\t\t\tbaseUL.append(\"<li>\" + index + \" : \" + el + \"</li>\");\n\t\t\t\t});\n\t\t\t\tbootbox.dialog(\n\t\t\t\t{\n\t\t\t\t\ttitle: \"EXIF Data\",\n\t\t\t\t\tmessage: baseUL.html(),\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tsuccess: {\n\t\t\t\t\t\t\tlabel: \"OK\",\n\t\t\t\t\t\t\tclassName: \"btn-primary\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n\n\t$(document).on(\"click\", \".relatedThumbContainer\", function(e) {\n\t\te.stopPropagation();\n\t\tvar nestedObjectId = $(this).data(\"objectid\");\n\t\twindow.location.hash = nestedObjectId;\n\t});\n\n\t// flip chevrons\n\t$(document).on(\"hide.bs.collapse\", \".relatedListToggle\", function(e) {\n\t\t$(this).find(\".expandRelated\").removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');\n\t});\n\n\t$(document).on(\"show.bs.collapse\", \".relatedListToggle\", function(e) {\n\t\te.stopPropagation();\n\t\tvar nestedObjectId = $(this).data(\"objectid\");\n\t\tvar targetElement = this;\n\t\t$(this).find(\".expandRelated\").removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');\n\n\t\tif($(targetElement).parents(\".relatedAssetContainer\").length > 0) {\n\t\t\tparentObjectId = $(targetElement).parents(\".relatedAssetContainer\").eq(0).data(\"objectid\");\n\t\t}\n\t\telse {\n\t\t\tparentObjectId = $(this).closest(\".objectIdHost\").data(\"objectid\");\n\t\t}\n\n\t\t$.get(basePath+\"asset/viewAssetMetadataOnly/\"+parentObjectId + \"/\" + nestedObjectId, function(data) {\n\t\t\t$(targetElement).find('.relatedAssetContents').html(data);\n\t\t});\n\t});\n\n\t$('#relatedAccordian').on('hide.bs.collapse', function (e) {\n\t\t$(this).find(\".expandRelated\").removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');\n\t});\n\n\t$('#relatedAccordian').on('show.bs.collapse', function (e) {\n\t\t$(this).find(\".expandRelated\").removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');\n\t\tvar searchRequest = { \"searchText\": objectId};\n\n\t\t// get related results via search\n\t\t$.post( basePath + \"search/searchResults/\", {\"suppressRecent\": true, \"searchRelated\": true, searchQuery:JSON.stringify(searchRequest)}, function( data ) {\n\t\t\ttry{\n\t\t\t\tjsonObject = $.parseJSON(data);\n\t\t\t}\n\t\t\tcatch(e){\n\t\t\t\talert(e + \" \" + data);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(jsonObject.success === true) {\n\n\t\t\t\t$(\"#relatedAssets\").empty();\n\t\t\t\tvar source   = $(\"#result-template\").html();\n\t\t\t\tvar template = Handlebars.compile(source);\n\t\t\t\tvar foundRelated = false;\n\t\t\t\tvar resultCount = 0;\n\t\t\t\t$.each(jsonObject.matches, function(index, value) {\n\t\t\t\t\tif(value.objectId != objectId) {\n\t\t\t\t\t\tvalue.base_url = basePath;\n\t\t\t\t\t\tvar html    = template(value);\n\t\t\t\t\t\t$(\"#relatedAssets\").append(html);\n\t\t\t\t\t\tfoundRelated = true;\n\t\t\t\t\t\tresultCount++;\n\t\t\t\t\t}\n\n\t\t\t\t});\n\t\t\t\tif(!foundRelated) {\n\t\t\t\t\t$(\"#relatedAssets\").append(\"<p>No Related Assets Found</p>\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\tvar searchId = $.cookie(\"lastSearch\");\n\t$.removeCookie(\"lastSearch\",  { path: '/' });\n\n\t// hide popovers when you click elsehwere on the page\n\t$('body').on('click', function (e) {\n\t\t$('[data-toggle=\"popover\"]').each(function () {\n\t\t\t//the 'is' for buttons that trigger popups\n\t\t\t//the 'has' for icons within a button that triggers a popup\n\t\t\tif (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {\n\t\t\t\t$(this).popover('hide');\n\t\t\t}\n\t\t});\n\t});\n\n\t// if they came in with a hash, let's find and load that asset.\n\tif(window.location.hash) {\n\t\tnestedObjectId = window.location.hash.replace(\"#\",\"\");\n\t\tvar targetAsset = $(document).find('[data-fileobjectid=\"' + nestedObjectId + '\"]');\n\t\tif(targetAsset.length>0) {\n\n\t\t}\n\t\telse { // maybe it's a related asset, try that\n\t\t\ttargetAsset = $(document).find('[data-objectid=\"' + nestedObjectId + '\"]').find(\".loadView\");\n\t\t}\n\n\t\tif(targetAsset.length>0) {\n\t\t\t$(targetAsset).trigger(\"click\");\n\t\t}\n\t\telse {\n\t\t\t// load a default element\n\t\t\tloadEmbedViewPointer();\n\t\t}\n\n\t}\n\telse if(searchId && $(\".rightColumn\").find(\".loadView\").length>1) {\n\t\t// we have multiple subviews, let's ask the search engine if there's one we should highlight\n\t\t$.post(basePath + \"search/getHighlight\", {searchId: searchId, objectId: objectId}, function(data, textStatus, xhr) {\n\t\t\tvar json = $.parseJSON(data);\n\n\t\t\tvar targetAsset = null;\n\t\t\tvar haveSelectedTarget = false;\n\t\t\t$.each(json, function(index, element) {\n\t\t\t\tif(element != $(\"#embedView\").data(\"objectid\")) {\n\t\t\t\t\ttargetAsset = $(document).find('[data-fileobjectid=\"' + element + '\"]');\n\t\t\t\t\tif(targetAsset.length>0) {\n\n\t\t\t\t\t}\n\t\t\t\t\telse { // maybe it's a related asset, try that\n\t\t\t\t\t\ttargetAsset = $(document).find('[data-objectid=\"' + element + '\"]').find(\".loadView\");\n\t\t\t\t\t}\n\t\t\t\t\tif(targetAsset.length>0) {\n\t\t\t\t\t\t$(targetAsset).trigger(\"click\");\n\t\t\t\t\t\thaveSelectedTarget = true;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\tif(!haveSelectedTarget) {\n\t\t\t\t// just load a default\n\t\t\t\tloadEmbedViewPointer();\n\t\t\t}\n\n\t\t});\n\t}\n\telse {\n\t\tloadEmbedViewPointer();\n\t}\n});\n\n// use the 2x image for mouseovers\n$(document).on(\"mouseover\", \".relatedThumbToggle\", function() {\n\tvar image = $(this).find(\".relatedThumbContainerImage\");\n\t$(image).data(\"oldURL\", $(image).attr(\"src\"));\n\tvar data = $(image).data(\"at2x\");\n\t$(image).attr(\"src\", data);\n\n});\n\n// hide the 2x image\n$(document).on(\"mouseout\", \".relatedThumbToggle\", function() {\n\tvar image = $(this).find(\".relatedThumbContainerImage\");\n\tvar data = $(image).data(\"oldURL\");\n\t$(image).attr(\"src\", data);\n\n});\n\n$(document).on(\"click\", \".embedControl\", function() {\n\t$(this).select();\n});\n\n$(document).on(\"click\", \".showDetails\", function() {\n\t$(this).parent().parent().children('.assetDetails').toggle(\"fast\");\n});\n\n$(document).on(\"click\", \".loadView\", function(e) {\n\tif (e.originalEvent === undefined) {\n\t\te.preventDefault();\n\t}\n\tfileObjectId = $(this).data(\"fileobjectid\");\n\n\tvar parent = $(this).closest(\"[data-objectid]\");\n\n\tvar needLoadNestedView = false;\n\tif(parent.length>0) {\n\t\t// we're within a nested asset, let's also load the content for that.\n\t\tparentObject = parent.data(\"objectid\");\n\t\tneedLoadNestedView = true;\n\t}\n\telse {\n\t\tparentObject = $(this).closest(\".objectIdHost\").data(\"objectid\");\n\t}\n\n\t// we pass in the page's objectId so that assets inside drawers load properly.\n\n\t$.get(basePath+\"asset/getEmbed/\"+fileObjectId + \"/\" + objectId, function(data){\n\t\t$(\"#embedView\").html(data);\n\n\t\tvar y = $(window).scrollTop();\n\t\tvar z = $('#embedView').offset().top + 400;\n\t\tif(y>z) {\n\t\t\tbootbox.alert(\"<h2>Scroll Up For New Content</h2>\");\n\t\t\t\twindow.setTimeout(function(){\n\t\t\t\t\tbootbox.hideAll();\n\t\t\t\t}, 1200);\n\t\t}\n\n\t\tif(needLoadNestedView) {\n\t\t\t$.get(basePath+\"asset/viewAssetMetadataOnly/\"+objectId + \"/\" + parentObject, function(data) {\n\t\t\t\t$(\"#embedView\").append(data);\n\t\t\t});\n\t\t}\n\n\t\tif (typeof loadedCallback == 'function') {\n\t\t\tloadedCallback();\n\t\t}\n\t});\n});\n\nfunction loadEmbedViewPointer() {\n\ttargetObjectId = $(\"#embedView\").data(\"objectid\");\n\t\tvar targetAsset = $(document).find('[data-fileobjectid=\"' + targetObjectId + '\"]');\n\t\tif(targetAsset.length>0) {\n\n\t\t}\n\t\telse { // maybe it's a related asset, try that\n\t\t\ttargetAsset = $(document).find('[data-objectid=\"' + targetObjectId + '\"]').find(\".loadView\");\n\t\t}\n\t\t$(targetAsset).trigger(\"click\");\n}\n$(document).ready(function () {\n\n\t$(\"#addToDrawer\").on(\"submit\", function(e) {\n\n\t\te.preventDefault(); //STOP default action\n\t\tvar postData = $(this).serializeArray();\n\n\t\tif(typeof(excerptId) != 'undefined') {\n\t\t\tpostData.push({name: 'excerptId', value: excerptId});\n\t\t}\n\n\t\tif(typeof(objectId) != 'undefined') {\n\t\t\tpostData.push({name: 'objectId', value: objectId});\n\t\t}\n\n\t\tif(typeof(cachedResults) != \"undefined\") {\n\t\t\tpostData.push({name: 'objectArray', value: JSON.stringify(cachedResults.searchResults)});\n\t\t}\n\n\t\tvar formURL = $(this).attr(\"action\");\n\t\t$.ajax({\n\t\t\turl : formURL,\n\t\t\ttype: \"POST\",\n\t\t\tdata : postData,\n\t\t\tsuccess:function(data, textStatus, jqXHR)\n\t\t\t{\n\t\t\t\t$(\"#drawerModal\").modal('toggle');\n\t\t\t},\n\t\t\terror: function(jqXHR, textStatus, errorThrown)\n\t\t\t{\n\t\t\t\tconsole.log(\"Error adding Drawer\");\n\t\t\t}\n\t\t});\n\n\n\n\t});\n\n\t$(\"#addNewDrawer\").on(\"submit\", function(e) {\n\t\tvar postData = $(this).serializeArray();\n\t\tvar formURL = $(this).attr(\"action\");\n\t\t$.ajax({\n\t\t\turl : formURL,\n\t\t\ttype: \"POST\",\n\t\t\tdata : postData,\n\t\t\tsuccess:function(data, textStatus, jqXHR)\n\t\t\t{\n\t\t\t\tvar newDrawer = $.parseJSON(data);\n\n\t\t\t\tvar drawerId = parseInt(newDrawer.drawerId,10);\n\t\t\t\t$(\"#drawerList\").append(\"<option value='\" + drawerId + \"'>\" + newDrawer.drawerTitle + \"</option>\");\n\n\t\t\t\t$('#drawerList').val(drawerId);\n\t\t\t\t$(\".drawerAddedSuccess\").fadeIn('400');\n\t\t\t\twindow.setTimeout(function() { $(\".drawerAddedSuccess\").fadeOut('400'); }, 2000);\n\t\t\t},\n\t\t\terror: function(jqXHR, textStatus, errorThrown)\n\t\t\t{\n\t\t\t\tconsole.log(\"Error adding Drawer\");\n\t\t\t}\n\t\t});\n\t\te.preventDefault(); //STOP default action\n\t});\n\n});\n"],"sourceRoot":"/source/"}